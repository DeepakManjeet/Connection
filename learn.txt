 public virtual int CalculateDateDifference(String Date1, string Date2, string YearBasisType)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.Windows);
                string LastDateOfDate1 = null;
                int DateDifference = 0;
                int FirstMonthDateDifference = 0;
                string[] Date1Fields = Date1.Split('/');
                string[] Date2Fields = Date2.Split('/');

                if (Date1Fields[0] == "02" || Date1Fields[0] == "2")
                    LastDateOfDate1 = Date1Fields[0] + "/" + "28" + "/" + Date1Fields[2];
                else
                    LastDateOfDate1 = Date1Fields[0] + "/" + "30" + "/" + Date1Fields[2];
                string FirstDateOfDate2 = Date2Fields[0] + "/" + "01" + "/" + Date2Fields[2];
                string PreviousDay = appHandle.CalculateNewDate(FirstDateOfDate2, "D", -1);

                if (YearBasisType.ToUpper().IndexOf("ACTUAL") != -1)
                {
                    DateDifference = appHandle.GetDateDiff(Date1, Date2, "D");
                }
                if (YearBasisType.ToUpper().IndexOf("30E") != -1)
                {
                    LastDateOfDate1 = ACBSUtility.ACBSUtilityLibrary.ConvertDateInGivenFormat(LastDateOfDate1, "M/dd/yyyy");
                    string[] PreviousDays = PreviousDay.Split('/');
                    FirstMonthDateDifference = appHandle.GetDateDiff(Date1, LastDateOfDate1, "D");
                    if ((Date1Fields[0] == "02" || Date1Fields[0] == "2"))
                    {
                        if (LastDateOfDate1.Split('/')[1] == "28")
                            FirstMonthDateDifference = FirstMonthDateDifference + 3;
                        else if (LastDateOfDate1.Split('/')[1] == "29")
                            FirstMonthDateDifference = FirstMonthDateDifference + 2;
                    }
                    string startDate = PreviousDay;
                    DateTime sDate = Convert.ToDateTime(startDate);
                    string endDate = LastDateOfDate1;
                    DateTime eDate = Convert.ToDateTime(endDate);
                    int monthsApart = 12 * (sDate.Year - eDate.Year) + sDate.Month - eDate.Month;
                    int months = Math.Abs(monthsApart);
                    DateDifference = FirstMonthDateDifference + (months) * 30 + appHandle.GetDateDiff(PreviousDay, Date2, "D");
                }
                return Math.Abs(DateDifference);
            }
            catch (System.Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
                return 0;
            }
        }
