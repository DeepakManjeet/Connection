<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net6.0-windows</TargetFramework>
    <IsPackable>false</IsPackable>
    <OutputType>Exe</OutputType>
    <GenerateProgramFile>false</GenerateProgramFile>
  </PropertyGroup>
  <ItemGroup>
    <PackageReference Include="GATS.NETCORE.OFS" Version="6.0.0" />
    <PackageReference Include="nunit" Version="3.13.3" />
    <PackageReference Include="NUnit3TestAdapter" Version="4.2.1" />
    <PackageReference Include="Microsoft.NET.Test.Sdk" Version="17.2.0" />
    <PackageReference Include="NUnitLite" Version="3.13.3" />
    <PackageReference Include="RoslynCodeTaskFactory" Version="2.0.7" />
    <PackageReference Include="GATS.ChromeDriver" Version="143.0.0.0" />
  </ItemGroup>
    <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|AnyCPU'">
    <NoWarn></NoWarn>
    <WarningLevel>0</WarningLevel>
  </PropertyGroup>
</Project>



UTILITY________________________________________________________
*************************************************************************

using GTS_OSAF.CoreLibs;
using GTS_CORE.CoreLibs;
using GTS_OSAF.HelperLibs.Reporter;
using System.Collections.Generic;
using System;
using System.Threading;
using System.IO;
using System.Linq;
using GTS_OSAF.HelperLibs.DataAdapter;
using System.Runtime.InteropServices;
using System.Text.RegularExpressions;
using GTS_OSAF;
using GTS_OSAF.HelperLibs.Dictionary;
using System.Text;
using System.Diagnostics;
using NLog;
using OpenQA.Selenium;
using OpenQA.Selenium.Interactions;

namespace WebLink.Utils
{
    [App]
    //ACBS Native Methods
    public class WebLinkUtilityLibrary
    {
        static WebApplication appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
        protected static string ImagePath = StartupConfiguration.EnvironmentDetails.ProjectPath + "Images\\";
        internal static NLog.Logger logger = LogManager.GetCurrentClassLogger();
        public static string PublicHoloidays = "";


        public bool VerifyDatainCSVFile(string FileName, string ReferenceValues, string ExpectedValues)
        {
            string[] AllLines = File.ReadAllLines(FileName);
            for (int k = 0; k < AllLines.Length; k++)
            {
                string Validation = "";
                if (AllLines[k].IndexOf(ReferenceValues) != -1)
                {
                    string[] ExpectedData = ExpectedValues.Split(":");
                    for (int i = 0; i < ExpectedData.Length; i++)
                    {
                        if (AllLines[k].ToUpper().IndexOf(ExpectedData[i].ToUpper()) != -1)
                            Validation = "Pass:" + Validation;
                        else
                            Validation = "Fail:" + Validation;

                    }
                }
                if (Validation.IndexOf("Fail") == -1 && Validation != "")
                    return true;
            }

            return false;

        }

        public virtual void SetFieldValueWithKeyStroke(string objname, string value)
        {
            try
            {
                appHandle.ScrollToObject(objname);
                try { appHandle.ClickObject(objname); } catch (System.Exception e) { appHandle.SelectIcon(objname); }
                appHandle.SendKeyStroke(objname, InputKey.End);
                for (int j = 0; j < 12; j++)
                {
                    appHandle.SendKeyStroke(objname, InputKey.Backspace);
                    Thread.Sleep(15);
                }
                appHandle.Set_field_value(objname, value, false);
            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
            }

        }

        public virtual int GetchildElementCount(string objectname)
        {
            try
            {
                string[] ObjectArray = objectname.Split(";");
                IWebElement element = (IWebElement)appHandle.FindElement(ObjectArray[0] + ";//*");
                IList<IWebElement> rows = element.FindElements(By.XPath(ObjectArray[1]));
                return rows.Count;
            }
            catch (System.Exception e)
            {
                return 0;
            }
        }

        public virtual string GetObjectPropertyValue(string ObjectName, string PropertyName)
        {
            try
            {
                IWebElement element = (IWebElement)appHandle.FindElement(ObjectName);
                return element.GetAttribute(PropertyName);
            }
            catch (System.Exception e)
            {
                return null;
            }
        }

        public virtual string DownloadfileFromChromeBrowser(String Filename)
        {
            string filenamewithpath = null;
            WindowsApplication winapp = ApplicationHandlerFactory.GetApplication(ApplicationType.Windows);
            appHandle.Wait_For_Specified_Time(10);
            try
            {
                filenamewithpath = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\OutputData\\" + Filename;
                System.Windows.Forms.SendKeys.SendWait("{DELETE}");
                winapp.Sendkeys(filenamewithpath);
                System.Windows.Forms.SendKeys.SendWait("{TAB}");
                winapp.PressEnter("Text=Save");
                appHandle.Wait_For_Specified_Time(10);
                Report.Info("The file is Imported successfully.");

                if (File.Exists(filenamewithpath))
                {
                    Report.Pass("The file is downloaded successfully at path " + filenamewithpath, "DocPerm3", "True", appHandle);
                }
                else
                {
                    Report.Fail("The file is not downloaded at path " + filenamewithpath, "DocPerm3", "True", appHandle);
                }
                appHandle.Wait_For_Specified_Time(5);

            }
            catch (System.Exception e) { Report.Info("Exception Logged:" + e); }
            return filenamewithpath;
        }

        public virtual string ImportFileToChromeBrowser(String Filename)
        {
            string filenamewithpath = null;
            WindowsApplication winapp = ApplicationHandlerFactory.GetApplication(ApplicationType.Windows);
            appHandle.Wait_For_Specified_Time(10);
            try
            {
                filenamewithpath = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\InputData\\" + Filename + ".csv";
                winapp.Wait_For_Specified_Time(2);
                winapp.Sendkeys(filenamewithpath);
                System.Windows.Forms.SendKeys.SendWait("{TAB}");
                winapp.PressEnter("Text=Open");
                appHandle.Wait_For_Specified_Time(5);
                Report.Info("The file is Imported successfully.");
            }
            catch (System.Exception e) { Report.Info("Exception Logged:" + e); }
            return filenamewithpath;
        }

        public bool ValidateTableData(object oObjectTable, string ExpectedData)
        {

            IWebElement element = (IWebElement)appHandle.FindElement(oObjectTable);
            string TableText = element.Text;
            TableText = TableText.Replace("\r\n", ":").Replace("  ", ":");
            string[] TableDataArray = ExpectedData.Split(";");
            int DetailReport = 0;
            bool ScreenCapture = true;
            bool TempFalse = true;
            for (int i = 0; i < TableDataArray.Length; i++)
            {
                DetailReport++;
                if (DetailReport > 1)
                    ScreenCapture = false;
                bool Verifytext = VerifyLineInText(TableText, TableDataArray[i].ToString(), true, ScreenCapture);
                if (Verifytext == false)
                    TempFalse = false;
            }
            return TempFalse;
        }

        public bool ValidateFullTableData(object oObjectTable, string ExpectedData)
        {
            IWebElement element = (IWebElement)appHandle.FindElement(oObjectTable);
            string TableText = element.Text;
            TableText = TableText.Replace("\r\n", ":").Replace("  ", ":");
            string[] TableDataArray = ExpectedData.Split("-");
            int DetailReport = 0;
            bool ScreenCapture = true;
            bool TempFalse = true;
            for (int i = 0; i < TableDataArray.Length; i++)
            {
                DetailReport++;
                if (DetailReport > 1)
                    ScreenCapture = false;
                bool Verifytext = VerifyLineInText(TableText, TableDataArray[i].ToString(), true, ScreenCapture);
                if (Verifytext == false)
                    TempFalse = false;
            }
            return TempFalse;
        }

 public virtual void VerifyNotificationText(List<string> NotificationInformation)
             {
        try
            {
           bool result=false;
            bool Scrollbar_down = false;
            string presentString="";
            string notpresentString="";
                string obj = "Xpath;//html/body/embed";
                string NotificationText=  appHandle.GetObjectTextUsingOCR(obj);
               
                 for (int k = 1; k <= 16; k++)
                {
                    System.Windows.Forms.SendKeys.SendWait("{DOWN}");

                }
               
               string temtText="";
                for (int j = 1; j <= 2; j++)
                {
                temtText=  appHandle.GetObjectTextUsingOCR(obj);

                  temtText = temtText.Replace("|", "").Replace("=", "");
                  temtText = Regex.Replace(temtText, @"\s+", " ");
                    foreach(String str in NotificationInformation)
                    {
                     if (temtText.Contains(str))
                     {
                     Report.Pass(str+"  present in Notification pdf", "AddMessageType", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.Windows));
                                         

                     }
                    }
                 if (Scrollbar_down==false)
                 {
                   for (int k = 1; k <= 8; k++)
                        {
                         System.Windows.Forms.SendKeys.SendWait("{DOWN}");  

                        }  
                 }
                    
                  NotificationText= NotificationText + appHandle.GetObjectTextUsingOCR(obj); 
                Scrollbar_down=true;            
                 }
                 NotificationText = NotificationText.Replace("|", "").Replace("=", "");
                NotificationText = Regex.Replace(NotificationText, @"\s+", " ");
                 foreach(String str in NotificationInformation)
                 {
                     if (NotificationText.Contains(str))
                     {
                        presentString =presentString+"      "+str;
                    

                     }
                     else
                     {
                         result=true;
                         notpresentString =notpresentString+"      "+str;
                     }

                 }
                 if (result==true)
                 {
                  Report.Fail(notpresentString+"     not present in Notification pdf", "AddMessageType", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.Windows), true);

                 }
        
                  }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e);
            }
        
        }
        public bool ValidateApproveAndCompleteRequestTableData(string oObjectTable, string ExpectedData, bool contains = true)
        {
            WaitMediumTimeForObject(oObjectTable);
            bool PrintFailedtext = true;
            IWebElement element = (IWebElement)appHandle.FindElement(oObjectTable);
            string TableText = element.Text;
            TableText = TableText.Replace("  \r\n", ":").Replace(" \r\n", ":").Replace("  ", ":").Replace(" ", " ");
            string[] TableDataArray = ExpectedData.Split(";");
            int DetailReport = 0;
            bool TempBoolValue = true;
            for (int i = 0; i < TableDataArray.Length; i++)
            {
                DetailReport++;
                if (contains != true)
                {
                    TempBoolValue = TableText.ToLower().Contains(TableDataArray[i].ToString().ToLower()); if (TempBoolValue != true) TempBoolValue = TableText.ToLower().Replace("::", ":").Contains(TableDataArray[i].ToString().ToLower());
                }
                else
                {
                    string[] TempBoolValueArray = TableDataArray[i].ToString().Split(":");
                    string SplitString = TempBoolValueArray[0] + ":" + TempBoolValueArray[1] + ":";
                    if (TableText.ToLower().Contains(SplitString.ToLower()) != true)
                        TableText = TableText.Replace("::", ":");
                    string[] SecondTempBoolValueArray = TableText.ToLower().Split(new string[] { SplitString.ToLower() }, StringSplitOptions.None);
                    try
                    {
                        if (SecondTempBoolValueArray.Length > 1)
                        {
                            SecondTempBoolValueArray = SecondTempBoolValueArray[1].Split(":");
                            if (SecondTempBoolValueArray[0].ToLower().Contains(TempBoolValueArray[2].ToLower()) == true && SecondTempBoolValueArray[1].ToLower().Contains(TempBoolValueArray[3].ToLower()) == true)
                                TempBoolValue = true;
                            else
                                TempBoolValue = false;
                        }
                        else
                        {
                            TempBoolValue = false;
                        }
                    }
                    catch (Exception e) { TempBoolValue = false; }

                }

                try
                {
                    string Values = appHandle.GetElementValue(oObjectTable);
                    if (TempBoolValue != true)
                    {
                        if (Values.ToUpper().Trim().Replace("  \r\n", ":").Replace(" \r\n", ":").Replace("  ", " ").Replace(" ", " ").Replace(":", " ").Contains(TableDataArray[i].ToString().Replace(":", " ").ToUpper().Trim()) == true)
                        {
                            TempBoolValue = true;
                        }
                        else
                        {
                            TableText = Values.Replace(" ", " ").Replace("    ", ":").Replace("  ", ":");
                            string[] TempBoolValueArray = TableDataArray[i].ToString().Split(":");
                            string SplitString = TempBoolValueArray[0] + ":" + TempBoolValueArray[1] + ":";
                            if (TableText.ToLower().Contains(SplitString.ToLower()) != true)
                                TableText = TableText.Replace("::", ":");
                            string[] SecondTempBoolValueArray = TableText.ToLower().Split(new string[] { SplitString.ToLower() }, StringSplitOptions.None);
                            try
                            {
                                if (SecondTempBoolValueArray.Length > 1)
                                {
                                    SecondTempBoolValueArray = SecondTempBoolValueArray[1].Split(":");
                                    if (SecondTempBoolValueArray[0].ToLower().Contains(TempBoolValueArray[2].ToLower()) == true && SecondTempBoolValueArray[1].ToLower().Contains(TempBoolValueArray[3].ToLower()) == true)
                                        TempBoolValue = true;
                                    else
                                        TempBoolValue = false;
                                }
                                else
                                {
                                    TempBoolValue = false;
                                }
                            }
                            catch (Exception e) { TempBoolValue = false; }
                        }
                    }
                }
                catch (Exception e) { TempBoolValue = false; }

                if (DetailReport > 1)

                {
                    if (TempBoolValue)
                    {
                        Report.Pass("The expected data - '" + TableDataArray[i].ToString() + "' is displayed.", true);
                    }
                    else
                    {
                        if (PrintFailedtext)
                        {
                            Report.Fail("The expected data - '" + TableDataArray[i].ToString() + "' is not displayed. and Actual Text is " + TableText, true); PrintFailedtext = false;
                        }
                        else
                        {
                            Report.Fail("The expected data - '" + TableDataArray[i].ToString() + "' is not displayed.", true);
                        }

                    }
                }
                else
                {
                    if (TempBoolValue)
                    {
                        Report.Pass("The expected data - '" + TableDataArray[i].ToString() + "' is displayed.", "VerifyLineInText", "True", appHandle);
                    }
                    else
                    {

                        if (PrintFailedtext)
                        {
                            Report.Fail("The expected data - '" + TableDataArray[i].ToString() + "' is not displayed. and Actual Text is " + TableText, "VerifyLineInText", "True", appHandle); PrintFailedtext = false;
                        }
                        else
                        {
                            Report.Fail("The expected data - '" + TableDataArray[i].ToString() + "' is not displayed.", "VerifyLineInText", "True", appHandle);
                        }
                    }
                }
            }
            return TempBoolValue;
        }
        /// <summary>
        /// To store and Save the runtime data in a file.
        /// </summary>
        /// <param name="KeyName"></param>
        /// <param name="KeyValue"></param>
        /// <param name="FileName"></param>
        //[Counter("SaveDataInAFile")]
        public virtual void SaveDataInAFile(string KeyName, string KeyValue, string FileName = null)
        {
            try
            {
                string path = "";
                if (StartupConfiguration.Config.ProjectConfig.DataFilesPath.IndexOf(":") != -1)
                {
                    if (FileName != null)
                        path = StartupConfiguration.Config.ProjectConfig.DataFilesPath + FileName + ".csv";
                    else
                        path = StartupConfiguration.Config.ProjectConfig.DataFilesPath + "NewEnvironmentSpecificData.csv";
                }

                else
                {
                    if (FileName != null)
                        path = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\InputData\\" + FileName + ".csv";
                    else
                        path = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\InputData\\NewEnvironmentSpecificData.csv";
                }

                if (Environment.GetEnvironmentVariable("FirstTime_Store") == null)
                {
                    if (File.Exists(path))
                        File.Delete(path);
                }

                Environment.SetEnvironmentVariable("FirstTime_Store", "No");
                if (File.Exists(path))
                {
                    string[] Arrayline = File.ReadAllLines(path);
                    string text = File.ReadAllText(path);
                    File.AppendAllText(path, KeyName + "," + KeyValue + Environment.NewLine);
                }
                else
                {
                    using (StreamWriter sw = File.CreateText(path))
                        sw.WriteLine(KeyName + "," + KeyValue);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
        }

        /// <summary>
        /// Returns file's latest writen timestamp from the specified directory.
        /// If the directory does not exist or doesn't contain any file, null is returned.
        /// </summary>
        /// <param name="directoryInfo">Path of the directory that needs to be scanned</param>
        /// <returns></returns>
        public string GetRecentUpdatedFileName(string path)
        {
            try
            {
                var inputDirectory = new DirectoryInfo(path);
                var myFile = inputDirectory.GetFiles().OrderByDescending(f => f.LastWriteTime).First();
                return myFile.ToString();

            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
            }
            return null;
        }


        public virtual void WaitMajorTimeForObject(string Objectname, string AlterNativeObject = null, int WaitTime = 75)
        {
            try
            {

                int i = 1;
                do
                {
                    try
                    {
                        IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                        if (element.Enabled)
                        {
                            i = WaitTime;
                            break;
                        }
                        else
                        {
                            i++;
                            if (appHandle.IsObjectExists(Objectname))
                                i = WaitTime;
                            appHandle.WaitForSpecifiedTime(1);
                        }
                    }
                    catch (System.Exception e) { i++; appHandle.WaitForSpecifiedTime(1); if (AlterNativeObject != null) { IWebElement element1 = (IWebElement)appHandle.FindElement(AlterNativeObject); if (element1.Enabled) { i = WaitTime; } } }
                }
                while (i < (WaitTime - 1));

                if (i != WaitTime)
                    Report.Warning(Objectname + " not Found.");

            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
            }
        }

        public virtual void WaitTimeForObjectEnabled(string Objectname, int WaitTime = 75)
        {
            try
            {

                int i = 1;
                do
                {
                    try
                    {
                        IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                        if (element.Enabled)
                        {
                            i = WaitTime;
                            break;
                        }
                        else
                        {
                            i++;
                            appHandle.WaitForSpecifiedTime(1);
                        }
                    }
                    catch (System.Exception e) { i++; appHandle.WaitForSpecifiedTime(1); }
                }
                while (i < (WaitTime - 1));

            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
            }
        }

        public virtual void WaitUntilObjectNotExists(string Objectname, int WaitTime = 20)
        {
            try
            {

                int i = 1;
                do
                {
                    try
                    {
                        IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                        if (element.Displayed || element.Enabled)
                        {
                            i++;
                            appHandle.WaitForSpecifiedTime(1);
                        }
                        else
                        {
                            i = WaitTime;
                            break;
                        }
                    }
                    catch (System.Exception e) { i = WaitTime; }
                }
                while (i < (WaitTime - 1));

                if (i != WaitTime)
                    Report.Warning(Objectname + " not Found.");

            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
            }
        }
        public virtual void WaitMediumTimeForObject(string Objectname, int WaitTime = 50)
        {
            try
            {

                int i = 1;
                do
                {
                    try
                    {
                        IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                        if (element.Enabled || element.Displayed)
                        {
                            i = WaitTime;
                            break;
                        }
                        else
                        {
                            i++;
                            if (appHandle.IsObjectExists(Objectname))
                                i = WaitTime;
                            appHandle.WaitForSpecifiedTime(1);
                        }
                    }
                    catch (System.Exception e) { i++; appHandle.WaitForSpecifiedTime(1); }
                }
                while (i < (WaitTime - 1));
                if (i != WaitTime)
                    Report.Warning(Objectname + " not Found.");
            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
            }
        }


        public virtual void WaitMinorTimeForObject(string Objectname, int WaitTime = 25)
        {
            try
            {

                int i = 1;
                do
                {

                    try
                    {
                        IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                        if (element.Enabled)
                        {
                            i = WaitTime;
                            break;
                        }
                        else
                        {
                            i++;
                            if (appHandle.IsObjectExists(Objectname))
                                i = WaitTime;
                            appHandle.WaitForSpecifiedTime(1);
                        }
                    }
                    catch (System.Exception e) { i++; appHandle.WaitForSpecifiedTime(1); }
                }
                while (i < (WaitTime - 1));
                if (i != WaitTime)
                    Report.Warning(Objectname + " not Found.");
            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
            }
        }

        public virtual void WaitSmallTimeForObject(string Objectname, int WaitTime = 5)
        {
            try
            {

                int i = 1;
                do
                {

                    try
                    {
                        IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                        if (element.Enabled || element.Displayed)
                        {
                            i = WaitTime;
                            break;
                        }
                        else
                        {
                            i++;
                            appHandle.WaitForSpecifiedTime(1);
                        }
                    }
                    catch (System.Exception e) { i++; appHandle.WaitForSpecifiedTime(1); }
                }
                while (i < (WaitTime - 1));
                if (i != WaitTime)
                    Report.Warning(Objectname + " not Found.");
            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
            }
        }
        /// <summary>
        /// This function is used to set the field value.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <param name="SetValue"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.SetFieldValue(Objectname, SetValue);
        /// </example>
        public virtual bool SetFieldValue(string Objectname, string SetValue)
        {
            try
            {
                string ExistValue = "";
                try { ExistValue = appHandle.GetElementValue(Objectname); } catch (System.Exception e) { }
                if (ExistValue != "")
                {
                    if (SetValue.IndexOf("/") != -1 || ExistValue.IndexOf("/") != -1)
                    {
                        SetFieldValueWithKeyStroke(Objectname, SetValue);
                    }
                    else
                    {
                        IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                        try { if (ExistValue != "") element.Clear(); ExistValue = appHandle.GetElementValue(Objectname); } catch (System.Exception e) { }
                        if (ExistValue != "" && ExistValue != null)
                        {
                            appHandle.SendKeyStroke(Objectname, InputKey.Home);
                            Thread.Sleep(100);
                            System.Windows.Forms.SendKeys.SendWait("^+{END}"); // Select everything
                            Thread.Sleep(100);
                            System.Windows.Forms.SendKeys.SendWait("{DEL}");
                        }
                        try { appHandle.Set_field_value(Objectname, SetValue); }
                        catch (System.Exception e)
                        {
                            appHandle.Set_field_value(Objectname, SetValue);
                            try { appHandle.Set_field_value(Objectname, SetValue); }
                            catch (System.Exception m)
                            { appHandle.Set_field_value(Objectname, SetValue); }
                        }
                    }
                }
                else
                {
                    try { appHandle.Set_field_value(Objectname, SetValue); }
                    catch (System.Exception e)
                    {
                        appHandle.Set_field_value(Objectname, SetValue);
                        try { appHandle.Set_field_value(Objectname, SetValue); }
                        catch (System.Exception m)
                        { appHandle.Set_field_value(Objectname, SetValue); }
                    }
                }

                try
                {
                    if (Environment.GetEnvironmentVariable("ObjectName").ToString() != null && Environment.GetEnvironmentVariable("ObjectName").ToString() != "")
                        SetValue = Environment.GetEnvironmentVariable("ObjectName").ToString().ToUpper() + ": " + SetValue;
                }
                catch (System.Exception e) { string messages = e.Message; }
                Report.Info(SetValue + " Value is Entered.");
                return true;
            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return false;
        }

        /// <summary>
        /// This function is used to set the field value.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <param name="SetValue"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.SetFieldValue(Objectname, SetValue);
        /// </example>
        public virtual bool SetSearchFieldValue(string Objectname, string SetValue, string SearchButton)
        {
            try
            {
                WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject(Objectname);
                SetFieldValue(Objectname, SetValue);
                System.Windows.Forms.SendKeys.SendWait("{TAB}");
                if (SearchButton.IndexOf(";") != -1)
                    WebLinkUtility.WebLinkUtilityLibrary.SelectButton(SearchButton);
                else
                    WebLinkUtility.WebLinkUtilityLibrary.SelectImage(SearchButton);
                WebLinkUtility.WebLinkUtilityLibrary.WaitMediumTimeForObject("Xpath;//*[contains(text(),'" + SetValue + "')] [@class='mat-option-text'] | //*[contains(text(),'" + SetValue + "')] [@class='mdc-list-item__primary-text'] | //*[@role='listbox']//*[contains(text(),'" + SetValue + "')]");
                if (WebLinkUtility.WebLinkUtilityLibrary.IsObjectExistsInPage("Xpath;//*[contains(text(),'" + SetValue + "')] [@class='mat-option-text'] | //*[contains(text(),'" + SetValue + "')] [@class='mdc-list-item__primary-text'] | //*[@role='listbox']//*[contains(text(),'" + SetValue + "')]"))
                {
                    WebLinkUtility.WebLinkUtilityLibrary.SelectButton("Xpath;//*[contains(text(),'" + SetValue + "')] [@class='mat-option-text'] | //*[contains(text(),'" + SetValue + "')] [@class='mdc-list-item__primary-text'] | //*[@role='listbox']//*[contains(text(),'" + SetValue + "')]");
                    return true;
                }
                else
                {
                    SetFieldValue(Objectname, SetValue);
                    System.Windows.Forms.SendKeys.SendWait("{TAB}");
                    if (SearchButton.IndexOf(";") != -1)
                        WebLinkUtility.WebLinkUtilityLibrary.SelectButton(SearchButton);
                    else
                        WebLinkUtility.WebLinkUtilityLibrary.SelectImage(SearchButton);
                    WebLinkUtility.WebLinkUtilityLibrary.WaitMinorTimeForObject("Xpath;//*[contains(text(),'" + SetValue + "')] [@class='mat-option-text'] | //*[contains(text(),'" + SetValue + "')] [@class='mdc-list-item__primary-text'] | //*[contains(text(),'" + SetValue + "')] [contains(@class,'ng-star-inserted')]");
                    if (WebLinkUtility.WebLinkUtilityLibrary.IsObjectExistsInPage("Xpath;//*[contains(text(),'" + SetValue + "')] [@class='mat-option-text'] | //*[contains(text(),'" + SetValue + "')] [@class='mdc-list-item__primary-text'] | //*[contains(text(),'" + SetValue + "')] [contains(@class,'ng-star-inserted')]"))
                        WebLinkUtility.WebLinkUtilityLibrary.SelectButton("Xpath;//*[contains(text(),'" + SetValue + "')] [@class='mat-option-text'] | //*[contains(text(),'" + SetValue + "')] [@class='mdc-list-item__primary-text'] | //*[contains(text(),'" + SetValue + "')] [contains(@class,'ng-star-inserted')]");
                    else
                        return false;
                }
                return true;
            }

            catch (System.Exception e)
            {
                Report.Warning(Objectname + " not Found.");
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return false;
        }

        /// <summary>
        /// This function is used to set the field value without search button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <param name="SetValue"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.SetFieldValue(Objectname, SetValue);
        /// </example>
        public virtual bool SetSearchFieldValueWithoutSearchButton(string Objectname, string SetValue)
        {
            try
            {
                WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject(Objectname);
                SetFieldValue(Objectname, SetValue);
                appHandle.WaitForSpecifiedTime(1);
                appHandle.ClickObject(Objectname);
                appHandle.WaitForSpecifiedTime(2);
                SetValue = WebLinkUtility.WebLinkUtilityLibrary.ConvertStringIntoCamelCase(SetValue);
                WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject("Xpath;//*[contains(text(),'" + SetValue + "')] [@class='mat-option-text'] | //*[contains(text(),'" + SetValue + "')] [@class='ng-star-inserted'] | //*[contains(text(),'" + SetValue + "')]//parent::mat-option");
                WebLinkUtility.WebLinkUtilityLibrary.SelectButton("Xpath;//*[contains(text(),'" + SetValue + "')] [@class='mat-option-text'] | //*[contains(text(),'" + SetValue + "')] [@class='ng-star-inserted'] | //*[contains(text(),'" + SetValue + "')]//parent::mat-option");
                return true;
            }

            catch (System.Exception e)
            {
                Report.Warning(Objectname + " not Found.");
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return false;
        }

        /// <summary>
        /// This function is used to convert string to camel case.
        /// </summary>
        /// <param name="InputString"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.ConvertStringIntoCamelCase("setValue camel");
        /// </example>
        public virtual string ConvertStringIntoCamelCase(string InputString)
        {
            try
            {
                if (InputString != "" && InputString != null)
                {
                    string[] words = InputString.Split(' ');
                    for (int i = 0; i < words.Length; i++)
                    {
                        words[i] = Char.ToUpperInvariant(words[i].ToString()[0]) + words[i].ToString().Substring(1).ToLower();
                    }
                    return string.Join(" ", words);
                }
                else
                {
                    return InputString;
                }
            }

            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return null;
        }

        /// <summary>
        /// This function is used to Select the Dropdown value.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <param name="SetValue"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.SelectDropdownValue(Objectname, SetValue);
        /// </example>
        //[Counter("SelectDropdownValue")]
        public virtual bool SelectDropdownValue(string Objectname, string SelectValue, bool Contains = true)
        {
            try
            {
                WebLinkUtility.WebLinkUtilityLibrary.WaitMinorTimeForObject(Objectname);
                WebLinkUtility.WebLinkUtilityLibrary.SelectButtonWithoutInfo(Objectname);
                if (Contains == true)
                {
                    if (WebLinkUtility.WebLinkUtilityLibrary.IsObjectExistsInPage("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')]"))
                    {
                        appHandle.ScrollToObject("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')]");
                        appHandle.ClickObjectViaJavaScript("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')]");
                    }
                    else
                    {
                        System.Windows.Forms.SendKeys.SendWait("{ESC}");
                        appHandle.WaitForSpecifiedTime(2);
                        WebLinkUtility.WebLinkUtilityLibrary.WaitMediumTimeForObject(Objectname);
                        WebLinkUtility.WebLinkUtilityLibrary.SelectButtonWithoutInfo(Objectname);
                        WebLinkUtility.WebLinkUtilityLibrary.WaitSmallTimeForObject("Xpath;//*[@role='listbox']");
                        string CamelCaseSelectValue = WebLinkUtility.WebLinkUtilityLibrary.ConvertStringIntoCamelCase(SelectValue);
                        if (WebLinkUtility.WebLinkUtilityLibrary.IsObjectExistsInPage("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')] | //mat-option//*[contains(text(),'" + CamelCaseSelectValue + "')] | //mat-option//*[contains(text(),'" + SelectValue.ToUpper() + "')]"))
                        {
                            appHandle.ScrollToObject("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')] | //mat-option//*[contains(text(),'" + CamelCaseSelectValue + "')] | //mat-option//*[contains(text(),'" + SelectValue.ToUpper() + "')]");
                            appHandle.ClickObjectViaJavaScript("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')] | //mat-option//*[contains(text(),'" + CamelCaseSelectValue + "')] | //mat-option//*[contains(text(),'" + SelectValue.ToUpper() + "')]");
                        }
                        else
                        {
                            System.Windows.Forms.SendKeys.SendWait("{ESC}");
                            appHandle.WaitForSpecifiedTime(2);
                            WebLinkUtility.WebLinkUtilityLibrary.WaitSmallTimeForObject(Objectname);
                            WebLinkUtility.WebLinkUtilityLibrary.SelectButtonWithoutInfo(Objectname);
                            if (WebLinkUtility.WebLinkUtilityLibrary.IsObjectExistsInPage("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')] | //mat-option//*[contains(text(),'" + CamelCaseSelectValue + "')] | //mat-option//*[contains(text(),'" + SelectValue.ToUpper() + "')]"))
                            {
                                appHandle.ScrollToObject("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')] | //mat-option//*[contains(text(),'" + CamelCaseSelectValue + "')] | //mat-option//*[contains(text(),'" + SelectValue.ToUpper() + "')]");
                                appHandle.ClickObjectViaJavaScript("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')] | //mat-option//*[contains(text(),'" + CamelCaseSelectValue + "')] | //mat-option//*[contains(text(),'" + SelectValue.ToUpper() + "')]");
                            }
                            else
                            {
                                System.Windows.Forms.SendKeys.SendWait("{ESC}");
                                appHandle.WaitForSpecifiedTime(2);
                                WebLinkUtility.WebLinkUtilityLibrary.WaitSmallTimeForObject(Objectname);
                                WebLinkUtility.WebLinkUtilityLibrary.SelectButtonWithoutInfo(Objectname);
                                appHandle.ScrollToObject("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')] | //mat-option//*[contains(text(),'" + CamelCaseSelectValue + "')] | //mat-option//*[contains(text(),'" + SelectValue.ToUpper() + "')]");
                                appHandle.ClickObjectViaJavaScript("Xpath;//mat-option//*[contains(text(),'" + SelectValue + "')] | //mat-option//*[contains(text(),'" + CamelCaseSelectValue + "')] | //mat-option//*[contains(text(),'" + SelectValue.ToUpper() + "')]");

                            }
                        }
                    }
                }
                else
                {

                    if (WebLinkUtility.WebLinkUtilityLibrary.IsObjectExistsInPage("Xpath;//mat-option//*[normalize-space(text())='" + SelectValue + "']"))
                    {
                        appHandle.ScrollToObject("Xpath;//mat-option//*[normalize-space(text())='" + SelectValue + "']");
                        appHandle.ClickObjectViaJavaScript("Xpath;//mat-option//*[normalize-space(text())='" + SelectValue + "']");
                    }
                    else
                    {
                        System.Windows.Forms.SendKeys.SendWait("{ESC}");
                        appHandle.WaitForSpecifiedTime(2);
                        WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject(Objectname);
                        WebLinkUtility.WebLinkUtilityLibrary.SelectButtonWithoutInfo(Objectname);
                        WebLinkUtility.WebLinkUtilityLibrary.WaitSmallTimeForObject("Xpath;//*[@role='listbox']");
                        string CamelCaseSelectValue = WebLinkUtility.WebLinkUtilityLibrary.ConvertStringIntoCamelCase(SelectValue);
                        if (WebLinkUtility.WebLinkUtilityLibrary.IsObjectExistsInPage("Xpath;//mat-option//*[normalize-space(text())='" + SelectValue + "']|//mat-option//*[normalize-space(text())='" + SelectValue.ToUpper() + "']|//mat-option//*[normalize-space(text())='" + CamelCaseSelectValue + "']"))
                        {

                            appHandle.ScrollToObject("Xpath;//mat-option//*[normalize-space(text())='" + SelectValue + "']|//mat-option//*[normalize-space(text())='" + SelectValue.ToUpper() + "']|//mat-option//*[normalize-space(text())='" + CamelCaseSelectValue + "']");
                            appHandle.ClickObjectViaJavaScript("Xpath;//mat-option//*[normalize-space(text())='" + SelectValue + "']|//mat-option//*[normalize-space(text())='" + SelectValue.ToUpper() + "']|//mat-option//*[normalize-space(text())='" + CamelCaseSelectValue + "']");
                        }

                        else
                        {
                            System.Windows.Forms.SendKeys.SendWait("{ESC}");
                            appHandle.WaitForSpecifiedTime(2);
                            WebLinkUtility.WebLinkUtilityLibrary.SelectButtonWithoutInfo(Objectname);
                            WebLinkUtility.WebLinkUtilityLibrary.WaitSmallTimeForObject("Xpath;//*[@role='listbox']");
                            appHandle.ScrollToObject("Xpath;//mat-option//*[normalize-space(text())='" + SelectValue + "']|//mat-option//*[normalize-space(text())='" + SelectValue.ToUpper() + "']|//mat-option//*[normalize-space(text())='" + CamelCaseSelectValue + "']");
                            appHandle.ClickObjectViaJavaScript("Xpath;//mat-option//*[normalize-space(text())='" + SelectValue + "']|//mat-option//*[normalize-space(text())='" + SelectValue.ToUpper() + "']|//mat-option//*[normalize-space(text())='" + CamelCaseSelectValue + "']");
                        }
                    }
                }

                try
                {
                    if (Environment.GetEnvironmentVariable("ObjectName").ToString() != null && Environment.GetEnvironmentVariable("ObjectName").ToString() != "")
                        SelectValue = Environment.GetEnvironmentVariable("ObjectName").ToString().ToUpper() + ": " + SelectValue;
                }
                catch (System.Exception e) { string messages = e.Message; }
                Report.Info(SelectValue + " is Selected.");
                return true;
            }
            catch (System.Exception e)
            {
                Report.Warning(Objectname + " not Found.");
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return false;
        }

        public virtual bool VerifyDropdownValueExist(string Objectname, List<string> ExpectedValue, bool Contains)
        {
            bool ScreenCapture = true;
            bool Verification = false;
            try
            {
                WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject(Objectname);
                WebLinkUtility.WebLinkUtilityLibrary.SelectButton(Objectname);
                WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject("xpath;//*[@role='listbox']");
                for (int i = 0; i < ExpectedValue.Count; i++)
                {
                    if (i > 0)
                        ScreenCapture = false;
                    Verification = VerifyObjectText("xpath;//*[@role='listbox']", ExpectedValue[i].ToString(), Contains, ScreenCapture);
                    if (Verification == false)
                        Verification = false;
                }
                return Verification;
            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
            }
            return Verification;
        }

        /// <summary>
        /// This function is used to Select the Dropdown value.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <param name="SetValue"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetFieldValue(Objectname);
        /// </example>
        //[Counter("GetFieldValue")]
        public virtual string GetFieldValue(string Objectname)
        {
            try
            {
                WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject(Objectname);
                return appHandle.GetElementValue(Objectname);

            }
            catch (System.Exception e)
            {
                Report.Warning(Objectname + " not Found.");
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return null;
        }

        /// <summary>
        /// This function is used to Select the Dropdown value.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <param name="SetValue"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetValueForApprovalProcess(Objectname);
        /// </example>
        //[Counter("GetValueForApprovalProcess")]
        public virtual string GetValueForApprovalProcess(string Objectname)
        {
            try
            {
                if (Environment.GetEnvironmentVariable("AppApprovalProcessFlow") == "YES" && StartupConfiguration.UserSettings.StepApprovalRequired.ToString() != "0")
                {
                    try { appHandle.WaitForObjectEnabled(Objectname, 50); } catch (System.Exception e) { }
                    try { return appHandle.GetElementValue(Objectname); } catch (System.Exception e) { }
                }
            }
            catch (System.Exception e)
            {
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return null;
        }

        /// <summary>
        /// This function is used to Select the Button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.SelectButton(Objectname);
        /// </example>      
        public virtual bool SelectButton(string Objectname)
        {
            try
            {
                WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject(Objectname);
                IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                element.Click();
            }
            catch (System.Exception e)
            {
                try
                {
                    IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                    if (element.Enabled)
                    {
                        appHandle.SelectIcon(Objectname);
                    }
                }
                catch (System.Exception s)
                {
                    string ExceptinMessage = s.Message;
                    try
                    {
                        IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                        if (element.Enabled)
                        {
                            appHandle.ClickObject(Objectname);
                        }
                    }
                    catch (System.Exception m)
                    {
                        Report.Warning(Objectname + " not Found.");
                        string ExceptionMessage = m.Message;
                        HandleUtilityException(ExceptionMessage);
                    }
                }
            }
            Report.Info(Objectname + " clicked.");
            return true;
        }

        public virtual bool SelectButtonWithoutInfo(string Objectname)
        {
            try
            {
                WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject(Objectname);
                IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                element.Click();
            }
            catch (System.Exception e)
            {
                try
                {
                    IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                    if (element.Enabled)
                    {
                        appHandle.SelectIcon(Objectname);
                    }
                }
                catch (System.Exception s)
                {
                    string ExceptinMessage = s.Message;
                    try
                    {
                        IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                        if (element.Enabled)
                        {
                            appHandle.ClickObject(Objectname);
                        }
                    }
                    catch (System.Exception m)
                    {
                        Report.Warning(Objectname + " not Found.");
                        string ExceptionMessage = m.Message;
                        HandleUtilityException(ExceptionMessage);
                    }
                }
            }
            return true;
        }


        /// <summary>
        /// This function is used to Get masked Number.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetMaskedNumber("97430643211",4);
        /// </example>      
        public virtual string GetMaskedNumber(string FullNumber, int DisplayNumbers, string Side = "RIGHT")
        {
            string MaskedNum = "";
            string SplittedString = "";
            if (Side.ToUpper() == "RIGHT")
            {
                SplittedString = SplitSideString(FullNumber, "RIGHT", DisplayNumbers, 0);
                for (int i = 0; i < ((FullNumber.Length) - DisplayNumbers); i++)
                {
                    MaskedNum = MaskedNum + "*";
                }

            }
            return MaskedNum + SplittedString;

        }

        /// <summary>
        /// This function is used to Select the Button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.VerifyObjectText(Objectname);
        /// </example>
        //[Counter("VerifyObjectText")]
        public virtual bool VerifyObjectText(string Objectname, string Message, bool shouldContains = false, bool ScreenCapture = true)
        {
            bool Results = false;
            string ObjectText = "";
            try
            {
                int i = 0;
                do
                {
                    if (Message != "")
                    {
                        WebLinkUtility.WebLinkUtilityLibrary.WaitTillObjectValuePresent(Objectname);
                    }
                    else
                    {
                        WebLinkUtility.WebLinkUtilityLibrary.WaitMinorTimeForObject(Objectname);
                    }

                    ObjectText = appHandle.GetElementValue(Objectname);
                    if (ObjectText != "" && ObjectText != null)
                        ObjectText = ObjectText.Replace("\r\n", "").ToUpper().Trim().ToString();
                    else if (ObjectText == null)
                        ObjectText = "";
                    else
                        ObjectText = ObjectText.Trim().ToString();

                    if (Message.ToUpper() == "ON" || Message.ToUpper() == "OFF")
                    {
                        if (Message.ToUpper() == "ON")
                        {
                            if (ObjectText == Message.ToUpper().Trim() || ObjectText == "YES")
                                Results = true;
                            else
                                Results = false;
                        }
                        else if (Message.ToUpper() == "OFF")
                        {
                            if (ObjectText == Message.ToUpper().Trim() || ObjectText == "NO")
                                Results = true;
                            else
                                Results = false;
                        }
                    }
                    else if (Message.Trim() == "0" || Message.Trim() == "0.00" || Message.Trim().Contains("0.000"))
                    {
                        if (ObjectText.Trim().Contains(Message.Trim()) || ObjectText.Trim() == "0" || ObjectText.Trim() == "0.00" || ObjectText.Trim().Contains("0.000"))
                            Results = true;
                        else
                            Results = false;
                    }
                    else
                    {
                        if (ObjectText == "" && Message.Trim() == "")
                        {
                            Results = true;
                        }
                        else
                        {
                            if (shouldContains == true)
                            {
                                if (ObjectText.Contains(Message.ToUpper().Trim()) == true)

                                    Results = true;
                                else
                                    Results = false;

                            }
                            else
                            {
                                if (ObjectText == Message.ToUpper().Trim())
                                    Results = true;
                                else
                                    Results = false;
                            }
                        }
                    }
                    i++;
                }
                while (i < 2 && Results == false);
            }
            catch (System.Exception e)
            {
                string messages = e.Message;
            }
            try
            {
                if (Environment.GetEnvironmentVariable("ObjectName").ToString() != null && Environment.GetEnvironmentVariable("ObjectName").ToString() != "")
                    Message = Environment.GetEnvironmentVariable("ObjectName").ToString().ToUpper() + ": " + Message;
            }
            catch (System.Exception e) { string messages = e.Message; Environment.SetEnvironmentVariable("ObjectName", ""); }

            if (Results == true)
            {
                if (ScreenCapture)
                    Report.Pass("The Object expected data: '" + Message + "' is displayed Actual text: '" + ObjectText + "'.", "VerifyObjectText", "True", appHandle);
                else
                    Report.Pass("The Object expected data: '" + Message + "' is displayed Actual text: '" + ObjectText + "'.", true);
                return true;
            }
            else
            {
                // Report.Fail("The Object expected data: '" + Message + "' is not displayed Actual text: '" + ObjectText + "'.", "VerifyObjectText", "True", appHandle);
                if (ScreenCapture)
                    Report.Fail("The Object expected data: '" + Message + "' is not displayed Actual text: '" + ObjectText + "'.", "VerifyObjectText", "True", appHandle);
                else
                    Report.Fail("The Object expected data: '" + Message + "' is not displayed Actual text: '" + ObjectText + "'.", true);
                return false;
            }
        }



        /// <summary>
        /// This function is used to Select the Button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.VerifyObjectText(Objectname);
        /// </example>
        //[Counter("VerifyObjectText")]
        public virtual bool VerifyObjectAmount(string Objectname, string Amount, bool shouldContains = false, bool ScreenCapture = true)
        {
            bool Results = false;
            string ObjectText = "";
            try
            {
                int i = 0;
                do
                {
                    if (Amount != "")
                    {
                        WebLinkUtility.WebLinkUtilityLibrary.WaitTillObjectValuePresent(Objectname);
                    }
                    else
                    {
                        WebLinkUtility.WebLinkUtilityLibrary.WaitMinorTimeForObject(Objectname);
                    }

                    ObjectText = appHandle.GetElementValue(Objectname);
                    if (ObjectText != "" && ObjectText != null)
                        ObjectText = ObjectText.Replace("\r\n", "").ToUpper().Trim().ToString();
                    else if (ObjectText == null)
                        ObjectText = "";
                    else
                        ObjectText = ObjectText.Trim().ToString();

                    if (Amount.Trim() == "0" || Amount.Trim() == "0.00" || Amount.Trim().Contains("0.000"))
                    {
                        if (ObjectText.Trim().Contains(Amount.Trim()) || ObjectText.Trim() == "0" || ObjectText.Trim() == "0.00" || ObjectText.Trim().Contains("0.000"))
                            Results = true;
                        else
                            Results = false;
                    }
                    else
                    {
                        if (Amount != "" && Amount != null)
                            Amount = WebLinkUtility.WebLinkUtilityLibrary.ConvertCurrencyFormat(Amount);
                        if (ObjectText != "" && ObjectText != null)
                            ObjectText = WebLinkUtility.WebLinkUtilityLibrary.ConvertCurrencyFormat(ObjectText);
                        if (ObjectText == "" && Amount == "")
                        {
                            Results = true;
                        }
                        else
                        {
                            if (shouldContains == true)
                            {
                                if (ObjectText.Contains(Amount) == true)

                                    Results = true;
                                else
                                    Results = false;

                            }
                            else
                            {
                                if (ObjectText == Amount)
                                    Results = true;
                                else
                                    Results = false;
                            }
                        }
                    }
                    i++;
                }
                while (i < 2 && Results == false);
            }
            catch (System.Exception e)
            {
                string messages = e.Message;
            }
            try
            {
                if (Environment.GetEnvironmentVariable("ObjectName").ToString() != null && Environment.GetEnvironmentVariable("ObjectName").ToString() != "")
                    Amount = Environment.GetEnvironmentVariable("ObjectName").ToString().ToUpper() + ": " + Amount;
            }
            catch (System.Exception e) { string messages = e.Message; Environment.SetEnvironmentVariable("ObjectName", ""); }

            if (Results == true)
            {
                if (ScreenCapture)
                    Report.Pass("The Object expected data: '" + Amount + "' is displayed Actual text: '" + ObjectText + "'.", "VerifyObjectText", "True", appHandle);
                else
                    Report.Pass("The Object expected data: '" + Amount + "' is displayed Actual text: '" + ObjectText + "'.", true);
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The Object expected data: '" + Amount + "' is not displayed Actual text: '" + ObjectText + "'.", "VerifyObjectText", "True", appHandle);
                else
                    Report.Fail("The Object expected data: '" + Amount + "' is not displayed Actual text: '" + ObjectText + "'.", true);
                return false;
            }
        }


        /// <summary>
        /// This function is used to Select the Button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.VerifyObjectText(Objectname);
        /// </example>
        //[Counter("VerifyObjectText")]
        public virtual bool VerifyObjectTextNotExist(string Objectname, string Message, bool shouldContains = false, bool ScreenCapture = true)
        {
            bool Results = false;
            string ObjectText = "";
            try
            {
                WebLinkUtility.WebLinkUtilityLibrary.WaitMinorTimeForObject(Objectname);
                ObjectText = appHandle.GetElementValue(Objectname).Trim().Replace("\r\n", "");
                if (shouldContains == true)
                {
                    if (ObjectText.ToUpper().Trim().Contains(Message.ToUpper().Trim()) == true)

                        Results = true;
                    else
                        Results = false;

                }
                else
                {
                    if (ObjectText.ToUpper().Trim().ToString() == Message.ToUpper().Trim())
                        Results = true;
                    else
                        Results = false;
                }
            }
            catch (System.Exception e)
            {
                string messages = e.Message;
            }
            try
            {
                if (Environment.GetEnvironmentVariable("ObjectName").ToString() != null && Environment.GetEnvironmentVariable("ObjectName").ToString() != "")
                    Message = Environment.GetEnvironmentVariable("ObjectName").ToString().ToUpper() + ": " + Message;
            }
            catch (System.Exception e) { string messages = e.Message; }

            if (Results != true)
            {
                if (ScreenCapture)
                    Report.Pass("The Object expected data: '" + Message + "' is not displayed Actual text: '" + ObjectText + "'.", "VerifyFieldValueDisplayed", "True", appHandle);
                else
                    Report.Pass("The Object expected data: '" + Message + "' is not displayed Actual text: '" + ObjectText + "'.", true);
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The Object expected data: '" + Message + "' is displayed Actual text: '" + ObjectText + "'.", "VerifyFieldValueDisplayed", "True", appHandle);
                else
                    Report.Fail("The Object expected data: '" + Message + "' is displayed Actual text: '" + ObjectText + "'.", true);
                return false;
            }
        }

        public virtual bool VerifyObjectIsDisabled(string Objectname, bool ScreenCapture = true)
        {
            bool Results = false;
            try
            {
                IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                if (element.Enabled)
                    Results = false;
                else
                    Results = true;
            }
            catch (System.Exception e)
            {
                string messages = e.Message;
                Results = false;
            }
            try
            {
                if (Environment.GetEnvironmentVariable("ObjectName").ToString() != null && Environment.GetEnvironmentVariable("ObjectName").ToString() != "")
                    Objectname = Environment.GetEnvironmentVariable("ObjectName").ToString().ToUpper();
            }
            catch (System.Exception e) { string messages = e.Message; }
            if (Results == true)
            {
                if (ScreenCapture)
                    Report.Pass("The Object : '" + Objectname + "' is Disabled.", "VerifyObjectIsDisabled", "True", appHandle);
                else
                    Report.Pass("The Object : '" + Objectname + "' is Disabled.", true);
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The Object : '" + Objectname + "' is Enabled'.", "VerifyObjectIsDisabled", "True", appHandle);
                else
                    Report.Fail("The Object : '" + Objectname + "' is Enabled'.", true);
                return false;
            }

        }

        public virtual bool VerifyObjectIsEnabled(string Objectname, bool ScreenCapture = true)
        {
            bool Results = false;
            try
            {
                IWebElement element = (IWebElement)appHandle.FindElement(Objectname);
                if (element.Enabled)
                    Results = true;
                else
                    Results = false;
            }
            catch (System.Exception e)
            {
                string messages = e.Message;
                Results = false;
            }
            if (Results == true)
            {
                if (ScreenCapture)
                    Report.Pass("The Object : '" + Objectname + "' is Enabled.", "VerifyObjectIsEnabled", "True", appHandle);
                else
                    Report.Pass("The Object : '" + Objectname + "' is Enabled.", true);
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The Object : '" + Objectname + "' is Disabled'.", "VerifyObjectIsEnabled", "True", appHandle);
                else
                    Report.Fail("The Object : '" + Objectname + "' is Disabled'.", true);
                return false;
            }

        }

        public virtual string GetLastUpdatedFileInDirectory(DirectoryInfo directoryInfo)
        {
            FileInfo[] files = directoryInfo.GetFiles();
            List<FileInfo> lastUpdatedFile = new List<FileInfo>();
            DateTime lastUpdate = DateTime.MinValue;
            foreach (FileInfo file in files)
            {
                if (file.LastAccessTime > lastUpdate)
                {
                    lastUpdatedFile.Add(file);
                    lastUpdate = file.LastAccessTime;
                }
            }

            return lastUpdatedFile[0].ToString();
        }
        /// <summary>
        /// This function is used to Select the Button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.ConfirmObjectText(Objectname);
        /// </example>
        //[Counter("VerifyObjectText")]
        public virtual bool ConfirmObjectText(string Objectname, string Message, bool shouldContains = false, bool ScreenCapture = true)
        {
            bool Results = true;
            string ObjectText = "";
            try
            {
                WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject(Objectname);
                ObjectText = appHandle.GetObjectText(Objectname);
                if (shouldContains == true)
                {
                    if (ObjectText.ToUpper().Trim().Contains(Message.ToUpper().Trim()) == false)

                        Results = false;
                    else
                        Results = true;

                }
                else
                {
                    if (ObjectText.ToUpper().Trim() != Message.ToUpper().Trim())
                        Results = false;
                    else
                        Results = true;
                }
            }
            catch (System.Exception e)
            {
                string messages = e.Message;
            }
            try
            {
                if (Environment.GetEnvironmentVariable("ObjectName").ToString() != null && Environment.GetEnvironmentVariable("ObjectName").ToString() != "")
                    Message = Environment.GetEnvironmentVariable("ObjectName").ToString() + " :" + Message;
            }
            catch (System.Exception e) { string messages = e.Message; Environment.SetEnvironmentVariable("ObjectName", ""); }

            if (Results == true)
            {
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The expected data - '" + Message + "' is not displayed Actual text: '" + ObjectText + "'.", "VerifyFieldValueDisplayed", "True", appHandle);
                else
                    Report.Fail("The expected data - '" + Message + "' is not displayed Actual text: '" + ObjectText + "'.", true);
                return false;
            }
        }


        /// <summary>
        /// This function is used to Select the Button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.IsObjectTextExist(Objectname);
        /// </example>
        //[Counter("IsObjectTextExist")]
        public virtual bool IsObjectTextExist(string Objectname, string Message, bool shouldContains = false)
        {
            try
            {
                string ObjectText = appHandle.GetElementValue(Objectname);
                if (shouldContains == true)
                {
                    if (ObjectText.ToUpper().Trim().Contains(Message.ToUpper().Trim()) == false)

                        return false;
                    else
                        return true;

                }
                else
                {
                    if (ObjectText.ToUpper().Trim() != Message.ToUpper().Trim())
                        return false;
                    else
                        return true;
                }
            }
            catch (System.Exception e)
            {
                return false;
            }
        }

        /// <summary>
        /// This function is used to Select the Button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.VerifyMessageExistInPage(Message);
        /// </example>
        //[Counter("VerifyMessageExistInPage")]
        public virtual bool VerifyMessageExistInPage(string Message, bool ScreenCapture = true)
        {
            bool Results = false;

            int i = 0;
            while (i < 300)
            {
                try
                {
                    IWebElement element = (IWebElement)appHandle.FindElement("Xpath;//body");
                    string GetelementText = element.Text;
                    string GetelementText1 = GetelementText.Replace(" \r\n", " ").Replace("\r\n", " ");
                    string GetelementText2 = GetelementText.Replace(" \r\n", ":").Replace("\r\n", ":");
                    if (GetelementText1.IndexOf(Message) != -1 || GetelementText2.IndexOf(Message) != -1)
                    {
                        Results = true;
                        i = 301;
                    }
                    else
                    {
                        Results = false;
                        Thread.Sleep(500);
                    }

                    i++;
                }
                catch (System.Exception e)
                {
                    Thread.Sleep(500);
                    i++;
                }
            }

            if (Results == true)
            {
                if (ScreenCapture)
                    Report.Pass("The expected Message - '" + Message + "' is displayed.", "VerifyFieldValueDisplayed", "True", appHandle);
                else
                    Report.Pass("The expected Message - '" + Message + "' is displayed.", true);
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The expected Message - '" + Message + "' is not displayed.", "VerifyFieldValueDisplayed", "True", appHandle);
                else
                    Report.Fail("The expected Message - '" + Message + "' is not displayed.", true);
                return false;
            }
        }



        public virtual bool VerifyToolTipMessageExistInPage(string Object, string Message, bool ScreenCapture = true)
        {
            bool Results = false;
            try
            {
                appHandle.HoverMouseOnObject(Object);
                appHandle.WaitForSpecifiedTime(2);
                string objectmessage = appHandle.GetElementValue("Xpath;//*[@role='tooltip']");
                if (objectmessage != null && objectmessage != "")
                {
                    if (objectmessage.ToUpper().Trim() == Message.ToUpper().Trim())
                        Results = true;
                    else
                        Results = false;
                }
                else
                    Results = false;


            }
            catch (System.Exception e)
            {
                string messages = e.Message;
            }
            if (Results == true)
            {
                if (ScreenCapture)
                    Report.Pass("The expected Message - '" + Message + "' is displayed.", "VerifyFieldValueDisplayed", "True", appHandle);
                else
                    Report.Pass("The expected Message - '" + Message + "' is displayed.", true);
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The expected Message - '" + Message + "' is not displayed.", "VerifyFieldValueDisplayed", "True", appHandle);
                else
                    Report.Fail("The expected Message - '" + Message + "' is not displayed.", true);
                return false;
            }
        }


        /// <summary>
        /// This function is used Verify message not exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.WaitUntilMessageNotExists(Message);
        /// </example>
        //[Counter("WaitUntilMessageNotExists")]
        public virtual bool WaitUntilMessageNotExists(string Message)
        {
            bool Results = false;
            try
            {
                int i = 0;
                do
                {
                    IWebElement element = (IWebElement)appHandle.FindElement("Xpath;//body");
                    string TableText = element.Text;
                    TableText = TableText.Replace(" \r\n", ":").Replace("\r\n", ":");
                    if (TableText.IndexOf(Message) != -1)
                        Results = false;
                    else
                        Results = true;
                    i++;
                } while (Results == false && i < 50);
                return Results;

            }
            catch (System.Exception e)
            {
                Results = false;
            }
            return false;

        }
        /// <summary>
        /// This function is used Verify message not exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.ConfirmMessageNotExistInPage(Message);
        /// </example>
        //[Counter("ConfirmMessageNotExistInPage")]
        public virtual bool ConfirmMessageNotExistInPage(string Message, bool ScreenCapture = true)
        {
            bool Results = false;
            try
            {
                int i = 0;
                do
                {
                    IWebElement element = (IWebElement)appHandle.FindElement("Xpath;//body");
                    string TableText = element.Text;
                    TableText = TableText.Replace(" \r\n", ":").Replace("\r\n", ":");
                    if (TableText.IndexOf(Message) != -1)
                        Results = false;
                    else
                        Results = true;
                    i++;
                } while (Results == false && i < 3);
                return Results;

            }
            catch (System.Exception e)
            {
                Results = false;
            }
            if (Results == true)
            {
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The Message - '" + Message + "' is displayed.", "ConfirmMessageNotExistInPage", "True", appHandle);
                else
                    Report.Fail("The Message - '" + Message + "' is displayed.", true);
                return false;
            }
        }

        /// <summary>
        /// This function is used Verify message not exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.VerifyMessageNotExistInPage(Message);
        /// </example>
        //[Counter("VerifyMessageNotExistInPage")]
        public virtual bool VerifyMessageNotExistInPage(string Message, bool ScreenCapture = true)
        {
            bool Results = false;
            try
            {
                Results = WebLinkUtility.WebLinkUtilityLibrary.IsMessageExistInPage(Message, 2);

            }
            catch (System.Exception e)
            {
                string messages = e.Message;
                Results = false;
            }
            if (Results == false)
            {
                if (ScreenCapture)
                    Report.Pass("The expected Message - '" + Message + "' is not displayed.", "VerifyFieldValueDisplayed", "True", appHandle);
                else
                    Report.Pass("The expected Message - '" + Message + "' is not displayed.", true);
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The Message - '" + Message + "' is displayed.", "VerifyMessageNotExistInPage", "True", appHandle);
                else
                    Report.Fail("The Message - '" + Message + "' is displayed.", true);
                return false;
            }
        }


        /// <summary>
        /// This function is used Verify message not exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.ConfirmMessageExistInPage(Message);
        /// </example>
        //[Counter("ConfirmMessageExistInPage")]
        public virtual bool ConfirmMessageExistInPage(string Message, string AlterNativeMessage = null, bool ScreenCapture = true, int NumberOfIterations = 300)
        {
            bool Results = false;
            try
            {
                int i = 0;
                do
                {
                    string TableText = "";
                    IWebElement element = (IWebElement)appHandle.FindElement("Xpath;//body");
                    TableText = element.Text;
                    TableText = TableText.Replace(" \r\n", ":").Replace("\r\n", ":");
                    if (AlterNativeMessage != null)
                    {
                        if (TableText.IndexOf(Message) != -1 || TableText.IndexOf(AlterNativeMessage) != -1)
                            Results = true;
                        else
                            Results = false;
                    }
                    else
                    {
                        if (TableText.IndexOf(Message) != -1)
                            Results = true;
                        else
                            Results = false;
                    }
                    i++;
                    Thread.Sleep(200);
                } while (Results == false && i < NumberOfIterations);

            }
            catch (System.Exception e)
            {
                Results = false;
            }
            if (Results == true)
            {
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The Message - '" + Message + "' is not displayed.", "ConfirmMessageExistInPage", "True", appHandle);
                else
                    Report.Fail("The Message - '" + Message + "' is not displayed.", true);
                return false;
            }
        }


        /// <summary>
        /// This function is used Verify message not exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.IsMessageExistInPage(Message);
        /// </example>
        //[Counter("IsMessageExistInPage")]
        public virtual bool IsMessageExistInPage(string Message, int Itreations = 3, string RequiredObject = null)
        {
            try
            {

                int i = 1;
                bool Results = false;
                string TableText = "";
                do
                {
                    if (RequiredObject == null)
                    {
                        IWebElement element = (IWebElement)appHandle.FindElement("Xpath;//body");
                        TableText = element.Text;
                    }
                    else
                    {
                        try
                        {
                            IWebElement element = (IWebElement)appHandle.FindElement(RequiredObject);
                            TableText = element.Text;
                        }
                        catch (System.Exception e)
                        {
                            TableText = "Empty Value";
                        }
                    }
                    TableText = TableText.Replace(" \r\n", ":").Replace("\r\n", ":");
                    if (TableText.IndexOf(Message) != -1)
                    {
                        return true;
                    }
                    else
                    {
                        Thread.Sleep(500);
                        Results = false;
                    }
                    i++;
                } while (Results == false && i < Itreations);
                return Results;
            }
            catch (System.Exception e)
            {
                return false;
            }

        }

        /// <summary>
        /// This function is used Verify object exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.ConfirmObjectExistsInPage(Message);
        /// </example>
        //[Counter("ConfirmObjectExistsInPage")]
        public virtual bool ConfirmObjectExistsInPage(string Object)
        {
            bool Results = false;
            try
            {
                IWebElement element = (IWebElement)appHandle.FindElement(Object);
                if (element.Displayed)
                    Results = true;
            }
            catch (System.Exception e)
            {
                Results = false;
            }

            if (Results == false)
            {
                Report.Fail("The object - '" + Object + "' is not exist.", "VerifyFieldValueDisplayed", "True", appHandle);
                return false;
            }
            return true;
        }


        /// <summary>
        /// This function is used Verify object exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.ConfirmObjectNotExistsInPage(Message);
        /// </example>
        //[Counter("ConfirmObjectNotExistsInPage")]
        public virtual bool ConfirmObjectNotExistsInPage(string Object)
        {
            bool Results = false;
            try
            {
                IWebElement element = (IWebElement)appHandle.FindElement(Object);
                if (element.Displayed)
                    Results = false;
                else
                    Results = true;

            }
            catch (System.Exception e)
            {
                return true;
            }

            if (Results == false)
            {
                Report.Fail("The object - '" + Object + "' is exist.", "ConfirmObjectNotExistsInPage", "True", appHandle);
                return false;
            }
            return true;
        }

        /// <summary>
        /// This function is used Verify object exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.IsObjectExistsInPage(Object);
        /// </example>
        //[Counter("IsObjectExistsInPage")]

        public virtual bool IsObjectExistsInPage(string Object, int Itreations = 4)
        {
            bool Results = false;
            try
            {
                int i = 1;
                do
                {
                    IWebElement element = (IWebElement)appHandle.FindElement(Object);
                    if (element.Displayed || element.Enabled)
                        Results = true;
                    else
                        Results = false;
                    i++;
                } while (Results == false && i < Itreations);
            }
            catch (System.Exception e)
            {
                return false;
            }
            return Results;

        }

        /// <summary>
        /// This function is used Verify object exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.VerifyObjectExistsInPage(Object);
        /// </example>
        //[Counter("VerifyObjectExistsInPage")]
        public virtual bool VerifyObjectExistsInPage(string Object)
        {
            bool Results = false;
            try
            {
                WaitSmallTimeForObject(Object);
                IWebElement element = (IWebElement)appHandle.FindElement(Object);
                if (element.Displayed)
                    Results = true;
            }
            catch (System.Exception e)
            {
                Results = false;
            }

            if (Results == true)
            {
                Report.Pass("The expected object - '" + Object + "' is exist.", "VerifyFieldValueDisplayed", "True", appHandle);
                return true;
            }
            if (Results == false)
            {
                Report.Fail("The expected object - '" + Object + "' is not exist.", "VerifyFieldValueDisplayed", "True", appHandle);
                return false;
            }
            return true;
        }

        /// <summary>
        /// This function is used Verify object exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.WaitIsObjectNotExistsInPage(Object);
        /// </example>
        //[Counter("WaitIsObjectNotExistsInPage")]

        public virtual bool WaitForObjectValueLoaded(string Object, int WaitTime = 30)
        {
            try
            {
                int i = 1;
                do
                {
                    if (WebLinkUtility.WebLinkUtilityLibrary.IsObjectExistsInPage(Object))
                        i++;
                    else
                        i = WaitTime;
                    appHandle.WaitForSpecifiedTime(1);
                }
                while (i < (WaitTime - 1));
                if (i == WaitTime)
                    return true;
            }
            catch (System.Exception e)
            {
            }
            return false;
        }


        /// <summary>
        /// This function is used Verify object exist in page.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.WaitTillObjectValuePresent(Object);
        /// </example>
        //[Counter("WaitTillObjectValuePresent")]

        public virtual bool WaitTillObjectValuePresent(string Object, string ExpectedValue = "", int waitime = 25)
        {

            int i = 1;
            do
            {
                try
                {
                    if (WebLinkUtility.WebLinkUtilityLibrary.IsObjectExistsInPage(Object))
                    {
                        string Values = appHandle.GetElementValue(Object);
                        if (Values == null)
                            Values = "";
                        if (ExpectedValue != "")
                        {
                            if (Values.ToUpper().Trim().Replace(" ", " ").Contains(ExpectedValue.ToUpper().Trim()) == true)
                            {
                                i = waitime;
                            }
                            else
                            {
                                i++;
                                appHandle.WaitForSpecifiedTime(1);
                            }
                        }
                        else
                        {
                            if (Values.Length > 0)
                            {
                                i = waitime;
                            }
                            else
                            {
                                i++;
                                appHandle.WaitForSpecifiedTime(1);
                            }
                        }
                    }
                    else
                    {
                        i++;
                    }
                }
                catch (System.Exception e) { i++; appHandle.WaitForSpecifiedTime(1); }
            }
            while (i < (waitime - 1));
            if (i == waitime)
            {
                return true;
            }
            else
            {
                Report.Info(ExpectedValue + " Not displayed or not loaded intime for object: " + Object);
                return false;
            }
        }

        /// <summary>
        /// This function is used to Select the Button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.VerifyCheckBoxStatus(Objectname,);
        /// </example>
        //[Counter("VerifyCheckBoxStatus")]
        public virtual bool VerifyCheckBoxStatus(string Objectname, string Status, bool ScreenCapture = true)
        {
            try
            {
                bool Validation = false;
                string ActualCheckBoxStatus = "";

                Status = Status.Trim();
                if (Status.ToUpper() == "YES")
                    Status = "ON";
                else if (Status.ToUpper() == "NO")
                    Status = "OFF";
                WebLinkUtility.WebLinkUtilityLibrary.WaitSmallTimeForObject(Objectname);
                bool CheckBoxStatus = appHandle.CheckCheckBoxChecked(Objectname);
                if (CheckBoxStatus == true)
                    ActualCheckBoxStatus = "ON";
                else
                    ActualCheckBoxStatus = "OFF";

                if (Status.ToUpper() == "ON" && ActualCheckBoxStatus == "ON")
                    Validation = true;
                if (Status.ToUpper() == "OFF" && ActualCheckBoxStatus == "OFF")
                    Validation = true;

                try
                {
                    if (Environment.GetEnvironmentVariable("ObjectName").ToString() != null && Environment.GetEnvironmentVariable("ObjectName").ToString() != "")
                        Status = Environment.GetEnvironmentVariable("ObjectName").ToString().ToUpper() + ": " + Status;
                }
                catch (System.Exception e) { string messages = e.Message; }

                if (Validation == true)
                {
                    if (ScreenCapture)
                        Report.Pass("The CheckBox status: '" + Status + "' is displayed Actual Status - '" + CheckBoxStatus + "'.", "VerifyCheckBoxStatus", "True", appHandle);
                    else
                        Report.Pass("The CheckBox status: '" + Status + "' is displayed Actual Status - '" + CheckBoxStatus + "'.", true);
                    return true;
                }
                else
                {
                    if (ScreenCapture)
                        Report.Fail("The CheckBox status: '" + Status + "' is not displayed Actual Status - '" + CheckBoxStatus + "'.", "VerifyCheckBoxStatus", "True", appHandle);
                    else
                        Report.Fail("The CheckBox status: '" + Status + "' is not displayed Actual Status - '" + CheckBoxStatus + "'.", true);
                    return false;
                }
            }
            catch (System.Exception e)
            {
                Report.Warning("Checkbox object is Disabled or not found and Xpath is: " + Objectname);
                string ExceptionMessage = e.Message;
            }
            return false;
        }

        /// <summary>
        /// This function is used to Select the Button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.SelectCheckBox(Objectname,);
        /// </example>
        //[Counter("SelectCheckBox")]
        public virtual bool SelectCheckBox(string Objectname, string Action)
        {
            try
            {
                if (Action.ToUpper() == "YES")
                    Action = "ON";
                else if (Action.ToUpper() == "NO")
                    Action = "OFF";
                WebLinkUtility.WebLinkUtilityLibrary.WaitSmallTimeForObject(Objectname);
                bool CheckBoxStatus = appHandle.CheckCheckBoxChecked(Objectname);
                if (Action.ToUpper() == "ON" && CheckBoxStatus == false)
                {
                    SelectButtonWithoutInfo(Objectname);
                    Report.Info(Objectname + " Check Box is selected.");
                }
                else if (Action.ToUpper() == "OFF" && CheckBoxStatus == true)
                {
                    SelectButtonWithoutInfo(Objectname);
                    Report.Info(Objectname + " Check Box is Un-selected.");
                }
                else
                    Report.Info(Objectname + " Check Box is already ." + Action);
                return true;
            }
            catch (System.Exception e)
            {
                Report.Warning("Button is not selected since object is Disabled or not found and Xpath is: " + Objectname);
                string ExceptionMessage = e.Message;
                // HandleUtilityException(ExceptionMessage);
            }
            return false;
        }


        /// <summary>
        /// This method is used to Get Current Processing GroupID in ACBS Servicing application.
        /// </summary>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetCurrentProcessingGroupID();
        /// </example>

        //[Counter("GetCurrentProcessingGroupID")]
        public string GetCurrentProcessingGroupID(string InputProcessingGroupID = null, string OverideProcessingGroupID = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string ActualProcessingGroupID = "";
                if (InputProcessingGroupID == null || InputProcessingGroupID == "")
                {
                    ActualProcessingGroupID = StartupConfiguration.UserSettings.ProcessingGroupID.ToString();
                    if (ActualProcessingGroupID == null || ActualProcessingGroupID == "")
                        ActualProcessingGroupID = Data.Fetch("ConfigurationSetup", "GLOBAL_PROCESSINGGROUP1_ID");
                    StartupConfiguration.UserSettings.ProcessingGroupID = ActualProcessingGroupID;

                }
                else
                {
                    ActualProcessingGroupID = Data.Get(InputProcessingGroupID);
                    if (ActualProcessingGroupID == null || ActualProcessingGroupID == "")
                        ActualProcessingGroupID = Data.Fetch("ConfigurationSetup", InputProcessingGroupID);
                }
                if (OverideProcessingGroupID != null)
                    StartupConfiguration.UserSettings.ProcessingGroupID = ActualProcessingGroupID;

                return ActualProcessingGroupID;
            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
            return null;
        }
        /// <summary>
        /// This method is used to Get Current Processing Group Name in ACBS Servicing application.
        /// </summary>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetCurrentProcessingGroupName();
        /// </example>
        //[Counter("GetCurrentProcessingGroupName")]
        public string GetCurrentProcessingGroupName(string InputProcessingGroupName = null, string OverideProcessingGroupName = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string ActualProcessingGroupName = "";
                if (InputProcessingGroupName == null || InputProcessingGroupName == "")
                {
                    ActualProcessingGroupName = StartupConfiguration.UserSettings.ProcessingGroupName.ToString();
                    if (ActualProcessingGroupName == null || ActualProcessingGroupName == "")
                        ActualProcessingGroupName = Data.Fetch("ConfigurationSetup", "GLOBAL_PROCESSINGGROUP1_NAME");
                    StartupConfiguration.UserSettings.ProcessingGroupName = ActualProcessingGroupName;

                }
                else
                {
                    ActualProcessingGroupName = Data.Get(InputProcessingGroupName);
                    if (ActualProcessingGroupName == null || ActualProcessingGroupName == "")
                        ActualProcessingGroupName = Data.Fetch("ConfigurationSetup", InputProcessingGroupName);
                }
                if (OverideProcessingGroupName != null)
                    StartupConfiguration.UserSettings.ProcessingGroupName = ActualProcessingGroupName;

                return ActualProcessingGroupName;
            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
            return null;
        }
        /// <summary>
        /// This method is used to Get Current PortFolioID in ACBS Servicing application.
        /// </summary>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetCurrentPortFolioID();
        /// </example>
        //[Counter("GetCurrentPortFolioID")]
        public string GetCurrentPortFolioID(string InputPortFolioID = null, string OveridePortFolioID = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string ActualPortFolioID = "";
                if (InputPortFolioID == null || InputPortFolioID == "")
                {
                    ActualPortFolioID = StartupConfiguration.UserSettings.PortFolioID.ToString();
                    if (ActualPortFolioID == null || ActualPortFolioID == "")
                        ActualPortFolioID = Data.Fetch("ConfigurationSetup", "GLOBAL_PORTFOLIO1_ID");
                    StartupConfiguration.UserSettings.PortFolioID = ActualPortFolioID;

                }
                else
                {
                    ActualPortFolioID = Data.Get(InputPortFolioID);
                    if (ActualPortFolioID == null || ActualPortFolioID == "")
                        ActualPortFolioID = Data.Fetch("ConfigurationSetup", InputPortFolioID);
                }
                if (OveridePortFolioID != null)
                    StartupConfiguration.UserSettings.PortFolioID = ActualPortFolioID;
                return ActualPortFolioID;
            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
            return null;
        }
        /// <summary>
        /// This method is used to Get Current PortFolio Name in ACBS Servicing application.
        /// </summary>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetCurrentPortFolioName();
        /// </example>

        //[Counter("GetCurrentPortFolioName")]
        public string GetCurrentPortFolioName(string InputPortFolioName = null, string OveridePortFolioName = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string ActualPortFolioName = "";
                if (InputPortFolioName == null || InputPortFolioName == "")
                {
                    ActualPortFolioName = StartupConfiguration.UserSettings.PortFolioName.ToString();
                    if (ActualPortFolioName == null || ActualPortFolioName == "")
                        ActualPortFolioName = Data.Fetch("ConfigurationSetup", "GLOBAL_PORTFOLIO1_NAME");
                    StartupConfiguration.UserSettings.PortFolioName = ActualPortFolioName;

                }
                else
                {
                    ActualPortFolioName = Data.Get(InputPortFolioName);
                    if (ActualPortFolioName == null || ActualPortFolioName == "")
                        ActualPortFolioName = Data.Fetch("ConfigurationSetup", InputPortFolioName);
                }
                if (OveridePortFolioName != null)
                    StartupConfiguration.UserSettings.PortFolioName = ActualPortFolioName;
                return ActualPortFolioName;
            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
            return null;
        }
        /// <summary>
        /// This method is used to Get Current Servicing Queue Name in ACBS Servicing application.
        /// </summary>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetCurrentServicingQueueName();
        /// </example>
        //[Counter("GetCurrentServicingQueueName")]
        public string GetCurrentServicingQueueName(string InputServicingQueueName = null, string OverideServicingQueueName = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string ActualServicingQueueName = "";
                if (InputServicingQueueName == null || InputServicingQueueName == "")
                {
                    ActualServicingQueueName = StartupConfiguration.UserSettings.ServicingQueueName.ToString();
                    if (ActualServicingQueueName == null || ActualServicingQueueName == "")
                        ActualServicingQueueName = Data.Fetch("ConfigurationSetup", "GLOBAL_SERVICINGQUEUE1_NAME");
                    StartupConfiguration.UserSettings.ServicingQueueName = ActualServicingQueueName;

                }
                else
                {
                    ActualServicingQueueName = Data.Get(InputServicingQueueName);
                    if (ActualServicingQueueName == null || ActualServicingQueueName == "")
                        ActualServicingQueueName = Data.Fetch("ConfigurationSetup", InputServicingQueueName);
                }
                if (OverideServicingQueueName != null)
                    StartupConfiguration.UserSettings.ServicingQueueName = ActualServicingQueueName;
                return ActualServicingQueueName;
            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
            return null;
        }
        /// <summary>
        /// This method is used to Get Current Calendar Name in ACBS Servicing application.
        /// </summary>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetCurrentCalendarName();
        /// </example>
        //[Counter("GetCurrentCalendarName")]

        public string GetCurrentCalendarName(string InputCalendarDescription = null, string OverideCalendarDescription = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string ActualCalendarDescription = "";
                if (InputCalendarDescription == null || InputCalendarDescription == "")
                {
                    ActualCalendarDescription = StartupConfiguration.UserSettings.CalendarName.ToString();
                    if (ActualCalendarDescription == null || ActualCalendarDescription == "")
                        ActualCalendarDescription = Data.Fetch("ConfigurationSetup", "GLOBAL_CALENDAR1_NAME");
                    StartupConfiguration.UserSettings.CalendarName = ActualCalendarDescription;

                }
                else
                {
                    ActualCalendarDescription = Data.Get(InputCalendarDescription);
                    if (ActualCalendarDescription == null || ActualCalendarDescription == "")
                        ActualCalendarDescription = Data.Fetch("ConfigurationSetup", InputCalendarDescription);
                }
                if (OverideCalendarDescription != null)
                    StartupConfiguration.UserSettings.CalendarName = ActualCalendarDescription;

                return ActualCalendarDescription;
            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
            return null;
        }
        /// <summary>
        /// This method is used to Get Current CalendarID in ACBS Servicing application.
        /// </summary>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetCurrentCalendarID();
        /// </example>
        //[Counter("GetCurrentCalendarID")]
        public string GetCurrentCalendarID(string InputCalendarID = null, string OverideCalendarID = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string ActualCalendarID = "";
                if (InputCalendarID == null || InputCalendarID == "")
                {
                    ActualCalendarID = StartupConfiguration.UserSettings.CalendarID.ToString();
                    if (ActualCalendarID == null || ActualCalendarID == "")
                        ActualCalendarID = Data.Fetch("ConfigurationSetup", "GLOBAL_CALENDAR1_ID");
                    StartupConfiguration.UserSettings.CalendarID = ActualCalendarID;
                }
                else
                {
                    ActualCalendarID = Data.Get(InputCalendarID);
                    if (ActualCalendarID == null || ActualCalendarID == "")
                        ActualCalendarID = Data.Fetch("ConfigurationSetup", InputCalendarID);
                }
                if (OverideCalendarID != null)
                    StartupConfiguration.UserSettings.CalendarID = ActualCalendarID;

                return ActualCalendarID;
            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
            return null;
        }
        /// <summary>
        /// This method is used to Get Current Rate Index ID in ACBS Servicing application.
        /// </summary>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetCurrentRateIndexID();
        /// </example>
        //[Counter("GetCurrentRateIndexID")]
        public string GetCurrentRateIndexID(string InputIndexID = null, string OverideIndexID = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string ActualIndexID = "";
                if (InputIndexID == null || InputIndexID == "")
                {
                    ActualIndexID = StartupConfiguration.UserSettings.RateIndexID.ToString();
                    if (ActualIndexID == null || ActualIndexID == "")
                        ActualIndexID = Data.Fetch("ConfigurationSetup", "GLOBAL_RATE_INDEX1_ID");
                    StartupConfiguration.UserSettings.RateIndexID = ActualIndexID;

                }
                else
                {
                    ActualIndexID = Data.Get(InputIndexID);
                    if (ActualIndexID == null || ActualIndexID == "")
                        ActualIndexID = Data.Fetch("ConfigurationSetup", InputIndexID);
                }
                if (OverideIndexID != null)
                    StartupConfiguration.UserSettings.RateIndexID = ActualIndexID;

                return ActualIndexID;
            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
            return null;
        }
        /// <summary>
        /// This method is used to Get Current RateIndex Name in ACBS Servicing application.
        /// </summary>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetCurrentRateIndexName();
        /// </example>
        //[Counter("GetCurrentRateIndexName")]
        public string GetCurrentRateIndexName(string InputIndexDescription = null, string OverideIndexID = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string ActualIndexDescription = "";
                if (InputIndexDescription == null || InputIndexDescription == "")
                {
                    ActualIndexDescription = StartupConfiguration.UserSettings.RateIndexName.ToString();
                    if (ActualIndexDescription == null || ActualIndexDescription == "")
                        ActualIndexDescription = Data.Fetch("ConfigurationSetup", "GLOBAL_RATE_INDEX1_NAME");
                    StartupConfiguration.UserSettings.RateIndexName = ActualIndexDescription;

                }
                else
                {
                    ActualIndexDescription = Data.Get(InputIndexDescription);
                    if (ActualIndexDescription == null || ActualIndexDescription == "")
                        ActualIndexDescription = Data.Fetch("ConfigurationSetup", InputIndexDescription);

                }

                if (OverideIndexID != null)
                    StartupConfiguration.UserSettings.RateIndexName = ActualIndexDescription;

                return ActualIndexDescription;
            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
            return null;
        }

        /// <summary>
        /// This function is used to set radio button on/off.
        /// </summary>
        /// <param name="ActualObject"></param>
        /// <param name="Action"></param>
        /// <returns>True/False</returns>
        /// <example>
        /// bool Result = WebLinkUtility.WebLinkUtilityLibrary.SetRadioButton(SearchByCustomerRadioButton, "ON");
        /// </example>
        //[Counter("SetRadioButton")]

        public virtual bool SelectRadioButton(object ActualObject, string Action)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                bool results = appHandle.CheckRadiobuttonSelected(ActualObject);
                if (Action.ToUpper() == "YES")
                    Action = "ON";
                else if (Action.ToUpper() == "NO")
                    Action = "OFF";
                if (Action.ToUpper() == "ON" && results == false)
                    appHandle.ClickObject(ActualObject);
                if (Action.ToUpper() == "OFF" && results == true)
                    appHandle.ClickObject(ActualObject);
                return true;
            }
            catch (System.Exception e)
            {
                Report.Warning("SelectedRadioButton image not identified");
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return false;
        }

        /// <summary>
        /// This function is used to calculate interest amount for 1 day as per Year basis.
        /// </summary>
        /// <param name="Amount"></param>
        /// <param name="InterestPercentage"></param>
        /// <param name="YearBasis"></param>
        /// <param name="Year"></param>
        /// <returns>Interest amount</returns>
        /// <example>
        /// double IntAmount = WebLinkUtility.WebLinkUtilityLibrary.CalculateInterestAccrualAmountPerDay("345090", "2.75", "Actual/365");
        /// </example>
        //[Counter("CalculateInterestAccrualAmountPerDay")]
        public virtual double CalculateInterestAccrualAmountPerDay(double Amount, double InterestPercentage, string YearBasis, [Optional] int Year)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                double InterestAmountPerDay = 0;
                switch (YearBasis.ToUpper())
                {
                    case "ACTUAL/365":
                        InterestAmountPerDay = ((Amount / 100) / 365) * InterestPercentage;
                        break;
                    case "ACTUAL/360":
                        InterestAmountPerDay = ((Amount / 100) / 360) * InterestPercentage;
                        break;
                    case "30E/365":
                        InterestAmountPerDay = ((Amount / 100) / 365) * InterestPercentage;
                        break;
                    case "30E/360":
                        InterestAmountPerDay = ((Amount / 100) / 360) * InterestPercentage;
                        break;
                    case "ACTUAL/365/366":
                        if (appHandle.IsLeapYear(Year))
                            InterestAmountPerDay = ((Amount / 100) / 366) * InterestPercentage;
                        else
                            InterestAmountPerDay = ((Amount / 100) / 365) * InterestPercentage;
                        break;
                    case "30E/365/366":
                        if (appHandle.IsLeapYear(Year))
                            InterestAmountPerDay = ((Amount / 100) / 366) * InterestPercentage;
                        else
                            InterestAmountPerDay = ((Amount / 100) / 365) * InterestPercentage;
                        break;
                    default:
                        break;
                }
                return InterestAmountPerDay;
            }
            catch (System.Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
                return 0;
            }
        }

        /// <summary>
        /// This function is used to count number of days present between the given two dates.
        /// </summary>
        /// <param name="Date1"></param>
        /// <param name="Date2"></param>
        /// <param name="YearBasisType"></param>
        /// <returns>Date Difference days</returns>
        /// <example>
        /// int Result = WebLinkUtility.WebLinkUtilityLibrary.CalculateDateDifference(SystemDateMinus6Months, GLOBAL_SYSTEM_DATE, "ACTUAL");
        /// </example>
        //[Counter("CalculateDateDifference")]
        public virtual int CalculateDateDifference(String Date1, string Date2, string YearBasisType)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string LastDateOfDate1 = null;
                int DateDifference = 0;
                int FirstMonthDateDifference = 0;
                string[] Date1Fields = Date1.Split('/');
                string[] Date2Fields = Date2.Split('/');

                if (Date1Fields[0] == "02" || Date1Fields[0] == "2")
                    LastDateOfDate1 = Date1Fields[0] + "/" + "28" + "/" + Date1Fields[2];
                else
                    LastDateOfDate1 = Date1Fields[0] + "/" + "30" + "/" + Date1Fields[2];
                string FirstDateOfDate2 = Date2Fields[0] + "/" + "01" + "/" + Date2Fields[2];
                string PreviousDay = appHandle.CalculateNewDate(FirstDateOfDate2, "D", -1);

                if (YearBasisType.ToUpper().IndexOf("ACTUAL") != -1)
                {
                    DateDifference = appHandle.GetDateDiff(Date1, Date2, "D");
                }
                if (YearBasisType.ToUpper().IndexOf("30E") != -1)
                {
                    LastDateOfDate1 = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(LastDateOfDate1, "M/dd/yyyy");
                    string[] PreviousDays = PreviousDay.Split('/');
                    FirstMonthDateDifference = appHandle.GetDateDiff(Date1, LastDateOfDate1, "D");
                    if ((Date1Fields[0] == "02" || Date1Fields[0] == "2"))
                    {
                        if (LastDateOfDate1.Split('/')[1] == "28")
                            FirstMonthDateDifference = FirstMonthDateDifference + 3;
                        else if (LastDateOfDate1.Split('/')[1] == "29")
                            FirstMonthDateDifference = FirstMonthDateDifference + 2;
                    }
                    string startDate = PreviousDay;
                    DateTime sDate = Convert.ToDateTime(startDate);
                    string endDate = LastDateOfDate1;
                    DateTime eDate = Convert.ToDateTime(endDate);
                    int monthsApart = 12 * (sDate.Year - eDate.Year) + sDate.Month - eDate.Month;
                    int months = Math.Abs(monthsApart);
                    DateDifference = FirstMonthDateDifference + (months) * 30 + appHandle.GetDateDiff(PreviousDay, Date2, "D");
                }
                return Math.Abs(DateDifference);
            }
            catch (System.Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
                return 0;
            }
        }

        /// <summary>
        /// This function is used to verify specified image is present/available in window.
        /// </summary>
        /// <param name="WindowName"></param>
        /// <param name="imagepath"></param>
        /// <param name="ImageName"></param>
        /// <returns>True/False</returns>
        /// <example>
        /// bool Result = WebLinkUtility.WebLinkUtilityLibrary.VerifyImageExistInPage(WindowName, imagepath, ImageName);
        /// </example>
        //[Counter("VerifyImageExistInPage")]
        public virtual bool VerifyImageExistInPage(string WindowName, string imagepath, string ImageName, bool ScreenCapture = true)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                bool Result = appHandle.CheckObjectByImage(imagepath + ImageName + ".png");

                if (Result)
                {
                    if (ScreenCapture)
                        Report.Pass("The Image: " + ImageName + " is present in window: " + WindowName + ".", "VerifyImageExistsInWindow", "True", appHandle);
                    else
                        Report.Pass("The Image: " + ImageName + " is present in window: " + WindowName + ".", "True", appHandle);
                    return true;
                }
                else
                {
                    if (ScreenCapture)
                        Report.Fail("The Image: " + ImageName + " is not present in window: " + WindowName + ".", "VerifyImageExistsInWindow", "True", appHandle);
                    else
                        Report.Fail("The Image: " + ImageName + " is not present in window: " + WindowName + ".", "True", appHandle);
                    return false;
                }
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return false;
        }
        /// <summary>
        /// This method is used to select/click image.
        /// </summary>
        /// <param name="ImageName"></param>
        /// <returns>None</returns>
        /// <example>
        ///  WebLinkUtility.WebLinkUtilityLibrary.SelectImage("View");
        /// </example>

        [Counter("SelectImage")]
        public virtual bool SelectImage(string ImageName, MouseClick ClickType = MouseClick.LeftClick)
        {
            try
            {
                appHandle.ClickObjectByImage(ImagePath + ImageName + ".png", ClickType);
                Report.Info(ImageName + " Image clicked successfully.");
                Thread.Sleep(1000);
                return true;
            }
            catch (Exception e)
            {
                Report.Warning("The expected Image: " + ImageName + " is not present in current window.");
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return false;
        }


        /// <summary>
        /// This function is used to verify specified image is not available in window.
        /// </summary>
        /// <param name="WindowName"></param>
        /// <param name="imagepath"></param>
        /// <param name="ImageName"></param>
        /// <returns>True/False</returns>
        /// <example>
        /// bool Result = WebLinkUtility.WebLinkUtilityLibrary.VerifyImageNotExistInPage(WindowName, imagepath, ImageName);
        /// </example>
        //[Counter("VerifyImageNotExistInPage")]
        public virtual bool VerifyImageNotExistInPage(string WindowName, string imagepath, string ImageName)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                bool Result = appHandle.CheckObjectByImage(imagepath + ImageName + ".png");
                if (Result)
                {
                    Report.Fail("The Image: " + ImageName + " is present in window: " + WindowName, "CheckImageExistsInWindow", "True", appHandle);
                    return true;
                }
                else
                {
                    Report.Pass("The Image: " + ImageName + " is not available in window: " + WindowName, "CheckImageExistsInWindow", "True", appHandle);
                    return false;
                }
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return false;
        }


        /// <summary>
        /// This function is used to get date in specific date format.
        /// </summary>
        /// <param name="InputDate"></param>
        /// <param name="ExpectedFormat"></param>
        /// <returns>Date in specified format</returns>
        /// <example>
        /// string Date1 = WebLinkUtility.WebLinkUtilityLibrary.GetSpecificDateFormat(GLOBAL_SYSTEM_DATE, "DDMMMYYYY");
        /// </example>
        //[Counter("GetSpecificDateFormat")]
        public virtual string GetSpecificDateFormat(string InputDate, string ExpectedFormat)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                switch (ExpectedFormat.ToUpper())
                {
                    case "DDMMMYYYY":
                        string Date = InputDate.Split('/')[1].ToString();
                        int Month = int.Parse(InputDate.Split('/')[0]);
                        string Year = InputDate.Split('/')[2].ToString();
                        if (Year.Length != 4)
                            Year = "20" + Year;
                        if (Date.Length != 2)
                            Date = "0" + Date;
                        return Date + appHandle.GetMonthNameFromMonthNo(Month).ToUpper() + Year;

                    default:
                        break;
                }
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        //*****************************************************************************************************************************
        // UDF NAME                 : GetQuarterEnd
        // Purpose                  : This function is used to get Present or Previous or Next Quarter end Month name by default. If required full date, pass last parameter:QFulldate as Yes.
        // Input Parameter          : Month Number,Option(Previous/Present/Next),
        // Out Parameter            : Quarterend Month name
        // Limitations              : none
        // Example1                   string date1="1/25/11";
        //                          : string result=WebLinkUtility.WebLinkUtilityLibrary.GetQuarterEnd(date1,"Present");
        //                          : string result=WebLinkUtility.WebLinkUtilityLibrary.GetQuarterEnd(date1,"Present","Yes");
        // ****************************************************************************************************************************
        // 11/26/2019               : Sankar Reddy
        //***************************************************************************************************************************************************

        /// <summary>
        /// This function is used to get quarter end month name for present/previous/next quarters as per date.
        /// </summary>
        /// <param name="currentdate"></param>
        /// <param name="QOption"></param>
        /// <param name="QFulldate"></param>
        /// <returns>Quarter end Month name</returns>
        /// <example>
        /// string Date1 = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterEnd(GLOBAL_SYSTEM_DATE, "Present")
        /// </example>
        //[Counter("GetQuarterEnd")]
        public virtual string GetQuarterEnd(string currentdate, string QOption, string QFulldate = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                DateTime date2 = Convert.ToDateTime(currentdate);
                string monthname = date2.ToString("MMMM").ToUpper();
                string Option = QOption.ToUpper();
                switch (monthname)
                {
                    case "JANUARY":
                    case "FEBRUARY":
                    case "MARCH":
                        if (Option == "PREVIOUS")
                            return "DECEMBER";
                        else if (Option == "PRESENT")
                            return "MARCH";
                        else if (Option == "NEXT")
                            return "JUNE";
                        break;
                    case "APRIL":
                    case "MAY":
                    case "JUNE":
                        if (Option == "PREVIOUS")
                            return "MARCH";
                        else if (Option == "PRESENT")
                            return "JUNE";
                        else if (Option == "NEXT")
                            return "SEPTEMBER";
                        break;
                    case "JULY":
                    case "AUGUST":
                    case "SEPTEMBER":
                        if (Option == "PREVIOUS")
                            return "JUNE";
                        else if (Option == "PRESENT")
                            return "SEPTEMBER";
                        else if (Option == "NEXT")
                            return "DECEMBER";
                        break;
                    case "OCTOBER":
                    case "NOVEMBER":
                    case "DECEMBER":
                        if (Option == "PREVIOUS")
                            return "SEPTEMBER";
                        else if (Option == "PRESENT")
                            return "DECEMBER";
                        else if (Option == "NEXT")
                            return "MARCH";
                        break;
                    default:
                        break;
                }
            }
            catch (System.Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        //*****************************************************************************************************************************
        // UDF NAME                 : GetDateTimeParameters
        // Purpose                  : This function is used to get day,month,year,hour,minute and second from the date.
        // Input Parameter          : Date
        // Out Parameter            : Day,Month,Year,hour,minute,second
        // Limitations              : none
        // Example1                   string date1="1/25/11";
        //                          : string result=WebLinkUtility.WebLinkUtilityLibrary.GetDateTimeParameters(date1,"month");
        // ****************************************************************************************************************************
        // 11/26/2019               : Sankar Reddy
        //***************************************************************************************************************************************************

        /// <summary>
        /// This function is used to get day/month/year from date and hours/seconds/minutes from time.
        /// </summary>
        /// <param name="currentdate"></param>
        /// <param name="Option"></param>
        /// <returns>Date/Time values</returns>
        /// <example>
        /// string year1 = WebLinkUtility.WebLinkUtilityLibrary.GetDateTimeParameters(GLOBAL_SYSTEM_DATE, "year");
        /// </example>
        //[Counter("GetDateTimeParameters")]
        public virtual string GetDateTimeParameters(string currentdate, string Option)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                DateTime date2 = Convert.ToDateTime(currentdate);
                string Option1 = Option.ToUpper();
                switch (Option1)
                {
                    case "DAY":
                        string day = (date2.Day).ToString();
                        return day;
                    case "MONTH":
                        string month = (date2.Month).ToString();
                        return month;
                    case "YEAR":
                        string year = (date2.Year).ToString();
                        return year;
                    case "HOUR":
                        string hour = (date2.Hour).ToString();
                        return hour;
                    case "MINUTE":
                        string minute = (date2.Minute).ToString();
                        return minute;
                    case "SECOND":
                        string second = (date2.Second).ToString();
                        return second;
                    default:
                        break;
                }
            }
            catch (System.Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        /// <summary>
        /// This function is used to verify data not present in PDF document and attached PDF document to Test results.
        /// </summary>
        /// <param name="FilePath"></param>
        /// <param name="SearchInformation"></param>
        /// <param name="bAttachFile"></param>
        /// <returns>True/False</returns>
        /// <example>
        /// bool Result = WebLinkUtility.WebLinkUtilityLibrary.VerifyPDFContentNotExist("201912270022510", Notificationdata, true);
        /// </example>
        //[Counter("VerifyPDFContentNotExist")]
        public virtual bool VerifyPDFContentNotExist(string FilePath, List<string> SearchInformation, bool bAttachFile = true)
        {
            try
            {
                PDFApplication PDFHandle;
                PDFHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.PDF);
                string PDFContent = PDFHandle.ExtractTextFromPDF(FilePath);
                PDFContent = PDFContent.Replace("\r\n", " ");
                if (bAttachFile)
                    Report.Info("Please find below PDF document for your reference.", FilePath);

                for (int i = 0; i <= (SearchInformation.Count) - 1; i++)
                {
                    if (PDFContent.Contains(SearchInformation[i]) == true)
                        Report.Fail("The Expected information: " + SearchInformation[i] + " is present in PDF document.", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB));
                    else
                        Report.Pass("The Expected information: " + SearchInformation[i] + " is not present in PDF document.", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB));
                }
            }
            catch (System.Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return true;
        }


        /// <summary>
        /// This function is used to verify data from PDF document and attached PDF document to Test results.
        /// </summary>
        /// <param name="FilePath"></param>
        /// <param name="SearchInformation"></param>
        /// <param name="bAttachFile"></param>
        /// <returns>True/False</returns>
        /// <example>
        /// bool Result = WebLinkUtility.WebLinkUtilityLibrary.VerifyPDFContent("201912270022510", Notificationdata, true);
        /// </example>
        //[Counter("VerifyPDFContent")]
        public virtual bool VerifyPDFContent(string FilePath, List<string> SearchInformation, bool bAttachFile = false)
        {
            try
            {
                PDFApplication PDFHandle;
                PDFHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.PDF);
                string PDFContent = PDFHandle.ExtractTextFromPDF(FilePath);
                PDFContent = PDFContent.Replace("\r\n", " ");
                if (bAttachFile)
                    Report.Info("Please find below PDF document for your reference.", FilePath);

                for (int i = 0; i <= (SearchInformation.Count) - 1; i++)
                {
                    if (PDFContent.Contains(SearchInformation[i]) == true)

                        Report.Pass("The Expected information: " + SearchInformation[i] + " is present in " + FilePath + " document.", "True", appHandle);
                    else
                        Report.Fail("The Expected information: " + SearchInformation[i] + " is not present in " + FilePath + " document.", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB));
                }
            }
            catch (System.Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return true;
        }


        /// <summary>
        /// This method is used to return the double value to string with currency format and specified in decimal digits.
        /// </summary>
        /// <param name="InputStringOrNum"></param>
        /// <param name="NoOfDigit"></param>
        /// <returns>-1/string</returns>
        /// <example>
        /// string String1 = LIBORModel.ConvertDoubleTostring(10.46, 1); -- > 10.4
        /// string String1 = LIBORModel.ConvertDoubleTostring(0.46, 2); ---> 0.46
        /// string String1 = LIBORModel.ConvertDoubleTostring(4.46, 3); ---> 4.460
        /// string String1 = LIBORModel.ConvertDoubleTostring(3434.4, 5); ---> 3,434.40000
        /// </example>
        //[Counter("ConvertDoubleTostring")]
        public virtual string ConvertDoubleTostring(object InputStringOrNum, int NoOfDigit = 2)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                if (InputStringOrNum.ToString().IndexOf(",") != -1)
                    InputStringOrNum = InputStringOrNum.ToString().Replace(",", "");
                double InputVal = Convert.ToDouble(InputStringOrNum);
                int StartPostion = InputVal.ToString().IndexOf(".");
                string CurrencyOrRate = "0";
                if (StartPostion != -1)
                {
                    string[] splitArray = InputVal.ToString().Split('.');
                    CurrencyOrRate = splitArray[0];
                }
                else
                {
                    StartPostion = InputVal.ToString().Length;
                }
                int Endpostion = StartPostion + NoOfDigit + 1;
                string InputVal1 = InputVal.ToString("0.000000000000000000000000");
                string OutDoubleValue = InputVal1.Substring(0, Endpostion);
                if (CurrencyOrRate.Length > 3 && NoOfDigit <= 2 || StartPostion > 3)
                    OutDoubleValue = double.Parse(OutDoubleValue).ToString("C").Replace("$", "");
                if (OutDoubleValue.Substring(0, 2).IndexOf("0.") != -1)
                    OutDoubleValue = OutDoubleValue.Replace("0.", ".");
                if (OutDoubleValue.Substring(0, 3).IndexOf("-0.") != -1)
                    OutDoubleValue = OutDoubleValue.Replace("-0.", "-.");
                return OutDoubleValue;
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return "-1";
        }

        /// <summary>
        /// This function is used to report the Fail information to test results document.
        /// </summary>
        /// <param name="ReportString"></param>
        /// <param name="MethodName"></param>
        /// <returns>True/False</returns>
        /// <example>
        /// bool Result = WebLinkUtility.WebLinkUtilityLibrary.ReportStatus("Info","Storing Next Rate Maturity Date, Next Rate Setting Date and Bundle Name in output file.");
        /// </example>
        //[Counter("Fail")]
        public virtual bool Fail(string ReportString, string MethodName, string bCaptureReportStmt, bool bExitTestOnFail = false)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                Report.Fail(ReportString, MethodName, bCaptureReportStmt, ApplicationHandlerFactory.GetApplication(ApplicationType.WEB));
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return true;
        }
        /// <summary>
        /// This function is used to return date like 10 days before processing date/1 year after processing date etc.
        /// </summary>
        /// <param name="InputDate"></param>
        /// <param name="DateParam"></param>
        /// <param name="NumberOfDay"></param>
        /// <returns>Calculated Date</returns>
        /// <example>
        /// string Date1 = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(GLOBAL_SYSTEM_DATE, "m", 24);
        /// </example>
        //[Counter("CalculateNewDate")]
        public virtual string CalculateNewDate(string InputDate, string DateParam, int NumberOfDay)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                return appHandle.CalculateNewDate(InputDate, DateParam, NumberOfDay);

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        /// <summary>
        /// This fucntion is used to convert date in given format.
        /// </summary>
        /// <param name="Date"></param>
        /// <param name="Format"></param>
        /// <returns>Converted Date</returns>
        /// <example>
        /// string Date1 = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(GLOBAL_SYSTEM_DATE, "M/dd/yy");
        /// </example>
        //[Counter("ConvertDateInGivenFormat")]
        public virtual string ConvertDateInGivenFormat(string Date, string Format)
        {
            try
            {
                if (Date != null && Date != "" && Date != "00/00/00")
                {
                    appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                    if (Format.ToUpper() != "M/D/YY")
                    {
                        return appHandle.ConvertDateInGivenFormat(Date, Format);
                    }
                    else
                    {
                        string Dates = appHandle.ConvertDateInGivenFormat(Date, Format);
                        string[] DatesArray = SplitString(Dates, "/");
                        if (SplitSideString(DatesArray[1], "LEFT", 1) == "0")
                            return DatesArray[0] + "/" + SplitSideString(DatesArray[1], "RIGHT", 1) + "/" + DatesArray[1];
                        else
                            return Dates;
                    }
                }
                else
                {
                    return Date;
                }

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        /// <summary>
        /// This function is used to get roundoff value as per digits specified.
        /// </summary>
        /// <param name="InputVal"></param>
        /// <param name="NoOfDigit"></param>
        /// <returns>Roundoff Value</returns>
        /// <example>
        /// double val1 = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue("1.24352", "2");
        /// </example>
        //[Counter("RoundOffValue")]
        public double RoundOffValue(double InputVal, int NoOfDigit)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                if (NoOfDigit <= 15)
                {
                    return appHandle.RoundOffValue(InputVal, NoOfDigit);
                }
                else
                {
                    decimal x = Decimal.Round(Convert.ToDecimal(InputVal), NoOfDigit);
                    return Decimal.ToDouble(x);

                }
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }

        /// <summary>
        /// This function is used to get date difference value from 2 different dates.
        /// </summary>
        /// <param name="firstDate"></param>
        /// <param name="secondDate"></param>
        /// <param name="dateInterval"></param>
        /// <returns>Date difference value</returns>
        /// <example>
        /// int val1 = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(SystemDateMinus6Months, MaturityDate, "D");
        /// </example>
        //[Counter("GetDateDiff")]
        public virtual int GetDateDiff(string firstDate, string secondDate, string dateInterval)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                return appHandle.GetDateDiff(firstDate, secondDate, dateInterval);

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }
        /// <summary>
        /// This function is used to active Dialog/window.
        /// </summary>
        /// <returns>True/False</returns>
        /// <example>
        /// bool Result = WebLinkUtility.WebLinkUtilityLibrary.ActivateWindowByProcessName("NotePad");
        /// </example>
        //[Counter("ActivateWindowByProcessName")]
        public virtual void ActivateWindowByProcessName(string ProcessName)
        {
            try
            {
                Process currentProcess = Process.GetCurrentProcess();
                foreach (var p in Process.GetProcesses())
                {
                    if (p.ProcessName.ToUpper().Equals(ProcessName.ToUpper()) == true)
                    {
                        IntPtr hFound = p.MainWindowHandle;
                        if (User32API.IsIconic(hFound)) // If application is in ICONIC mode then  
                            User32API.ShowWindow(hFound, User32API.SW_RESTORE);
                        User32API.SetForegroundWindow(hFound); // Activate the window, if process is already running  
                        break;
                    }
                }
            }
            catch (Exception e)
            {
                Report.Warning("Unable to select the Context Menu Item.");
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
        }

        /// <summary>
        /// This function is used to generate random string/digits/combination of characters and digits etc.
        /// </summary>
        /// <param name="FT"></param>
        /// <param name="iMin"></param>
        /// <param name="iMax"></param>
        /// <param name="iLength"></param>
        /// <returns>Random data</returns>
        /// <example>
        /// object Result = WebLinkUtility.WebLinkUtilityLibrary.CreateRandomData(FieldType.NUMERIC, 7000, 9999);
        /// </example>
        //[Counter("CreateRandomData")]
        public object CreateRandomData(FieldType FT, int iMin = 0, int iMax = 0, int iLength = 0)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                switch (FT)
                {
                    case FieldType.NUMERIC:
                        return appHandle.CreateRamdomData(FieldType.NUMERIC, iMin, iMax, iLength);
                    case FieldType.ALPHABETS:
                        return appHandle.CreateRamdomData(FieldType.ALPHABETS, iMin, iMax, iLength);
                    case FieldType.ALPHANUMERICS:
                        return appHandle.CreateRamdomData(FieldType.ALPHANUMERICS, iMin, iMax, iLength);
                    case FieldType.ALL:
                        return appHandle.CreateRamdomData(FieldType.ALL, iMin, iMax, iLength); ;
                    default:
                        break;
                }
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }

        /// <summary>
        /// This function is used to get calendar date.
        /// </summary>
        /// <param name="ReqFormat"></param>
        /// <returns>Calendar date</returns>
        /// <example>
        /// string Result = WebLinkUtility.WebLinkUtilityLibrary.GetCalendarDate("m/d/yy");
        /// </example>
        //[Counter("GetCalendarDate")]
        public virtual string GetCalendarDate(string ReqFormat)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                return appHandle.GetCalendarDate(ReqFormat);
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        /// <summary>
        /// This function is used to split and return left side/right side of string as per specified number.
        /// </summary>
        /// <param name="MainString"></param>
        /// <param name="Side"></param>
        /// <param name="NumberOfString"></param>
        /// <param name="Index"></param>
        /// <returns>Split string</returns>
        /// <example>
        /// string Result = WebLinkUtility.WebLinkUtilityLibrary.SplitSideString("321-34-7635", "LEFT", 9);
        /// </example>
        //[Counter("SplitSideString")]
        public virtual string SplitSideString(string MainString, string Side, int NumberOfString, int Index = 0)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                return appHandle.SplitSideString(MainString, Side, NumberOfString, Index);

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        /// <summary>
        /// This function is used to split string as per delimiter and stores in array.
        /// </summary>
        /// <param name="SplitString"></param>
        /// <param name="delimiter"></param>
        /// <returns>Split string</returns>
        /// <example>
        /// string[] Result = WebLinkUtility.WebLinkUtilityLibrary.SplitString("321-34-7635", "-");
        /// </example>
        //[Counter("SplitString")]
        public virtual string[] SplitString(string SplitString, string delimiter)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                return appHandle.SplitString(SplitString, delimiter);

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }



        /// <summary>
        /// This function is used to set the date value.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <param name="SetDateValue"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.SetDate(SetDateValue);
        /// </example>
        //[Counter("SetDate")]
        public virtual string SetDate(string InputValue)
        {

            if (InputValue.IndexOf("/") != -1)
            {
                string[] count = InputValue.Split('/');
                if (InputValue.Length == 7 && count.Length == 3)
                {
                    // InputValue = "0" + count[0] + "/" + count[1] + "/" + count[2];
                    InputValue = "0" + count[0] + count[1] + count[2];
                }
                else if (InputValue.Length == 8 && count.Length == 3)
                {
                    InputValue = count[0] + count[1] + count[2];
                }
            }
            return InputValue;
        }


        /// <summary>
        /// To verify multiple verification in pane.
        /// </summary>
        /// <param name="InputText"></param>
        /// <param name="expectedValue"></param>
        /// <param name="shouldContains"></param>
        /// <returns>True/False</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.VerifyLineInText("ClassName=LpVoListViewPane", Industries, "Existing Industries Pane");
        /// </example>
        //[Counter("VerifyLineInText")]
        public virtual bool VerifyLineInText(string InputText, string expectedValue, bool shouldContains = true, bool ScreenCapture = false)
        {
            bool Results = false;
            try
            {
                if (shouldContains)
                {
                    if (InputText.ToLower().Contains(expectedValue.ToLower()))
                        Results = true;
                    else
                        Results = false;
                }
                else
                {
                    if (InputText.ToLower() == expectedValue.ToLower())
                        Results = true;
                    else
                        Results = false;
                }
                if (Results == true)
                {
                    if (ScreenCapture)
                        Report.Pass("The expected data - '" + expectedValue + "' is displayed.", "VerifyLineInText", "True", appHandle);
                    else
                        Report.Pass("The expected data - '" + expectedValue + "' is displayed.", true);

                    return true;
                }
                else
                {
                    if (ScreenCapture)
                        Report.Fail("The expected data - '" + expectedValue + "' is not displayed.", "VerifyLineInText", "True", appHandle);
                    else
                        Report.Fail("The expected data - '" + expectedValue + "' is not displayed.", true);
                    return false;
                }

            }
            catch (System.Exception e)
            { logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message); }
            return false;
        }
        /// <summary>
        /// This function is used to calculate and returns next/previous Business Date based on given date. If the given date is Business date then it returns same date else it calculate and returns date based on BusinessDateOption (Next/Previous). 
        /// </summary>
        /// <param name="sdate"></param>
        /// <param name="BusinessDateOption"></param>
        /// <returns>Business Date</returns>
        /// <example>
        /// string BusinessDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GLOBAL_SYSTEM_DATE); 
        /// string BusinessDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate("10/14/20","Next");
        /// </example>       
        //[Counter("GetBusinessDate")]
        public virtual string GetBusinessDate(string sdate, string BusinessDateOption = "NEXT")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                if (sdate == "" || sdate == null)
                    return "0/00/00";
                string ExistingValue = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(sdate.ToString(), "M/dd/yyyy");
                string[] ExistingValues = ExistingValue.ToString().Split("/");
                DateTime date1 = new DateTime(int.Parse(ExistingValues[2]), int.Parse(ExistingValues[0]), int.Parse(ExistingValues[1]));
                bool ExistPublicHoliday = false;
                string HolidaysInCalendar = Data.Get("GlobalHolidayCalendar1");
                switch (BusinessDateOption.ToUpper())
                {
                    case "NEXT":
                        if (date1.DayOfWeek == DayOfWeek.Saturday || date1.DayOfWeek == DayOfWeek.Sunday || HolidaysInCalendar.IndexOf(ExistingValue) != -1)
                            ExistPublicHoliday = true;
                        while (ExistPublicHoliday)
                        {
                            date1 = date1.AddDays(1);
                            ExistingValue = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(date1.ToString(), "M/dd/yyyy");
                            ExistingValues = ExistingValue.ToString().Split("/");
                            date1 = new DateTime(int.Parse(ExistingValues[2]), int.Parse(ExistingValues[0]), int.Parse(ExistingValues[1]));
                            if (date1.DayOfWeek == DayOfWeek.Saturday || date1.DayOfWeek == DayOfWeek.Sunday || HolidaysInCalendar.IndexOf(ExistingValue) != -1)
                                ExistPublicHoliday = true;
                            else
                                ExistPublicHoliday = false;
                        }
                        break;
                    case "PREVIOUS":
                        if (date1.DayOfWeek == DayOfWeek.Saturday || date1.DayOfWeek == DayOfWeek.Sunday || HolidaysInCalendar.IndexOf(ExistingValue) != -1)
                            ExistPublicHoliday = true;
                        while (ExistPublicHoliday)
                        {
                            date1 = date1.AddDays(-1);
                            ExistingValue = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(date1.ToString(), "M/dd/yyyy");
                            if (date1.DayOfWeek == DayOfWeek.Saturday || date1.DayOfWeek == DayOfWeek.Sunday || HolidaysInCalendar.IndexOf(ExistingValue) != -1)
                                ExistPublicHoliday = true;
                            else
                                ExistPublicHoliday = false;
                        }
                        break;

                    case "MODIFIED FOLLOWING":

                        if (date1.DayOfWeek == DayOfWeek.Saturday || date1.DayOfWeek == DayOfWeek.Sunday || HolidaysInCalendar.IndexOf(ExistingValue) != -1)
                            ExistPublicHoliday = true;
                        while (ExistPublicHoliday)
                        {
                            date1 = date1.AddDays(1);
                            ExistingValue = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(date1.ToString(), "M/dd/yyyy");
                            if (date1.DayOfWeek == DayOfWeek.Saturday || date1.DayOfWeek == DayOfWeek.Sunday || HolidaysInCalendar.IndexOf(ExistingValue) != -1)
                                ExistPublicHoliday = true;
                            else
                                ExistPublicHoliday = false;
                        }

                        string[] SplittingDate = date1.ToString().Split('/');
                        string[] SplittingFormatedDate = ExistingValue.ToString().Split('/');
                        if (int.Parse(SplittingDate[0]) != int.Parse(SplittingFormatedDate[0]))
                        {
                            date1 = Convert.ToDateTime(ExistingValue);
                            if (date1.DayOfWeek == DayOfWeek.Saturday || date1.DayOfWeek == DayOfWeek.Sunday || HolidaysInCalendar.IndexOf(ExistingValue) != -1)
                                ExistPublicHoliday = true;
                            while (ExistPublicHoliday)
                            {
                                date1 = date1.AddDays(-1);
                                ExistingValue = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(date1.ToString(), "M/dd/yyyy");
                                if (date1.DayOfWeek == DayOfWeek.Saturday || date1.DayOfWeek == DayOfWeek.Sunday || HolidaysInCalendar.IndexOf(ExistingValue) != -1)
                                    ExistPublicHoliday = true;
                                else
                                    ExistPublicHoliday = false;
                            }
                        }

                        break;
                    default:
                        break;
                }
                string outdate = ConvertDateInGivenFormat(date1.ToString(), "M/dd/yy");
                return outdate;
            }
            catch (Exception e)
            {
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return null;
        }



        public virtual string GetBusinessDate_Old(string sdate, string BusinessDateOption = "NEXT")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string HolidayCalendar = GetCurrentCalendarID();
                if (sdate == "" || sdate == null)
                    return "0/00/00";
                string FormatedDate = ConvertDateInGivenFormat(sdate, "MM/dd/yy");
                string FormatedDate1 = ConvertDateInGivenFormat(sdate, "yyyyMMdd");
                DateTime date1 = Convert.ToDateTime(FormatedDate);
                string BusinessDateOption1 = BusinessDateOption.ToUpper();
                bool ExistPublicHoliday = false;
                if (PublicHoloidays == "")
                {
                    // PublicHoloidays = Application.ACBSDBLibrary.GetHolidaysInSpecifiedCalendar(HolidayCalendar);
                    PublicHoloidays = PublicHoloidays.Replace(',', '-');
                }


                string Newdate1 = "";
                switch (BusinessDateOption1)
                {
                    case "NEXT":
                        if (PublicHoloidays.Contains(FormatedDate1))
                            ExistPublicHoliday = true;
                        while (ExistPublicHoliday)
                        {
                            date1 = date1.AddDays(1);
                            Newdate1 = ConvertDateInGivenFormat(date1.ToString(), "yyyyMMdd");
                            if (PublicHoloidays.Contains(Newdate1))
                                ExistPublicHoliday = true;
                            else
                                ExistPublicHoliday = false;
                        }
                        break;
                    case "PREVIOUS":
                        if (PublicHoloidays.Contains(FormatedDate1))
                            ExistPublicHoliday = true;
                        while (ExistPublicHoliday)
                        {
                            date1 = date1.AddDays(-1);
                            Newdate1 = ConvertDateInGivenFormat(date1.ToString(), "yyyyMMdd");
                            if (PublicHoloidays.Contains(Newdate1))
                                ExistPublicHoliday = true;
                            else
                                ExistPublicHoliday = false;
                        }
                        break;

                    case "MODIFIED FOLLOWING":

                        if (PublicHoloidays.Contains(FormatedDate1))
                            ExistPublicHoliday = true;
                        while (ExistPublicHoliday)
                        {
                            date1 = date1.AddDays(1);
                            Newdate1 = ConvertDateInGivenFormat(date1.ToString(), "yyyyMMdd");
                            if (PublicHoloidays.Contains(Newdate1))
                                ExistPublicHoliday = true;
                            else
                                ExistPublicHoliday = false;
                        }

                        string[] SplittingDate = date1.ToString().Split('/');
                        string[] SplittingFormatedDate = FormatedDate.ToString().Split('/');
                        if (int.Parse(SplittingDate[0]) != int.Parse(SplittingFormatedDate[0]))
                        {
                            date1 = Convert.ToDateTime(FormatedDate);
                            if (PublicHoloidays.Contains(FormatedDate1))
                                ExistPublicHoliday = true;
                            while (ExistPublicHoliday)
                            {
                                date1 = date1.AddDays(-1);
                                Newdate1 = ConvertDateInGivenFormat(date1.ToString(), "yyyyMMdd");
                                if (PublicHoloidays.Contains(Newdate1))
                                    ExistPublicHoliday = true;
                                else
                                    ExistPublicHoliday = false;
                            }
                        }

                        break;
                    default:
                        break;
                }
                string outdate = ConvertDateInGivenFormat(date1.ToString(), "M/dd/yy");
                return outdate;
            }
            catch (Exception e)
            {
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return null;
        }

        /// <summary>
        /// This function is used to calculate and returns next/previous Non Business Date based on given date. If the given date is Non Business date then it returns same date else it calculate and returns date based on NonBusinessDateOption (Next/Previous). 
        /// </summary>
        /// <param name="sdate"></param>
        /// <param name="NonBusinessDateOption"></param>
        /// <returns>Non Business Date</returns>
        /// <example>
        /// string NonBusinessDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetNonBusinessDate(GLOBAL_SYSTEM_DATE)
        /// string NonBusinessDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetNonBusinessDate("10/14/20","Next");
        /// </example>  
        //[Counter("GetNonBusinessDate")]
        public virtual string GetNonBusinessDate(string sdate, string NonBusinessDateOption = "NEXT")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string HolidayCalendar = GetCurrentCalendarID();
                string FormatedDate = ConvertDateInGivenFormat(sdate, "MM/dd/yy");
                string FormatedDate1 = ConvertDateInGivenFormat(sdate, "yyyyMMdd");
                DateTime date1 = Convert.ToDateTime(FormatedDate);
                string NonBusinessDateOption1 = NonBusinessDateOption.ToUpper();
                bool ExistPublicHoliday = false;
                if (PublicHoloidays == "")
                {
                    // PublicHoloidays = Application.ACBSDBLibrary.GetHolidaysInSpecifiedCalendar(HolidayCalendar);
                    PublicHoloidays = PublicHoloidays.Replace(',', '-');
                }

                switch (NonBusinessDateOption1)
                {
                    case "NEXT":
                        if (PublicHoloidays.Contains(FormatedDate1))
                            ExistPublicHoliday = true;
                        while (ExistPublicHoliday == false)
                        {
                            date1 = date1.AddDays(1);
                            string Newdate1 = ConvertDateInGivenFormat(date1.ToString(), "yyyyMMdd");
                            if (PublicHoloidays.Contains(Newdate1))
                                ExistPublicHoliday = true;
                            else
                                ExistPublicHoliday = false;
                        }
                        break;
                    case "PREVIOUS":
                        if (PublicHoloidays.Contains(FormatedDate1))
                            ExistPublicHoliday = true;
                        while (ExistPublicHoliday == false)
                        {
                            date1 = date1.AddDays(-1);
                            string Newdate1 = ConvertDateInGivenFormat(date1.ToString(), "yyyyMMdd");
                            if (PublicHoloidays.Contains(Newdate1))
                                ExistPublicHoliday = true;
                            else
                                ExistPublicHoliday = false;
                        }
                        break;
                    default:
                        break;
                }
                string outdate = ConvertDateInGivenFormat(date1.ToString(), "M/dd/yy");
                return outdate;
            }
            catch (Exception e)
            {
                string ExceptionMessage = e.Message;
                HandleUtilityException(ExceptionMessage);
            }
            return null;
        }
        /// <summary>
        /// This function is used to get Semi Month Date (either 15 or last day of month) for a given date as per Business date Option. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <param name="BusinessDateOption"></param>
        /// <returns>Semi Month Date</returns>
        /// <example>
        /// string SemiMonthDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetSemiMonthDate(GLOBAL_SYSTEM_DATE); 
        /// string SemiMonthDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetSemiMonthDate("10/14/20","Next");
        /// </example>       
        //[Counter("GetSemiMonthDate")]
        public virtual string GetSemiMonthDate(string sdate, string BusinessDateOption = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                DateTime date1 = Convert.ToDateTime(sdate);
                int day = date1.Day;
                int month = date1.Month;
                int year = date1.Year;
                int daysinmonth = System.DateTime.DaysInMonth(year, month);
                string semimonthdate;
                if (day <= 15)
                {
                    semimonthdate = month.ToString() + "/15/" + year.ToString();
                }
                else
                {
                    semimonthdate = month.ToString() + "/" + daysinmonth.ToString() + "/" + year.ToString();
                }
                DateTime semidate1 = Convert.ToDateTime(semimonthdate);
                if (BusinessDateOption != null)
                {
                    string BusinessDateOption1 = BusinessDateOption.ToUpper();
                    switch (BusinessDateOption1)
                    {
                        case "NEXT":
                            while (semidate1.DayOfWeek == DayOfWeek.Saturday || semidate1.DayOfWeek == DayOfWeek.Sunday)
                                semidate1 = semidate1.AddDays(1);
                            break;
                        case "PREVIOUS":
                            while (semidate1.DayOfWeek == DayOfWeek.Saturday || semidate1.DayOfWeek == DayOfWeek.Sunday)
                                semidate1 = semidate1.AddDays(-1);
                            break;
                        default:
                            break;
                    }
                }
                string outdate = ConvertDateInGivenFormat(semidate1.ToString(), "M/dd/yy");
                return outdate;
            }
            catch (Exception e)
            {
                logger.Info(e.Message);
            }
            return null;
        }

        /// <summary>
        /// This function is used to get Snap shot on report file.
        /// </summary>
        /// <param name="Message"></param>
        /// <returns>Week Day</returns>
        /// <example>
        /// string GetWeekDayAsNumeric = WebLinkUtility.WebLinkUtilityLibrary.CaptureSnapShot("10");
        /// </example>       
        //[Counter("CaptureSnapShot")]
        public virtual void CaptureSnapShot(string Message)
        {
            Report.Info(Message, "Info", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB));
        }
        /// <summary>
        /// This function is used to get Weekday As Numeric for a given date.
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Week Day</returns>
        /// <example>
        /// string GetWeekDayAsNumeric = WebLinkUtility.WebLinkUtilityLibrary.GetWeekDayAsNumeric("10");
        /// </example>       
        //[Counter("GetWeekDayAsNumeric")]
        public virtual int GetWeekDayAsNumeric(string Date)
        {
            int NumericDate = 0;
            try
            {
                DateTime semidate1 = Convert.ToDateTime(Date);
                if (semidate1.DayOfWeek == DayOfWeek.Monday)
                    NumericDate = 1;
                else if (semidate1.DayOfWeek == DayOfWeek.Tuesday)
                    NumericDate = 2;
                else if (semidate1.DayOfWeek == DayOfWeek.Wednesday)
                    NumericDate = 3;
                else if (semidate1.DayOfWeek == DayOfWeek.Thursday)
                    NumericDate = 4;
                else if (semidate1.DayOfWeek == DayOfWeek.Friday)
                    NumericDate = 5;
                else if (semidate1.DayOfWeek == DayOfWeek.Saturday)
                    NumericDate = 6;
                else if (semidate1.DayOfWeek == DayOfWeek.Sunday)
                    NumericDate = 7;
                else
                    NumericDate = 0;

                return NumericDate;
            }
            catch (Exception e)
            {
                logger.Info(e.Message);
            }
            return NumericDate;
        }
        /// <summary>
        /// This function is used to get Weekday name as for a given date.
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Week Day Name</returns>
        /// <example>
        /// string GetWeekDayName = WebLinkUtility.WebLinkUtilityLibrary.GetWeekDayName("Monday");
        /// </example>       
        //[Counter("GetWeekDayName")]
        public virtual string GetWeekDayName(string Date)
        {
            string NumericDate = null;
            try
            {
                DateTime semidate1 = Convert.ToDateTime(Date);
                if (semidate1.DayOfWeek == DayOfWeek.Monday)
                    NumericDate = "MONDAY";
                else if (semidate1.DayOfWeek == DayOfWeek.Tuesday)
                    NumericDate = "TUESDAY";
                else if (semidate1.DayOfWeek == DayOfWeek.Wednesday)
                    NumericDate = "WEDNESDAY";
                else if (semidate1.DayOfWeek == DayOfWeek.Thursday)
                    NumericDate = "THURSDAY";
                else if (semidate1.DayOfWeek == DayOfWeek.Friday)
                    NumericDate = "FRIDAY";
                else if (semidate1.DayOfWeek == DayOfWeek.Saturday)
                    NumericDate = "SATURDAY";
                else if (semidate1.DayOfWeek == DayOfWeek.Sunday)
                    NumericDate = "SUNDAY";
                else
                    NumericDate = null;

                return NumericDate;
            }
            catch (Exception e)
            {
                logger.Info(e.Message);
            }
            return NumericDate;
        }

        /// <summary>
        /// This method is used to calculate the new date with lag days.
        /// </summary>
        /// <param name="EffectiveDate"></param>
        /// <param name="LagDays"></param>
        /// <returns>true/false</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDateWithLagDays(); 
        /// </example> 
        //[Counter("CalculateNewDateWithLagDays")]
        public virtual string CalculateNewDateWithLagDays(string EffectiveDate, int LagDays)
        {
            try
            {
                string NewDate = EffectiveDate;
                if (LagDays != 0)
                {

                    do
                    {
                        NewDate = CalculateNewDate(NewDate, "d", -1);
                        NewDate = ConvertDateInGivenFormat(NewDate.ToString(), "M/dd/yy");
                        NewDate = GetBusinessDate(NewDate, "PREVIOUS");
                        LagDays--;
                    } while (LagDays > 0);
                }
                else
                {
                    NewDate = ConvertDateInGivenFormat(NewDate.ToString(), "M/dd/yy");
                    NewDate = GetBusinessDate(NewDate);
                }
                return NewDate;//ConvertDateInGivenFormat(NewDate.ToString(), "M/d/yy");
            }
            catch (System.Exception e) { logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message); }
            return null;
        }
        /// <summary>
        /// This method is used to Calculate Next Business Date.
        /// </summary>
        /// <param name="CurrentDate"></param>
        /// <param name="NextDays"></param>
        /// <returns>true/false</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(); 
        /// </example> 
        //[Counter("CalculateNextBusinessDate")]
        public virtual string CalculateNextBusinessDate(string CurrentDate, int NextDays)
        {
            try
            {
                string NewDate = CurrentDate;
                int i = 0;
                do
                {
                    NewDate = CalculateNewDate(NewDate, "d", 1);
                    NewDate = ConvertDateInGivenFormat(NewDate.ToString(), "M/dd/yy");
                    NewDate = GetBusinessDate(NewDate, "Next");
                    i++;
                } while (NextDays > i);


                return NewDate;//ConvertDateInGivenFormat(NewDate.ToString(), "M/d/yy");
            }
            catch (System.Exception e) { logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message); }
            return null;
        }

        /// <summary>
        /// This function is used to calculate and returns Month End date for given date. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Month End Date</returns>
        /// <example>
        /// string GetMonthEndDate = WebLinkUtility.WebLinkUtilityLibrary.GetMonthEndDate(GLOBAL_SYSTEM_DATE)
        /// string GetMonthEndDate = WebLinkUtility.WebLinkUtilityLibrary.GetMonthEndDate("10/28/20");
        /// </example>  
        //[Counter("GetMonthEndDate")]
        public virtual string GetMonthEndDate(string sdate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string MonthEOD = appHandle.GetMonthLastDate(sdate);
                string outdate = ConvertDateInGivenFormat(MonthEOD.ToString(), "M/dd/yy");
                return outdate;
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }
        /// <summary>
        /// This function is used to calculate and returns Month First date for given date. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Month First Date</returns>
        /// <example>
        /// string GetMonthFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetMonthFirstDate(GLOBAL_SYSTEM_DATE)
        /// string GetMonthFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetMonthFirstDate("10/01/20");
        /// </example>  
        //[Counter("GetMonthFirstDate")]
        public virtual string GetMonthFirstDate(string sdate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string[] strlist = sdate.Split('/');
                string outdate = ConvertDateInGivenFormat((strlist[0] + "/01/" + strlist[2]).ToString(), "M/dd/yy");
                return outdate;
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        /// <summary>
        /// This function is used to calculate and returns Months in Quarter. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Quater First Date</returns>
        /// <example>
        /// string GetQuarterFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterFirstDate(GLOBAL_SYSTEM_DATE)
        /// string GetQuarterFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterFirstDate("10/30/20");
        /// </example>  
        //[Counter("GetQuarterFirstDate")]
        public virtual string GetQuarterFirstDate(string sdate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string[] strlist = sdate.Split('/');
                int MonthNum = int.Parse(strlist[0]);
                if (MonthNum >= 1 && MonthNum <= 3)
                    return ("1/01/" + strlist[2]).ToString();
                else if (MonthNum >= 4 && MonthNum <= 6)
                    return ("4/01/" + strlist[2]).ToString();
                else if (MonthNum >= 7 && MonthNum <= 9)
                    return ("7/01/" + strlist[2]).ToString();
                else if (MonthNum >= 10 && MonthNum <= 12)
                    return ("10/01/" + strlist[2]).ToString();
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }
        /// <summary>
        /// This function is used to calculate and returns Week First date for given date. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Week First Date</returns>
        /// <example>
        /// string GetWeekFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetWeekFirstDate(GLOBAL_SYSTEM_DATE)
        /// string GetWeekFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetWeekFirstDate("10/01/20");
        /// </example>  
        //[Counter("GetWeekFirstDate")]
        public virtual string GetWeekFirstDate(string sdate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                int WeekNum = 0;
                do
                {
                    WeekNum = GetWeekDayAsNumeric(sdate);
                    if (WeekNum == 1)
                        return sdate;
                    else
                        sdate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(sdate, "d", -1);
                    sdate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(sdate, "M/dd/yy");

                } while (WeekNum != 0);

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }
        /// <summary>
        /// This function is used to get he Leap year for given year. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Leap Year</returns>
        /// <example>
        /// string IsLeapYear = WebLinkUtility.WebLinkUtilityLibrary.IsLeapYear(Year)
        /// </example>  
        //[Counter("IsLeapYear")]
        public virtual string IsLeapYear(string sDate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string[] YearStartDateArray = sDate.Split('/');
                if (appHandle.IsLeapYear(int.Parse("20" + YearStartDateArray[2].ToString())))
                    return "Y";
                else
                    return "N";

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }
        /// <summary>
        /// This function is used to Get Mtd Days. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Mtd Days</returns>
        /// <example>
        /// string GetMtdDays = WebLinkUtility.WebLinkUtilityLibrary.GetMtdDays(GLOBAL_SYSTEM_DATE)
        /// </example>  
        //[Counter("GetMtdDays")]
        public virtual int GetMtdDays(string sDate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string[] YearStartDateArray = sDate.Split('/');
                int TotalDats = int.Parse(YearStartDateArray[1]);
                return (TotalDats - 1);

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }
        /// <summary>
        /// This function is used to Get QTD Days. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>QTD Days</returns>
        /// <example>
        /// string GetQTDDays = WebLinkUtility.WebLinkUtilityLibrary.GetQTDDays(GLOBAL_SYSTEM_DATE)
        /// </example>  
        //[Counter("GetQTDDays")]
        public virtual int GetQTDDays(string sDate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string QTDFirstDate = GetQuarterFirstDate(sDate);
                int TotalNoOfDaysBetweenTwoDates = WebLinkUtility.WebLinkUtilityLibrary.CalculateDateDifference(QTDFirstDate, sDate, "ACTUAL");

                return TotalNoOfDaysBetweenTwoDates;

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }
        /// <summary>
        /// This function is used to Get YTD Days. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>YTD Days</returns>
        /// <example>
        /// string GetYTDDays = WebLinkUtility.WebLinkUtilityLibrary.GetYTDDays(GLOBAL_SYSTEM_DATE)
        /// </example>  
        //[Counter("GetYTDDays")]
        public virtual int GetYTDDays(string sDate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string YearFirstDate = GetYearFirstDate(sDate);
                int TotalNoOfDaysBetweenTwoDates = WebLinkUtility.WebLinkUtilityLibrary.CalculateDateDifference(YearFirstDate, sDate, "ACTUAL");
                return TotalNoOfDaysBetweenTwoDates;

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }

        /// <summary>
        /// This function is used to Get WeekEnd Date. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Week End Date</returns>
        /// <example>
        /// string GetWeekEndDate = WebLinkUtility.WebLinkUtilityLibrary.GetWeekEndDate("10/09/20")
        /// </example>  
        //[Counter("GetWeekEndDate")]
        public virtual string GetWeekEndDate(string sdate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                int WeekNum = 0;
                do
                {
                    WeekNum = GetWeekDayAsNumeric(sdate);
                    if (WeekNum == 5)
                        return sdate;
                    else
                        sdate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(sdate, "d", 1);
                    sdate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(sdate, "M/dd/yy");

                } while (WeekNum != 0);

            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }
        /// <summary>
        /// This function is used to Get Quater WeekEnd Date in year. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Quater End Date</returns>
        /// <example>
        /// string GetQuaterEndDate = WebLinkUtility.WebLinkUtilityLibrary.GetQuaterEndDate("3/31/20")
        /// </example>  
        //[Counter("GetQuaterEndDate")]
        public virtual string GetQuarterEndDate(string sdate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string[] strlist = sdate.Split('/');
                int MonthNum = int.Parse(strlist[0]);
                if (MonthNum >= 1 && MonthNum <= 3)
                    return ("3/31/" + strlist[2]).ToString();
                else if (MonthNum >= 4 && MonthNum <= 6)
                    return ("6/30/" + strlist[2]).ToString();
                else if (MonthNum >= 7 && MonthNum <= 9)
                    return ("9/30/" + strlist[2]).ToString();
                else if (MonthNum >= 10 && MonthNum <= 12)
                    return ("12/31/" + strlist[2]).ToString();
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }
        /// <summary>
        /// This function is used to calculate and returns Quarter number for given date. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Quarter number</returns>
        /// <example>
        /// string Quarternumber = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterForSpecifiedDate(GLOBAL_SYSTEM_DATE)
        /// string Quarternumber = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterForSpecifiedDate("10/14/20");
        /// </example>  
        //[Counter("GetQuarterForSpecifiedDate")]

        public virtual int GetQuarterForSpecifiedDate(string sdate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string[] strlist = sdate.Split('/');
                int MonthNum = int.Parse(strlist[0]);
                if (MonthNum >= 1 && MonthNum <= 3)
                    return 1;
                else if (MonthNum >= 4 && MonthNum <= 6)
                    return 2;
                else if (MonthNum >= 7 && MonthNum <= 9)
                    return 3;
                else if (MonthNum >= 10 && MonthNum <= 12)
                    return 4;
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }

        /// <summary>
        /// This function is used to get the 1st date in Year. 
        /// </summary>
        /// <param name="sdate"></param>
        /// <returns>Month First Date</returns>
        /// <example>
        /// string GetMonthFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetYearFirstDate(GLOBAL_SYSTEM_DATE)
        /// string GetMonthFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetYearFirstDate("10/14/20");
        /// </example>  
        public virtual string GetYearFirstDate(string sdate)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string[] strlist = sdate.Split('/');
                int YearNum = int.Parse(strlist[0]);
                return ("1/01/" + strlist[2]).ToString();
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        /// <summary>
        /// This function is used to compare the string. 
        /// </summary>
        /// <param name="ParentValue"></param>
        /// <param name="ChildValue"></param>
        /// <returns>string</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.CompareString()
        /// </example>  
        //[Counter("CompareString")]

        public virtual bool CompareString(string ParentValue, string ChildValue)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                if (ParentValue == ChildValue)
                {
                    Report.Pass("The expected data - " + ChildValue + " is equal to " + ParentValue + ".", "True", appHandle);
                    return true;
                }
                else
                {
                    Report.Fail("The expected data - " + ChildValue + " is not equal to " + ParentValue + ".", "True", appHandle);
                    return false;
                }
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return false;

        }
        /// <summary>
        /// This function is used to compare the Values. 
        /// </summary>
        /// <param name="ParentValue"></param>
        /// <param name="ChildValue"></param>
        /// <param name="ComparisonType"></param>
        /// <returns>Compare Values</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.CompareValues()
        /// </example>  
        //[Counter("CompareValues")]

        public virtual bool CompareValues(double ParentValue, double ChildValue, string ComparisonType)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string Valuetype = ComparisonType.ToUpper();
                switch (Valuetype)
                {
                    case "MORE":
                        if (ParentValue > ChildValue)
                        {
                            Report.Pass("The expected data: " + ParentValue + " is more than " + ChildValue + ".", "True", appHandle);
                            return true;
                        }
                        else
                        {
                            Report.Fail("The expected data: " + ParentValue + " is not more than " + ChildValue + ".", "True", appHandle);
                            return false;
                        }

                    case "LESS":
                        if (ParentValue < ChildValue)
                        {
                            Report.Pass("The expected data: " + ParentValue + " is less than " + ChildValue + ".", "True", appHandle);
                            return true;
                        }
                        else
                        {
                            Report.Fail("The expected data: " + ParentValue + " is not less than " + ChildValue + ".", "True", appHandle);
                            return false;
                        }
                    case "EQUAL":
                        if (ParentValue == ChildValue)
                        {
                            Report.Pass("The expected data: " + ChildValue + " is equal to " + ParentValue + ".", "True", appHandle);
                            return true;
                        }
                        else
                        {
                            Report.Fail("The expected data: " + ChildValue + " is not equal to " + ParentValue + ".", "True", appHandle);
                            return false;
                        }

                    default:
                        break;
                }
            }
            catch (System.Exception e)
            { logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message); }
            return false;
        }
        /// <summary>
        /// This function is used to compare the string Values. 
        /// </summary>
        /// <param name="ActualString"></param>
        /// <param name="ExpectedString"></param>
        /// <returns>Compare strings</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.CompareValues()
        /// </example>  
        //[Counter("CompareValues")]
        public virtual bool CompareValues(string ActualString, string ExpectedString)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                if ((ActualString != null && ExpectedString != null) && (ExpectedString.Contains(ActualString) || ActualString.Contains(ExpectedString)))
                {
                    Report.Pass("The expected data: " + ExpectedString + " is present.", "VerifyColumnValueByReference", "True", appHandle);
                    return true;
                }
                else
                {
                    Report.Fail("The expected data: " + ExpectedString + " is Not present.", "VerifyColumnValueByReference", "True", appHandle);
                    return false;
                }
            }
            catch (System.Exception e)
            { logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message); }
            return false;
        }

        /// <summary>
        /// This function is used to Add/Subtract Business days and returns a new date accordingly. 
        /// </summary>
        /// <param name="EffectiveDate"></param>
        /// <param name="NoOfDaysToAddOrSubtract"></param>
        /// <param name="Operation"></param>
        /// <returns>New Date</returns>
        /// <example>
        /// string GetNewDate = WebLinkUtility.WebLinkUtilityLibrary.AddOrSubtractBusinessDays("5/30/19", 5, "ADD");
        /// string GetNewDate = WebLinkUtility.WebLinkUtilityLibrary.AddOrSubtractBusinessDays("6/06/19", 5, "SUBTRACT");
        /// </example>
        //[Counter("AddOrSubtractBusinessDays")]
        public virtual string AddOrSubtractBusinessDays(string EffectiveDate, int NoOfDaysToAddOrSubtract, string Operation)
        {
            try
            {
                string NewDate = EffectiveDate;
                do
                {
                    switch (Operation.ToUpper())
                    {
                        case "ADD":
                            NewDate = CalculateNewDate(NewDate, "d", 1);
                            NewDate = ConvertDateInGivenFormat(NewDate.ToString(), "M/dd/yy");
                            NewDate = GetBusinessDate(NewDate);
                            break;
                        case "SUBTRACT":
                            NewDate = CalculateNewDate(NewDate, "d", -1);
                            NewDate = ConvertDateInGivenFormat(NewDate.ToString(), "M/dd/yy");
                            NewDate = GetBusinessDate(NewDate, "PREVIOUS");
                            break;
                        default:
                            break;
                    }
                    NoOfDaysToAddOrSubtract--;
                } while (NoOfDaysToAddOrSubtract > 0);
                return NewDate;
            }
            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        public virtual string GetCurrencyDescription(string Currency, string DescriptionType)
        {
            try
            {
                string CurrencyDescription = "";
                string CurrencyName = Currency.ToUpper();
                {
                    switch (CurrencyName)
                    {
                        case "CANADIAN DOLLARS":
                        case "CAD":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "CANADIAN DOLLARS";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "CAD";
                            break;
                        case "POUNDS STERLING":
                        case "POUND STERLING":
                        case "GBP":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "POUNDS STERLING";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "GBP";
                            break;
                        case "EURO":
                        case "EUR":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "EURO";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "EUR";
                            break;
                        case "SINGAPORE DOLLAR":
                        case "SGD":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "SINGAPORE DOLLAR";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "SGD";
                            break;
                        case "INDIAN RUPEE":
                        case "INR":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "INDIAN RUPEE";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "INR";
                            break;
                        case "AUSTRALIAN DOLLARS":
                        case "AUD":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "AUSTRALIAN DOLLARS";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "AUD";
                            break;
                        case "HONG KONG DOLLARS":
                        case "HKD":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "HONG KONG DOLLARS";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "HKD";
                            break;
                        case "IRISH POUND":
                        case "IEP":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "IRISH POUND";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "IEP";
                            break;
                        case "NEW ZEALAND DOLLAR":
                        case "NZD":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "NEW ZEALAND DOLLAR";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "NZD";
                            break;
                        case "RUSSIAN RUBLES":
                        case "RUB":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "RUSSIAN RUBLES";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "RUB";
                            break;
                        case "US DOLLARS":
                        case "UNITED STATES DOLLAR":
                        case "USD":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "US DOLLARS";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "USD";
                            break;
                        case "MEXICAN NUEVO PESO":
                        case "MXN":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "MEXICAN NUEVO PESO";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "MXN";
                            break;
                        case "NETHERLANDS GUILDER":
                        case "NLG":
                            if (DescriptionType.ToUpper() == "LONG")
                                CurrencyDescription = "NETHERLANDS GUILDER";
                            if (DescriptionType.ToUpper() == "SHORT")
                                CurrencyDescription = "NLG";
                            break;
                        default:
                            CurrencyDescription = "Input Currency is Not Found";
                            break;
                    }
                    return CurrencyDescription;
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }


        /// <summary>
        /// This function is used to return currency format value.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// bool Result = WebLinkUtility.WebLinkUtilityLibrary.VerifyDropdownValueNotExist(FromValueField, "Sudheer", "From Value Dropdown");
        /// </example>
        //[Counter("ConvertCurrencyFormat")]
        public virtual string ConvertCurrencyFormat(string value)
        {
            string value1 = value;
            try
            {
                if (value != null && value != "")
                {
                    appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                    return RoundOffValue(double.Parse(value), 2).ToString("C").Replace("$", "").Replace("₹", "");
                }
            }
            catch (Exception e) { return value1; }
            return "";
        }
        public virtual string ConvertCurrencyFormatforAnArray(string stringArray)
        {
            try
            {
                if (stringArray != null)
                {
                    string[] DictionaryArray = stringArray.ToString().Split(":");
                    for (int i = 1; i < DictionaryArray.Length; i++)
                    {
                        DictionaryArray[i] = RoundOffValue(double.Parse(DictionaryArray[i]), 2).ToString("C").Replace("$", "").Replace("₹", "");
                    }
                    return string.Join(":", DictionaryArray);
                }
            }
            catch (Exception e) { }
            return "";
        }
        public virtual string ConvertNumberFormat(string value)
        {
            if (value != null && value != "")
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                return value.Replace(",", "");
            }
            return "";
        }
        /// <summary>
        /// This function is used to Get Base Rate using specific dates.
        /// </summary>
        /// <param name="StartDate"></param>  
        /// <param name="EndDate"></param> 
        ///  <param name="RateType"></param>   
        /// <returns>Base Rate</returns>
        /// <example>   
        /// WebLinkUtility.WebLinkUtilityLibrary.GetBaseRateUsingSpecificDates(LoanEffectiveDate, ProcessingDate, "High");
        /// </example>
        //[Counter("GetBaseRateUsingSpecificDates")]
        public virtual string GetBaseRateUsingSpecificDates(string StartDate, string EndDate, string RateType)
        {
            appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
            string Date = StartDate;
            string rate = null;
            List<string> Rates = new List<String>();
            string LowestRate = null;
            string HighestRate = null;

            try
            {
                if (StartDate != null && EndDate != null)
                {
                    while (appHandle.IsDateLesserOrEqual(Date, EndDate))
                    {
                        Date = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDateWithLagDays(Date, 0);
                        try
                        {
                            appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                            DBApplication dbApplication = ApplicationHandlerFactory.GetApplication(ApplicationType.DATABASE);
                            string DBSchemaName = StartupConfiguration.UserSettings.DBSchemaName.ToString();
                            string IndexName = WebLinkUtility.WebLinkUtilityLibrary.GetCurrentRateIndexID();
                            string ExpectedDate = appHandle.ConvertDateInGivenFormat(Date, "yyyyMMdd");
                            bool WindowsLogin = StartupConfiguration.UserSettings.WindowsLogin;
                            string SqlQuery = "";
                            if (WindowsLogin != true)
                                SqlQuery = "select J$RIQR from " + DBSchemaName + ".J$CLRH where J$RIOI = '" + IndexName + "' AND J$RIP8='" + ExpectedDate + "' AND  J$RPRC='A'";
                            else
                                SqlQuery = "select J_RIQR from " + DBSchemaName + ".J_CLRH where J_RIOI = '" + IndexName + "' AND J_RIP8='" + ExpectedDate + "' AND  J_RPRC='A'";
                            string[,] TotalNoOfRecords1 = dbApplication.GetDataFromTable(SqlQuery);
                            rate = TotalNoOfRecords1[((TotalNoOfRecords1.Length) - 1), 0]; //Data.Get(IndexDatewithLag);
                            Rates.Add(rate);
                        }
                        catch (Exception e) { string ExceptionMessage = e.Message; }
                        Date = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Date, "d", 1);
                        Date = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDateWithLagDays(Date, 0);

                    }
                    if (RateType.ToUpper() == "LOW")
                    {
                        LowestRate = Rates.Min();

                        return LowestRate;
                    }
                    if (RateType.ToUpper() == "HIGH")
                    {
                        HighestRate = Rates.Max();

                        return HighestRate;
                    }

                }

            }

            catch (Exception e)
            {
                logger.Info(e.Message); Report.Info("Exception Logged:" + e.Message);
            }
            return null;

        }
        /// <summary>
        /// This function is used to validate the values.
        /// </summary>
        /// <param name="ActualValue"></param>  
        /// <param name="ExpectedData"></param> 
        /// <returns>Validate Value</returns>
        /// <example>   
        /// WebLinkUtility.WebLinkUtilityLibrary.ConfirmValueWithAdjustment(ApplicationValue, ExpectedData);
        /// </example>
        //[Counter("ConfirmValueWithAdjustment")]
        public virtual string VerifyObjectValueWithAdjustment(string Object, string ExpectedData, bool ScreenCapture = true)
        {
            string[] ExpectedDataArray = ExpectedData.ToString().Split(' ');
            ExpectedData = ExpectedDataArray[0];
            if (ExpectedData.Contains('.') == false)
            {
                ExpectedData = ConvertCurrencyFormat(ExpectedData);
            }
            string Validation = "Fail";
            double DoubleValidateValue = 0;
            string ExpectedData1 = "";
            string ActualExpectedData = ExpectedData;
            try
            {
                WaitMajorTimeForObject(Object);
                string ActualValue = appHandle.GetElementValue(Object);
                string[] ActualFieldValueArray = ActualValue.Split(':');
                string ActualValue1 = ActualFieldValueArray[1].Trim();
                string[] ActualValueArray = ActualValue1.Split(' ');
                ActualValue = ActualValueArray[0];
                if (ActualValue.Contains('$'))
                {
                    ActualValue = ActualValue.Replace("$", "").Replace("-", "");
                }
                if (ActualValue.Contains('.') == false)
                {
                    ActualValue = ConvertCurrencyFormat(ActualValue);
                }
                string[] SplitedValue = ExpectedData.ToString().Split('.');
                if (ActualValue != ExpectedData)
                {
                    if (SplitedValue[1].Length > 1)
                    {
                        DoubleValidateValue = Convert.ToDouble(SplitedValue[0] + "." + (Int32.Parse(SplitedValue[1]) - 1));
                        ExpectedData = ConvertDoubleTostring(DoubleValidateValue, SplitedValue[1].Length);
                        DoubleValidateValue = Convert.ToDouble(SplitedValue[0] + ".0" + (Int32.Parse(SplitedValue[1]) - 1));
                        ExpectedData1 = ConvertDoubleTostring(DoubleValidateValue, SplitedValue[1].Length);
                        if (ActualValue != ExpectedData && ActualValue != ExpectedData1)
                        {
                            DoubleValidateValue = Convert.ToDouble(SplitedValue[0] + "." + (Int32.Parse(SplitedValue[1]) + 1));
                            ExpectedData = ConvertDoubleTostring(DoubleValidateValue, SplitedValue[1].Length);
                            DoubleValidateValue = Convert.ToDouble(SplitedValue[0] + ".0" + (Int32.Parse(SplitedValue[1]) + 1));
                            ExpectedData1 = ConvertDoubleTostring(DoubleValidateValue, SplitedValue[1].Length);
                            if (ActualValue != ExpectedData && ActualValue != ExpectedData1)
                            {
                                Validation = "Fail";
                            }
                            else
                            {
                                Validation = ActualValue;
                            }
                        }
                        else
                        {
                            Validation = ActualValue;
                        }
                    }
                }
                else
                {
                    Validation = ActualValue;
                }
                if (Validation != "Fail")
                {
                    if (ActualExpectedData != ActualValue)
                    {
                        if (ScreenCapture)
                            Report.Pass("The Object expected data: '" + ActualExpectedData + "' is displayed with Plus or Minus 0.1 Decimal adjustment Actual text: '" + ActualValue + "'.", "VerifyObjectValueWithAdjustment", "True", appHandle);
                        else
                            Report.Pass("The Object expected data: '" + ActualExpectedData + "' is displayed with Plus or Minus 0.1 Decimal adjustment Actual text: '" + ActualValue + "'.", true);
                    }
                    else
                    {
                        if (ScreenCapture)
                            Report.Pass("The Object expected data: '" + ActualExpectedData + "' is displayed Actual text: '" + ActualValue + "'.", "VerifyObjectValueWithAdjustment", "True", appHandle);
                        else
                            Report.Pass("The Object expected data: '" + ActualExpectedData + "' is displayed Actual text: '" + ActualValue + "'.", true);

                    }
                }
                else
                {
                    if (ScreenCapture)
                        Report.Fail("The Object expected data: '" + ActualExpectedData + "' is not displayed Actual text: '" + ActualValue + "'.", "VerifyObjectValueWithAdjustment", "True", appHandle);
                    else
                        Report.Fail("The Object expected data: '" + ActualExpectedData + "' is not displayed Actual text: '" + ActualValue + "'.", true);
                }
            }
            catch (Exception e) { string ExceptionMessage = e.Message; }

            return Validation;
        }
        /// <summary>
        /// This function is used to handle exception in Utility method.
        /// </summary>
        /// <param name="Exception"></param>       
        /// <returns>None</returns>
        /// <example>   
        /// WebLinkUtility.WebLinkUtilityLibrary.HandleUtilityException(ExceptionMessage);
        /// </example>
        //[Counter("HandleUtilityException")]
        public virtual void HandleUtilityException(string Exception)
        {
            appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
            Environment.SetEnvironmentVariable("GLOBAL_UTILITY_METHOD_FLAG", "true");
            Report.Fail("An exception/error occurred in Utility method and reported exception is: " + Exception, "UtilityException", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB), true);
        }

        /// <summary>
        /// This function is used to Select the Button.
        /// </summary>
        /// <param name="Objectname"></param>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.VerifyRadioButtonStatus(Objectname,);
        /// </example>
        //[Counter("VerifyRadioButtonStatus")]
        public virtual bool VerifyRadioButtonStatus(string Objectname, string Status, bool ScreenCapture = true)
        {
            bool Validation = false;
            bool RadioButtonStatus = false;
            try
            {
                if (Status.ToUpper() == "YES")
                    Status = "ON";
                else if (Status.ToUpper() == "NO")
                    Status = "OFF";
                WebLinkUtility.WebLinkUtilityLibrary.WaitMajorTimeForObject(Objectname);
                RadioButtonStatus = appHandle.CheckRadiobuttonSelected(Objectname);
                if (Status.ToUpper() == "ON" && RadioButtonStatus == true)
                    Validation = true;
                if (Status.ToUpper() == "OFF" && RadioButtonStatus == false)
                    Validation = true;

                try
                {
                    if (Environment.GetEnvironmentVariable("ObjectName").ToString() != null && Environment.GetEnvironmentVariable("ObjectName").ToString() != "")
                        Status = Environment.GetEnvironmentVariable("ObjectName").ToString().ToUpper() + ": " + Status;
                }
                catch (System.Exception e) { string messages = e.Message; }
            }
            catch (System.Exception e)
            {
                Report.Warning("Radio Button object is Disabled or not found and Xpath is: " + Objectname);
                string ExceptionMessage = e.Message;
                return false;
            }

            if (Validation == true)
            {
                if (ScreenCapture)
                    Report.Pass("The Radio Button status: '" + Status + "' is displayed Actual text: '" + RadioButtonStatus + "'.", "VerifyRadioButtonStatus", "True", appHandle);
                else
                    Report.Pass("The Radio Button status: '" + Status + "' is displayed Actual text: '" + RadioButtonStatus + "'.", true);
                return true;
            }
            else
            {
                if (ScreenCapture)
                    Report.Fail("The Radio Button status: '" + Status + "' is not displayed Actual text: '" + RadioButtonStatus + "'.", "VerifyRadioButtonStatus", "True", appHandle);
                else
                    Report.Fail("The Radio Button status: '" + Status + "' is not displayed Actual text: '" + RadioButtonStatus + "'.", true);
                return false;
            }

        }

        /// <summary>
        /// This function is used to handle exception in Window method.
        /// </summary>
        /// <param name="Exception"></param>      
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.HandlePageException(ExceptionMessage);
        /// </example>
        //[Counter("HandlePageException")]
        public virtual void HandlePageException(string Exception)
        {
            appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
            string UtilityFlagStatus = Environment.GetEnvironmentVariable("GLOBAL_UTILITY_METHOD_FLAG");
            string BusinessFlagStatus = Environment.GetEnvironmentVariable("GLOBAL_BUSINESS_METHOD_FLAG");
            if (UtilityFlagStatus != "true" && BusinessFlagStatus != "true")
            {
                Environment.SetEnvironmentVariable("GLOBAL_WINDOW_METHOD_FLAG", "true");
                Report.Fail("An exception/error occurred in Window method and reported exception is: " + Exception, "WindowException", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB), true);
            }
            else
            {
                Report.Fail("An exception/error occurred reported exception is: " + Exception, "WindowException", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB), true);
            }
        }
           /// <summary>
/// Updates or adds a specified field with a new value in the provided facility basic information array,
/// and returns the result as a string array suitable for use in automation scripts.
/// </summary>
/// <param name="DataArray">Array of facility basic information in "Key:Value" format.</param>
/// <param name="fieldName">The field name to update or add (e.g., "Facility Amount").</param>
/// <param name="newValue">The new value to set for the specified field.</param>
/// <returns>String array of facility basic information in "Key:Value" format.</returns>
public virtual string[] GetModifiedInputDataArray(string[] DataArray, string fieldName, string newValue)
{
   // Convert the input array to a dictionary, handling duplicate keys
var DataArrayToDict = DataArray
    // 1. Project each string into a Key/Value object
    .Select(item => {
        var parts = item.Split(new[] { ':' }, 2);
        return new {
            Key = parts[0].Trim(),
            Value = parts.Length > 1 ? parts[1].Trim() : ""
        };
    })
    // 2. Group the items by their key
    .GroupBy(x => x.Key)
    // 3. Create the dictionary from the groups, resolving duplicates
    //    by taking the LAST value for each key.
    .ToDictionary(
        group => group.Key,
        group => group.Last().Value
    );

    // Update the value if the field exists, or add a new key-value pair if it doesn't
    DataArrayToDict[fieldName] = newValue;

    // Convert the updated dictionary back to a string array in "Key:Value" format
    return DataArrayToDict
              .Select(kvp => $"{kvp.Key}:{kvp.Value}")
        .ToArray();
}

        /// <summary>
        /// This function is used to handle exception in Business Function.
        /// </summary>
        /// <param name="Exception"></param>        
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.HandleBusinessException(ExceptionMessage);
        /// </example>
        //[Counter("HandleBusinessException")]
        public virtual void HandleBusinessException(string Exception)
        {
            appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
            string UtilityFlagStatus = Environment.GetEnvironmentVariable("GLOBAL_UTILITY_METHOD_FLAG");
            string WindowFlagStatus = Environment.GetEnvironmentVariable("GLOBAL_WINDOW_METHOD_FLAG");
            if (UtilityFlagStatus != "true" && WindowFlagStatus != "true")
            {
                Environment.SetEnvironmentVariable("GLOBAL_BUSINESS_METHOD_FLAG", "true");
                Report.Fail("An exception/error occurred in Business Function and reported exception is: " + Exception, "BusinessFunctionException", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB), true);
            }
            else
            {
                Report.Fail("An exception/error occurred reported exception is: " + Exception, "WindowException", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB), true);
            }
        }
    }

}
namespace WebLink.Utils

{
    /// <summary>
    /// To get the Data from input data which are defined in Global data file and dates.
    /// </summary>
    /// /// <example>
    /// InputData.Get("LIBORP1DirectCreditFacility1InformationFieldValues");
    /// </example>

    //[Counter("InputData")]
    public static class InputData
    {
        public static DictionaryValue Get(string InputData)
        {
            string[] ArrayValues = null;
            string Singlestring = null;
            string Newstring = null;
            string DateActions = "SAME";
            try
            { ArrayValues = Data.Get(InputData); }
            catch (System.Exception e) { string ExceptionMessage = e.Message; }

            if (ArrayValues != null)
            {
                for (int i = 0; i < ArrayValues.Length; i++)
                {
                    ArrayValues[i] = ArrayValues[i].Replace("^", ",");
                    if (ArrayValues[i].ToString().IndexOf(":") != -1)
                    {
                        // Assign the Table Values
                        string[] Global_CheckingValue = ArrayValues[i].ToString().Split(":");
                        if (Global_CheckingValue[1].IndexOf("GLOBAL_") != -1)
                        {
                            string tempvalue = Global_CheckingValue[1];
                            ArrayValues[i] = Global_CheckingValue[0] + ":" + Data.Get(Global_CheckingValue[1].ToString());
                            if (Data.Get(Global_CheckingValue[1].ToString()) == "" || Data.Get(Global_CheckingValue[1].ToString()) == null)
                                if (tempvalue.Contains("_ID") == true || tempvalue.Contains("_NAME") == true)
                                    ArrayValues[i] = Global_CheckingValue[0] + ":" + Data.Fetch("ConfigurationSetup", tempvalue);
                        }
                        // Assign the Calculated Date
                        if (Global_CheckingValue[1].ToUpper().IndexOf("PROCESSINGDATE") != -1)
                        {
                            if (Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE") == null)
                                Environment.SetEnvironmentVariable("GLOBAL_SYSTEM_DATE", Data.Fetch("ServicingLogin", "ApplicationProcessDate"));
                            //  Environment.SetEnvironmentVariable("GLOBAL_SYSTEM_DATE", Data.Get("GLOBAL_SYSTEM_DATE"));

                            if (Global_CheckingValue[1].ToUpper().IndexOf("N_PROCESSINGDATE") != -1 || Global_CheckingValue[1].ToUpper().IndexOf("P_PROCESSINGDATE") != -1 || Global_CheckingValue[1].ToUpper().IndexOf("M_PROCESSINGDATE") != -1)
                            {
                                if (Global_CheckingValue[1].ToUpper().IndexOf("N_PROCESSINGDATE") != -1)
                                    DateActions = "NEXT";
                                else if (Global_CheckingValue[1].ToUpper().IndexOf("P_PROCESSINGDATE") != -1)
                                    DateActions = "PREVIUOS";
                                else if (Global_CheckingValue[1].ToUpper().IndexOf("M_PROCESSINGDATE") != -1)
                                    DateActions = "MODIFIED FOLLOWING";
                                else
                                    DateActions = "SAME";

                            }
                            Global_CheckingValue[1] = Global_CheckingValue[1].Replace("N_PROCESSINGDATE", "PROCESSINGDATE").Replace("P_PROCESSINGDATE", "PROCESSINGDATE").Replace("M_PROCESSINGDATE", "PROCESSINGDATE").Replace("S_PROCESSINGDATE", "PROCESSINGDATE");
                            string Datestring = Global_CheckingValue[1].ToUpper().Replace("PROCESSINGDATE", "").Replace("PLUS", "+").Replace("MINUS", "-");
                            if (Datestring.Length > 1)
                            {
                                if (Datestring.Substring(0, 1) == "+")
                                {
                                    Datestring = Datestring.Substring(1);
                                    if (Datestring.IndexOf("+") != -1 || Datestring.IndexOf("-") != -1)
                                    {
                                        if (Datestring.IndexOf("+") != -1)
                                        {
                                            string[] ExpectedData = Datestring.Split('+');
                                            string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                            string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                            string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, DMYInt);
                                            string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, DMYInt1);
                                            // TO Get the Business Date
                                            ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                            ArrayValues[i] = Global_CheckingValue[0] + ":" + WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                        }
                                        else
                                        {
                                            string[] ExpectedData = Datestring.Split('-');
                                            string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                            string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                            string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, DMYInt);
                                            string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, -DMYInt1);
                                            // TO Get the Business Date
                                            ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                            ArrayValues[i] = Global_CheckingValue[0] + ":" + WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                        }
                                    }
                                    else
                                    {
                                        string DMYString = Regex.Replace(Datestring, @"[^A-Z]+", String.Empty).ToLower();
                                        int DMYInt = int.Parse(Regex.Replace(Datestring, @"[^0-9]+", String.Empty));
                                        string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, DMYInt);
                                        // TO Get the Business Date
                                        ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);

                                        ArrayValues[i] = Global_CheckingValue[0] + ":" + WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                    }

                                }
                                else
                                {
                                    Datestring = Datestring.Substring(1);
                                    if (Datestring.IndexOf("+") != -1 || Datestring.IndexOf("-") != -1)
                                    {
                                        if (Datestring.IndexOf("+") != -1)
                                        {
                                            string[] ExpectedData = Datestring.Split('+');
                                            string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                            string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                            string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, -DMYInt);
                                            string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, DMYInt1);
                                            // TO Get the Business Date
                                            ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                            ArrayValues[i] = Global_CheckingValue[0] + ":" + WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                        }
                                        else
                                        {
                                            string[] ExpectedData = Datestring.Split('-');
                                            string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                            string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                            string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, -DMYInt);
                                            string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, -DMYInt1);
                                            // TO Get the Business Date
                                            ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                            ArrayValues[i] = Global_CheckingValue[0] + ":" + WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                        }
                                    }
                                    else
                                    {
                                        string DMYString = Regex.Replace(Datestring, @"[^A-Z]+", String.Empty).ToLower();
                                        int DMYInt = int.Parse(Regex.Replace(Datestring, @"[^0-9]+", String.Empty));
                                        string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, -DMYInt);
                                        // TO Get the Business Date
                                        ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                        ArrayValues[i] = Global_CheckingValue[0] + ":" + WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                    }
                                }
                            }
                            else
                            {
                                // TO Get the Business Date
                                ArrayValues[i] = Global_CheckingValue[0] + ":" + WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), "M/dd/yy");
                            }
                        }

                    }
                    else
                    {
                        //gfdf
                        if (ArrayValues[i].IndexOf("GLOBAL_") != -1)
                        {
                            string tempvalue = ArrayValues[i];
                            ArrayValues[i] = Data.Get(ArrayValues[i].ToString());
                            if (ArrayValues[i] == "" || ArrayValues[i] == null)
                                if (tempvalue.Contains("_ID") == true || tempvalue.Contains("_NAME") == true)
                                    ArrayValues[i] = Data.Fetch("ConfigurationSetup", tempvalue);
                        }
                        // Assign the Calculated Date
                        if (ArrayValues[i].ToUpper().IndexOf("PROCESSINGDATE") != -1)
                        {
                            if (Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE") == null)
                                Environment.SetEnvironmentVariable("GLOBAL_SYSTEM_DATE", Data.Fetch("ServicingLogin", "ApplicationProcessDate"));
                            if (ArrayValues[i].ToUpper().IndexOf("N_PROCESSINGDATE") != -1 || ArrayValues[i].ToUpper().IndexOf("P_PROCESSINGDATE") != -1 || ArrayValues[i].ToUpper().IndexOf("M_PROCESSINGDATE") != -1)
                            {
                                if (ArrayValues[i].ToUpper().IndexOf("N_PROCESSINGDATE") != -1)
                                    DateActions = "NEXT";
                                else if (ArrayValues[i].ToUpper().IndexOf("P_PROCESSINGDATE") != -1)
                                    DateActions = "PREVIUOS";
                                else if (ArrayValues[i].ToUpper().IndexOf("M_PROCESSINGDATE") != -1)
                                    DateActions = "MODIFIED FOLLOWING";
                                else
                                    DateActions = "SAME";

                            }
                            ArrayValues[i] = ArrayValues[i].Replace("N_PROCESSINGDATE", "PROCESSINGDATE").Replace("P_PROCESSINGDATE", "PROCESSINGDATE").Replace("M_PROCESSINGDATE", "PROCESSINGDATE").Replace("S_PROCESSINGDATE", "PROCESSINGDATE");
                            string Datestring = ArrayValues[i].ToUpper().Replace("PROCESSINGDATE", "").Replace("PLUS", "+").Replace("MINUS", "-");
                            if (Datestring.Length > 1)
                            {
                                if (Datestring.Substring(0, 1) == "+")
                                {
                                    Datestring = Datestring.Substring(1);
                                    if (Datestring.IndexOf("+") != -1 || Datestring.IndexOf("-") != -1)
                                    {
                                        if (Datestring.IndexOf("+") != -1)
                                        {
                                            string[] ExpectedData = Datestring.Split('+');
                                            string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                            string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                            string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, DMYInt);
                                            string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, DMYInt1);
                                            ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                            ArrayValues[i] = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                        }
                                        else
                                        {
                                            string[] ExpectedData = Datestring.Split('-');
                                            string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                            string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                            string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, DMYInt);
                                            string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, -DMYInt1);
                                            ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                            ArrayValues[i] = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                        }
                                    }
                                    else
                                    {
                                        string DMYString = Regex.Replace(Datestring, @"[^A-Z]+", String.Empty).ToLower();
                                        int DMYInt = int.Parse(Regex.Replace(Datestring, @"[^0-9]+", String.Empty));
                                        string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, DMYInt);
                                        ArrayValues[i] = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                    }

                                }
                                else
                                {
                                    Datestring = Datestring.Substring(1);
                                    if (Datestring.IndexOf("+") != -1 || Datestring.IndexOf("-") != -1)
                                    {
                                        if (Datestring.IndexOf("+") != -1)
                                        {
                                            string[] ExpectedData = Datestring.Split('+');
                                            string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                            string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                            string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, -DMYInt);
                                            string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, DMYInt1);
                                            ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                            ArrayValues[i] = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                        }
                                        else
                                        {
                                            string[] ExpectedData = Datestring.Split('-');
                                            string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                            string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                            int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                            string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, -DMYInt);
                                            string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, -DMYInt1);
                                            ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                            ArrayValues[i] = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                        }
                                    }
                                    else
                                    {
                                        string DMYString = Regex.Replace(Datestring, @"[^A-Z]+", String.Empty).ToLower();
                                        int DMYInt = int.Parse(Regex.Replace(Datestring, @"[^0-9]+", String.Empty));
                                        string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, -DMYInt);
                                        ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                        ArrayValues[i] = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy");
                                    }
                                }
                            }
                            else
                            {
                                ArrayValues[i] = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), "M/dd/yy");
                            }
                        }
                    }
                }
                return new DictionaryValue(ArrayValues);

            }
            else
            {
                if (InputData.ToUpper().IndexOf("PROCESSINGDATE") != -1)
                {
                    if (Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE") == null)
                        Environment.SetEnvironmentVariable("GLOBAL_SYSTEM_DATE", Data.Fetch("ServicingLogin", "ApplicationProcessDate"));
                    if (InputData.ToUpper().IndexOf("N_PROCESSINGDATE") != -1 || InputData.ToUpper().IndexOf("P_PROCESSINGDATE") != -1 || InputData.ToUpper().IndexOf("M_PROCESSINGDATE") != -1)
                    {
                        if (InputData.ToUpper().IndexOf("N_PROCESSINGDATE") != -1)
                            DateActions = "NEXT";
                        else if (InputData.ToUpper().IndexOf("P_PROCESSINGDATE") != -1)
                            DateActions = "PREVIUOS";
                        else if (InputData.ToUpper().IndexOf("M_PROCESSINGDATE") != -1)
                            DateActions = "MODIFIED FOLLOWING";
                        else
                            DateActions = "SAME";
                    }
                    InputData = InputData.Replace("N_PROCESSINGDATE", "PROCESSINGDATE").Replace("P_PROCESSINGDATE", "PROCESSINGDATE").Replace("M_PROCESSINGDATE", "PROCESSINGDATE").Replace("S_PROCESSINGDATE", "PROCESSINGDATE");
                    string Datestring = InputData.ToUpper().Replace("PROCESSINGDATE", "").Replace("PLUS", "+").Replace("MINUS", "-");
                    if (Datestring.Length > 1)
                    {
                        if (Datestring.Substring(0, 1) == "+")
                        {
                            Datestring = Datestring.Substring(1);
                            if (Datestring.IndexOf("+") != -1 || Datestring.IndexOf("-") != -1)
                            {
                                if (Datestring.IndexOf("+") != -1)
                                {
                                    string[] ExpectedData = Datestring.Split('+');
                                    string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                    int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                    string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                    int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                    string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, DMYInt);
                                    string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, DMYInt1);
                                    ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                    return new DictionaryValue(WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy"));
                                }
                                else
                                {
                                    string[] ExpectedData = Datestring.Split('-');
                                    string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                    int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                    string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                    int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                    string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, DMYInt);
                                    string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, -DMYInt1);
                                    ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                    return new DictionaryValue(WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy"));
                                }
                            }
                            else
                            {
                                string DMYString = Regex.Replace(Datestring, @"[^A-Z]+", String.Empty).ToLower();
                                int DMYInt = int.Parse(Regex.Replace(Datestring, @"[^0-9]+", String.Empty));
                                string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, DMYInt);
                                ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                return new DictionaryValue(WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy"));
                            }

                        }
                        else
                        {
                            Datestring = Datestring.Substring(1);
                            if (Datestring.IndexOf("+") != -1 || Datestring.IndexOf("-") != -1)
                            {
                                if (Datestring.IndexOf("+") != -1)
                                {
                                    string[] ExpectedData = Datestring.Split('+');
                                    string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                    int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                    string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                    int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                    string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, -DMYInt);
                                    string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, DMYInt1);
                                    ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                    return new DictionaryValue(WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy"));
                                }
                                else
                                {
                                    string[] ExpectedData = Datestring.Split('-');
                                    string DMYString = Regex.Replace(ExpectedData[0], @"[^A-Z]+", String.Empty).ToLower();
                                    int DMYInt = int.Parse(Regex.Replace(ExpectedData[0], @"[^0-9]+", String.Empty));
                                    string DMYString1 = Regex.Replace(ExpectedData[1], @"[^A-Z]+", String.Empty).ToLower();
                                    int DMYInt1 = int.Parse(Regex.Replace(ExpectedData[1], @"[^0-9]+", String.Empty));
                                    string PartialDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, -DMYInt);
                                    string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(PartialDate, DMYString1, -DMYInt1);
                                    ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                    return new DictionaryValue(WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy"));
                                }
                            }
                            else
                            {
                                string DMYString = Regex.Replace(Datestring, @"[^A-Z]+", String.Empty).ToLower();
                                int DMYInt = int.Parse(Regex.Replace(Datestring, @"[^0-9]+", String.Empty));
                                string ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), DMYString, -DMYInt);
                                ExpectedDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ExpectedDate, DateActions);
                                return new DictionaryValue(WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(ExpectedDate, "M/dd/yy"));
                            }
                        }
                    }
                    else
                    {
                        return new DictionaryValue(WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(Environment.GetEnvironmentVariable("GLOBAL_SYSTEM_DATE"), "M/dd/yy"));
                    }
                }
                else
                {
                    Singlestring = Data.Get(InputData);
                    if (Singlestring.Length > 7)
                    {
                        if (Singlestring.Substring(0, 7) == "GLOBAL_")
                        {
                            Newstring = Data.Get(Singlestring);
                            return new DictionaryValue(Newstring);
                        }

                        return new DictionaryValue(Singlestring);
                    }
                    else
                    {
                        if (InputData.IndexOf("GLOBAL_") != -1 && Singlestring == "")
                        {
                            if (InputData.Contains("_ID") == true || InputData.Contains("_NAME") == true)
                                return new DictionaryValue(Data.Fetch("ConfigurationSetup", InputData));
                        }

                        return new DictionaryValue(Singlestring);
                    }

                }
            }
        }
        public static List<string> GetList(string InputData)
        {
            List<string> ArrayList = new List<string>();
            string[] ArrayValues = Data.Get(InputData);
            if (ArrayValues != null)
            {
                for (int i = 0; i < ArrayValues.Length; i++)
                {
                    if (ArrayValues[i].IndexOf("GLOBAL_") != -1)
                        ArrayList.Add(Data.Get(ArrayValues[i]));
                    else
                        ArrayList.Add(ArrayValues[i]);
                }

                return ArrayList;
            }
            else
            {
                ArrayList.Add(Get(InputData));
                return ArrayList;
            }
        }
 
        /// <summary>
        /// To store the runtime data.
        /// </summary>
        /// <param name="KeyName"></param>
        /// <param name="KeyValue"></param>
        /// <param name="FileName"></param>
        //[Counter("Store")]
        public static void Store(string KeyName, string KeyValue, string FileName = null)
        {
            try
            {
                string path = "";
                if (StartupConfiguration.Config.ProjectConfig.DataFilesPath.IndexOf(":") != -1)
                {
                    if (FileName != null)
                        path = StartupConfiguration.Config.ProjectConfig.DataFilesPath + FileName + ".csv";
                    else
                        path = StartupConfiguration.Config.ProjectConfig.DataFilesPath + "NewEnvironmentSpecificData.csv";
                }

                else
                {
                    if (FileName != null)
                        path = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\InputData\\" + FileName + ".csv";
                    else
                        path = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\InputData\\NewEnvironmentSpecificData.csv";
                }

                if (Environment.GetEnvironmentVariable("FirstTime_Store") == null)
                {
                    if (File.Exists(path))
                        File.Delete(path);
                }

                Environment.SetEnvironmentVariable("FirstTime_Store", "No");
                if (File.Exists(path))
                {
                    string[] Arrayline = File.ReadAllLines(path);
                    string text = File.ReadAllText(path);
                    if (text.IndexOf(KeyName + ",") != -1)
                    {
                        for (int i = 0; i < Arrayline.Length; i++)
                        {
                            string[] LineText = Arrayline[i].Split(',');
                            if (LineText[0] == KeyName)
                            {
                                text = text.Replace(LineText[0] + "," + LineText[1], KeyName + "," + KeyValue);
                                File.WriteAllText(path, text);
                                break;
                            }
                        }
                    }
                    else
                    {
                        File.AppendAllText(path, KeyName + "," + KeyValue + Environment.NewLine);
                    }
                }
                else
                {
                    using (StreamWriter sw = File.CreateText(path))
                        sw.WriteLine(KeyName + "," + KeyValue);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
        }


    }
}

namespace WebLink.Utils

{
    /// <summary>
    /// To get the Data from input data which are defined in Global data file and dates.
    /// </summary>
    public static class RunTimeData
    {
        /// <summary>
        /// To get the runtime data based on the Key Name
        /// </summary>
        /// <param name="KeyName"></param>
        /// <param name="FileName"></param>
        /// <returns></returns>
        //[Counter("Get")]
        public static string Get(string KeyName, string FileName = null)
        {
            try
            {
                string path = "";
                string DataFilesDataSet = StartupConfiguration.Config.ProjectConfig.DataFilesDataSet.ToString();
                if (StartupConfiguration.Config.ProjectConfig.SessionFilePath.IndexOf(":") != -1)
                {
                    if (FileName != null)
                        path = StartupConfiguration.Config.ProjectConfig.SessionFilePath + FileName + ".csv";
                    else
                        path = StartupConfiguration.Config.ProjectConfig.SessionFilePath + "RuntimeData.csv";
                }
                else
                {

                    if (FileName != null)
                        path = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\OutputData\\" + FileName + ".csv";
                    else
                        path = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\OutputData\\RuntimeData.csv";
                }
                string[] lines = File.ReadAllLines(path);
                string text = File.ReadAllText(path);
                if (text.IndexOf(KeyName + ",") != -1 || text.IndexOf(KeyName + ":" + DataFilesDataSet + ",") != -1)
                {
                    foreach (string line in lines)
                    {
                        string[] linearray = line.Split(',');
                        if (linearray[0] == KeyName || linearray[0] == KeyName + ":" + DataFilesDataSet)
                            return linearray[1];
                    }
                }
                return "";
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }
        /// <summary>
        /// To store the runtime data.
        /// </summary>
        /// <param name="KeyName"></param>
        /// <param name="KeyValue"></param>
        /// <param name="FileName"></param>
        //[Counter("Store")]
        public static void Store(string KeyName, string KeyValue, string FileName = null)
        {
            try
            {
                string path = "";
                string DataFilesDataSet = StartupConfiguration.Config.ProjectConfig.DataFilesDataSet.ToString();
                if (StartupConfiguration.Config.ProjectConfig.SessionFilePath.IndexOf(":") != -1)
                {
                    if (FileName != null)
                        path = StartupConfiguration.Config.ProjectConfig.SessionFilePath + FileName + ".csv";
                    else
                        path = StartupConfiguration.Config.ProjectConfig.SessionFilePath + "RuntimeData.csv";
                }
                else
                {
                    if (FileName != null)
                        path = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\OutputData\\" + FileName + ".csv";
                    else
                        path = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\OutputData\\RuntimeData.csv";
                }

                if (Environment.GetEnvironmentVariable("FirstTime_Store") == null && FileName == null)
                {
                    if (File.Exists(path))
                        File.Delete(path);
                }

                Environment.SetEnvironmentVariable("FirstTime_Store", "No");
                if (File.Exists(path))
                {
                    string[] Arrayline = File.ReadAllLines(path);
                    string text = File.ReadAllText(path);
                    if (text.IndexOf(KeyName + ",") != -1 || text.IndexOf(KeyName + ":" + DataFilesDataSet + ",") != -1)
                    {
                        for (int i = 0; i < Arrayline.Length; i++)
                        {
                            string[] LineText = Arrayline[i].Split(',');
                            if (LineText[0] == KeyName || LineText[0] == KeyName + ":" + DataFilesDataSet)
                            {
                                text = text.Replace(LineText[0] + "," + LineText[1], KeyName + ":" + DataFilesDataSet + "," + KeyValue);
                                File.WriteAllText(path, text);
                                break;
                            }
                        }
                    }
                    else
                    {
                        File.AppendAllText(path, KeyName + ":" + DataFilesDataSet + "," + KeyValue + Environment.NewLine);
                    }
                }
                else
                {
                    using StreamWriter sw = File.CreateText(path);
                    sw.WriteLine(KeyName + ":" + DataFilesDataSet + "," + KeyValue);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
        }

    }
}
namespace WebLink.Utils

{
    /// <summary>
    /// To get the Data from input data which are defined in Global data file and dates.
    /// </summary>
    public static class Reporter
    {

        public static void Step(string Message)
        {
            try
            {
                Report.Step(Message);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
        }
        public static void Info(string Message, string[] ApplicationData = null)
        {
            try
            {

                if (ApplicationData != null)
                {
                    string test = "";
                    for (int i = 0; i < ApplicationData.Length; i++)
                    {
                        if (!string.IsNullOrWhiteSpace(ApplicationData[i]))
                        {
                            var parts = ApplicationData[i].Split(new[] { ':' }, 2);
                            if (parts.Length == 2 && !string.IsNullOrWhiteSpace(parts[1]))
                            {
                                test = test + ", " + parts[0].Trim() + ": " + parts[1].Trim();
                            }
                        }
                    }
                    if (test != "")
                        test = test.Remove(0, 2).ToUpper();
                    else
                        test = "No Data Entered.";
                    if (StartupConfiguration.UserSettings.DetailReportWithSnaps == true)
                        Report.Info(Message + ": " + test, "Info", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB));

                }
                else
                {
                    if (StartupConfiguration.UserSettings.DetailReportWithSnaps == true)
                        Report.Info(Message, "Info", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB));
                }
                ApplicationData = null;

            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
        }

        public static void Print(string Message, bool screencapture = false)
        {
            try
            {

                if (screencapture)
                {
                    Report.Info(Message, "Info", "True", ApplicationHandlerFactory.GetApplication(ApplicationType.WEB));

                }
                else
                {
                    if (StartupConfiguration.UserSettings.DetailReportWithSnaps == true)
                        Report.Info(Message, true);
                }

            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
        }

        public static void Pass(string Message, object ScreenShotName, string bCaptureReportStmt, object applicationHandle)
        {
            try
            {

                Report.Pass(Message, ScreenShotName, bCaptureReportStmt, applicationHandle);

            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
        }

        public static void Pass(string Message, string bCaptureReportStmt, object applicationHandle)
        {
            try
            {

                Report.Pass(Message, bCaptureReportStmt, applicationHandle);

            }
            catch (Exception e) { string ExceptionMessage = e.Message; }
        }

    }
}

namespace WebLink.Utils
{
    /// <summary>
    /// LIBOR Model Information Calculation.
    /// </summary>
    public static class LIBORModel
    {
        static bool RFRStart = false;
        public static double PreviousRFRRate = 0;
        static WindowsApplication appHandle;
        /// <summary>
        /// This function is used to get the Daily/Cumulative RFR Compounding Base+spread+Reserver interest for the loan.
        /// </summary>
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartDate"></param>
        /// <param name="AccrualEndDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <returns>Fail/TotalLoanInterest</returns>
        /// <example>
        ///  double GetBaseRateCumulativeInterest = LIBORModel.GetTotalCompoundedInterestForThePeriod("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", "YES", 1.97, 4.29);
        ///  double GetBase+Spread+ReserveRateCumulativeInterest = LIBORModel.GetTotalCompoundedInterestForThePeriod("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", "YES", 1.97, 4.29,1,1);
        ///  double GetNoObservationShiftCumulativeInterest = LIBORModel.GetTotalCompoundedInterestForThePeriod("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", "NO", 1.97, 4.29,1,1);
        /// </example>
        //[Counter("GetTotalCompoundedInterestForThePeriod")]
        public static double GetTotalCompoundedInterestForThePeriod(string PrincipalAmount, string AccrualStartDate, string AccrualEndDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 16)
        {
            appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
            try
            {
                if (AccrualStartDate == "" || PrincipalAmount == "" || AccrualEndDate == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                if (Environment.GetEnvironmentVariable("GLOBAL_LIBOR_EXECUTION") == null)
                {
                    Environment.SetEnvironmentVariable("GLOBAL_LIBOR_EXECUTION", "True");
                }
                double MinBaseRate = 0;
                if (MinimumBaseRate != null && MinimumBaseRate.ToString() != "")
                    MinBaseRate = Convert.ToDouble(MinimumBaseRate);
                double MaxBaseRate = 99;
                if (MaximumBaseRate != null && MaximumBaseRate.ToString() != "")
                    MaxBaseRate = Convert.ToDouble(MaximumBaseRate);
                double Spread = 0;
                if (SpreadRate != null && SpreadRate.ToString() != "")
                    Spread = Convert.ToDouble(SpreadRate);
                double Reserve = 0;
                if (ReserveRate != null && ReserveRate.ToString() != "")
                    Reserve = Convert.ToDouble(ReserveRate);
                int LagDays = Int32.Parse(NumLagDays.ToString());
                string NextTargetAccrualDate = AccrualStartDate;
                double BaseRateCumulativeInterest = 0;
                string PreviousDate = AccrualStartDate;
                double PreviousUnnannualizedCumulativeCompoundedRate = 0;
                double previousUnannualizedCumulativeCompoundedRateCalDays = 0;
                int CumulativeShiftDays = 0;
                double UnannualizedNCCR = 0;
                double UnnannualizedCumulativeCompoundedRate = 0;
                double AnnualizedCumulativeCompoundedRate = 0;
                double UnannualizedRate = 0;
                int YearCode = Int16.Parse(WebLinkUtility.WebLinkUtilityLibrary.SplitSideString(YearBasis, "RIGHT", 3));
                AccrualEndDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(AccrualEndDate);
                string DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDateWithLagDays(AccrualStartDate, LagDays);
                double DailyCSAandMarginInterest = 0;
                // double PreviousRFRRate = 0;

                if (appHandle.IsDateLesserOrEqual(AccrualStartDate, AccrualEndDate) == true)
                {
                    do
                    {
                        // ################### Below Code used to get Daily RFR Based on the Index Rate Table and Minimum, Maximum Rate  #############
                        NextTargetAccrualDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(NextTargetAccrualDate, 1);
                        int CumulativeCalendarDays = GetCumulativeCalendarDays(AccrualStartDate, NextTargetAccrualDate, YearBasis);
                        int CalendarDays = GetCalendarDays(PreviousDate, NextTargetAccrualDate, YearBasis);
                        double RFRRate = LIBORModel.GetDailyRFR(DateAfterLagDays, 0, MinBaseRate, MaxBaseRate);
                        if (RFRRate == -1)
                            RFRRate = PreviousRFRRate;
                        else
                            PreviousRFRRate = RFRRate;

                        // #################################################### END ################################################################

                        //##################### Below code used to get the Daily CSA and Margin Interest based on the Spred and Reserve ##############
                        if (Spread != 0 || Reserve != 0)
                        {
                            DailyCSAandMarginInterest = (double.Parse(PrincipalAmount) * (Spread + Reserve) * CalendarDays) / (YearCode * 100);
                        }
                        // #################################################### END ################################################################

                        // ################### Below code used to get the Un-annualized Rate based on the Observation Shift parameter #############
                        if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                        {
                            int ShiftDays = LIBORModel.GetShiftDays(DateAfterLagDays);
                            UnannualizedRate = RFRRate / YearCode * ShiftDays;
                        }
                        else
                        {
                            UnannualizedRate = RFRRate / YearCode * CalendarDays;
                        }
                        UnannualizedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate, 16);
                        // #################################################### END ################################################################

                        // ################   Below code used to get the Unnannualized Cumulative CompoundedRate  ###################################
                        if (PreviousUnnannualizedCumulativeCompoundedRate != 0)
                        {
                            UnnannualizedCumulativeCompoundedRate = ((1 + (UnannualizedRate / 100)) * (1 + (PreviousUnnannualizedCumulativeCompoundedRate / 100)) - 1) * 100;
                            UnnannualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnnannualizedCumulativeCompoundedRate, 16);
                        }
                        else
                        {
                            UnnannualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate, 16);
                        }
                        PreviousUnnannualizedCumulativeCompoundedRate = UnnannualizedCumulativeCompoundedRate;
                        // #################################################### END ################################################################

                        // ####################### Below code used to get the Annualized Cumulative CompoundedRate based on the Observation Shift ############################
                        int CumulativeShiftDays1 = GetCumulativeShiftDays(DateAfterLagDays, DateAfterLagDays, YearBasis);
                        CumulativeShiftDays = CumulativeShiftDays + CumulativeShiftDays1;
                        if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                            AnnualizedCumulativeCompoundedRate = (UnnannualizedCumulativeCompoundedRate * YearCode) / CumulativeShiftDays;
                        else
                            AnnualizedCumulativeCompoundedRate = (UnnannualizedCumulativeCompoundedRate * YearCode) / CumulativeCalendarDays;
                        AnnualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedCumulativeCompoundedRate, DecimalPrecision);
                        // #################################################### END ################################################################

                        // ############# below code used to get the Unannualized Cumulative Compounded Rate Cal Days and Unannualized NCCR  ##############
                        double UnannualizedCumulativeCompoundedRateCalDays = AnnualizedCumulativeCompoundedRate * CumulativeCalendarDays / YearCode;
                        UnannualizedNCCR = UnannualizedCumulativeCompoundedRateCalDays - previousUnannualizedCumulativeCompoundedRateCalDays;
                        previousUnannualizedCumulativeCompoundedRateCalDays = UnannualizedCumulativeCompoundedRateCalDays;
                        // #################################################### END ################################################################

                        // ############################# Below code use to get the Annualized NCCR ##################################################
                        double AnnualizedNCCR = UnannualizedNCCR * YearCode / CalendarDays;
                        AnnualizedNCCR = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedNCCR, RoundingPrecision);
                        // #################################################### END ################################################################

                        // ########## Below code used to get the Daily / Cumulative BaseRate Interest and Total Interest (Base+Spread+Reserve) ###############
                        double DailyRateInterest = (double.Parse(PrincipalAmount) * AnnualizedNCCR * CalendarDays) / (YearCode * 100);
                        BaseRateCumulativeInterest = (DailyRateInterest) + (BaseRateCumulativeInterest) + (DailyCSAandMarginInterest);
                        // #################################################### END ################################################################

                        PreviousDate = NextTargetAccrualDate;
                        DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(DateAfterLagDays, 1);
                    } while (AccrualEndDate != NextTargetAccrualDate && AccrualEndDate != AccrualStartDate);

                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(BaseRateCumulativeInterest, 2);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }


        /// <summary>
        /// This function is used to get the Daily/Cumulative RFR Compounding Base+spread+Reserver interest for the loan.
        /// </summary>
        /// <param name="PrincipalAmount"></param>
        /// <param name="PrePaymentAmount"></param>
        /// <param name="AccrualStartDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="PrePaymentDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="NextRatePeriodBusinessDayAdjustment"></param>
        /// <returns>Fail/TotalLoanInterest</returns>
        /// <example>
        ///  double GetBaseRateCumulativeInterest = LIBORModel.CalculateTotalCompoundedInterestForThePeriodOfLoanAfterPrePayment("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", "YES", 1.97, 4.29);
        ///  double GetBase+Spread+ReserveRateCumulativeInterest = LIBORModel.CalculateTotalCompoundedInterestForThePeriodOfLoanAfterPrePayment("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", "YES", 1.97, 4.29,1,1);
        ///  double GetNoObservationShiftCumulativeInterest = LIBORModel.CalculateTotalCompoundedInterestForThePeriodOfLoanAfterPrePayment("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", "NO", 1.97, 4.29,1,1);
        /// </example> 
        //[Counter("CalculateTotalCompoundedInterestForThePeriodOfLoanAfterPrePayment")]
        public static double CalculateTotalCompoundedInterestForThePeriodOfLoanAfterPrePayment(string PrincipalAmount, string PrePaymentAmount, string AccrualStartDate, string NextRatePeriodDate, string PrePaymentDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 16, string NextRatePeriodBusinessDayAdjustment = "MODIFIED FOLLOWING")
        {
            appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);

            try
            {
                if (AccrualStartDate == "" || PrincipalAmount == "" || TargetDate == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                double PrepayemtAmountAfterCal = CalculateInterestDueAmountForRFRPrincipalPrePayment(PrincipalAmount, PrePaymentAmount, AccrualStartDate, NextRatePeriodDate, Frequency, PrePaymentDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);

                if (Environment.GetEnvironmentVariable("GLOBAL_LIBOR_EXECUTION") == null)
                {
                    Environment.SetEnvironmentVariable("GLOBAL_LIBOR_EXECUTION", "True");
                }
                double MinBaseRate = 0;
                if (MinimumBaseRate != null && MinimumBaseRate.ToString() != "")
                    MinBaseRate = Convert.ToDouble(MinimumBaseRate);
                double MaxBaseRate = 99;
                if (MaximumBaseRate != null && MaximumBaseRate.ToString() != "")
                    MaxBaseRate = Convert.ToDouble(MaximumBaseRate);
                double Spread = 0;
                if (SpreadRate != null && SpreadRate.ToString() != "")
                    Spread = Convert.ToDouble(SpreadRate);
                double Reserve = 0;
                if (ReserveRate != null && ReserveRate.ToString() != "")
                    Reserve = Convert.ToDouble(ReserveRate);
                int LagDays = Int32.Parse(NumLagDays.ToString());
                string NextTargetAccrualDate = AccrualStartDate;
                double BaseRateCumulativeInterest = 0;
                string PreviousDate = AccrualStartDate;
                double PreviousUnnannualizedCumulativeCompoundedRate = 0;
                double previousUnannualizedCumulativeCompoundedRateCalDays = 0;
                int CumulativeShiftDays = 0;
                double UnannualizedNCCR = 0;
                double UnnannualizedCumulativeCompoundedRate = 0;
                double AnnualizedCumulativeCompoundedRate = 0;
                double UnannualizedRate = 0;
                int YearCode = Int16.Parse(WebLinkUtility.WebLinkUtilityLibrary.SplitSideString(YearBasis, "RIGHT", 3));
                TargetDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(TargetDate);
                string DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDateWithLagDays(AccrualStartDate, LagDays);
                double DailyCSAandMarginInterest = 0;
                // double PreviousRFRRate = 0;

                if (appHandle.IsDateLesserOrEqual(AccrualStartDate, TargetDate) == true)
                {
                    do
                    {
                        // ################### Below Code used to get Daily RFR Based on the Index Rate Table and Minimum, Maximum Rate  #############
                        NextTargetAccrualDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(NextTargetAccrualDate, 1);
                        int CumulativeCalendarDays = GetCumulativeCalendarDays(AccrualStartDate, NextTargetAccrualDate, YearBasis);
                        int CalendarDays = GetCalendarDays(PreviousDate, NextTargetAccrualDate, YearBasis);
                        double RFRRate = LIBORModel.GetDailyRFR(DateAfterLagDays, 0, MinBaseRate, MaxBaseRate);
                        if (RFRRate == -1)
                            RFRRate = PreviousRFRRate;
                        else
                            PreviousRFRRate = RFRRate;

                        // #################################################### END ################################################################

                        //##################### Below code used to get the Daily CSA and Margin Interest based on the Spred and Reserve ##############
                        if (Spread != 0 || Reserve != 0)
                        {
                            DailyCSAandMarginInterest = (double.Parse(PrincipalAmount) * (Spread + Reserve) * CalendarDays) / (YearCode * 100);
                        }
                        // #################################################### END ################################################################

                        // ################### Below code used to get the Un-annualized Rate based on the Observation Shift parameter #############
                        if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                        {
                            int ShiftDays = LIBORModel.GetShiftDays(DateAfterLagDays);
                            UnannualizedRate = RFRRate / YearCode * ShiftDays;
                        }
                        else
                        {
                            UnannualizedRate = RFRRate / YearCode * CalendarDays;
                        }
                        UnannualizedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate, 16);
                        // #################################################### END ################################################################

                        // ################   Below code used to get the Unnannualized Cumulative CompoundedRate  ###################################
                        if (PreviousUnnannualizedCumulativeCompoundedRate != 0)
                        {
                            UnnannualizedCumulativeCompoundedRate = ((1 + (UnannualizedRate / 100)) * (1 + (PreviousUnnannualizedCumulativeCompoundedRate / 100)) - 1) * 100;
                            UnnannualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnnannualizedCumulativeCompoundedRate, 16);
                        }
                        else
                        {
                            UnnannualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate, 16);
                        }
                        PreviousUnnannualizedCumulativeCompoundedRate = UnnannualizedCumulativeCompoundedRate;
                        // #################################################### END ################################################################

                        // ####################### Below code used to get the Annualized Cumulative CompoundedRate based on the Observation Shift ############################
                        int CumulativeShiftDays1 = GetCumulativeShiftDays(DateAfterLagDays, DateAfterLagDays, YearBasis);
                        CumulativeShiftDays = CumulativeShiftDays + CumulativeShiftDays1;
                        if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                            AnnualizedCumulativeCompoundedRate = (UnnannualizedCumulativeCompoundedRate * YearCode) / CumulativeShiftDays;
                        else
                            AnnualizedCumulativeCompoundedRate = (UnnannualizedCumulativeCompoundedRate * YearCode) / CumulativeCalendarDays;
                        AnnualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedCumulativeCompoundedRate, DecimalPrecision);
                        // #################################################### END ################################################################

                        // ############# below code used to get the Unannualized Cumulative Compounded Rate Cal Days and Unannualized NCCR  ##############
                        double UnannualizedCumulativeCompoundedRateCalDays = AnnualizedCumulativeCompoundedRate * CumulativeCalendarDays / YearCode;
                        UnannualizedNCCR = UnannualizedCumulativeCompoundedRateCalDays - previousUnannualizedCumulativeCompoundedRateCalDays;
                        previousUnannualizedCumulativeCompoundedRateCalDays = UnannualizedCumulativeCompoundedRateCalDays;
                        // #################################################### END ################################################################

                        // ############################# Below code use to get the Annualized NCCR ##################################################
                        double AnnualizedNCCR = UnannualizedNCCR * YearCode / CalendarDays;
                        AnnualizedNCCR = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedNCCR, RoundingPrecision);
                        // #################################################### END ################################################################

                        // ########## Below code used to get the Daily / Cumulative BaseRate Interest and Total Interest (Base+Spread+Reserve) ###############
                        double DailyRateInterest = (double.Parse(PrincipalAmount) * AnnualizedNCCR * CalendarDays) / (YearCode * 100);
                        if (appHandle.IsDateGreaterOrEqual(NextTargetAccrualDate, PrePaymentDate))
                        {
                            if (appHandle.IsDateEqual(NextTargetAccrualDate, PrePaymentDate))
                            {
                                PrincipalAmount = (double.Parse(PrincipalAmount) - double.Parse(PrePaymentAmount)).ToString();
                            }
                            else
                            {
                                string[] splitvalue = AnnualizedNCCR.ToString().Split('.');
                                int Thirdrddecimal = int.Parse(splitvalue[1].Substring(2, 1));
                                double TwoDigitRoundAnnualizedNCCR = 0;
                                if (Thirdrddecimal > 5)
                                    TwoDigitRoundAnnualizedNCCR = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedNCCR, 2);
                                else
                                    TwoDigitRoundAnnualizedNCCR = double.Parse(ConvertDoubleTostring(AnnualizedNCCR.ToString(), 2));

                                double RFRIntrestAmount = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue((((PrepayemtAmountAfterCal * TwoDigitRoundAnnualizedNCCR) / (YearCode * 100)) * CalendarDays), 2);
                                DailyRateInterest = DailyRateInterest + RFRIntrestAmount;
                                PrepayemtAmountAfterCal = PrepayemtAmountAfterCal + RFRIntrestAmount;
                            }
                        }
                        BaseRateCumulativeInterest = (DailyRateInterest) + (BaseRateCumulativeInterest) + (DailyCSAandMarginInterest);
                        // #################################################### END ################################################################

                        PreviousDate = NextTargetAccrualDate;
                        DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(DateAfterLagDays, 1);
                    } while (TargetDate != NextTargetAccrualDate && TargetDate != AccrualStartDate);

                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(BaseRateCumulativeInterest, 2);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }

        /// <summary>
        /// This function is used to get the Daily/Cumulative RFR Compounding Base+spread+Reserver interest for the loan.
        /// </summary>
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartOrRateSetDate"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <returns>Fail/DailyInterest</returns>
        /// <example>
        ///  double GetDailyInterest = LIBORModel.GetCompoundedDailyInterestForTheSpecificDate("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", "YES", 1.97, 4.29);
        ///  double GetDailyInterest = LIBORModel.GetCompoundedDailyInterestForTheSpecificDate("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", "YES", 1.97, 4.29,1,1);
        ///  double GetNoObservationShiftCumulativeInterest = LIBORModel.GetCompoundedDailyInterestForTheSpecificDate("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", "NO", 1.97, 4.29,1,1);
        /// </example>
        //[Counter("GetCompoundedDailyInterestForTheSpecificDate")]
        public static double GetCompoundedDailyInterestForTheSpecificDate(string PrincipalAmount, string AccrualStartOrRateSetDate, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 16)
        {
            try
            {
                if (AccrualStartOrRateSetDate == "" || PrincipalAmount == "" || TargetDate == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                double MinBaseRate = 0;
                if (MinimumBaseRate != null && MinimumBaseRate.ToString() != "")
                    MinBaseRate = Convert.ToDouble(MinimumBaseRate);
                double MaxBaseRate = 99;
                if (MaximumBaseRate != null && MaximumBaseRate.ToString() != "")
                    MaxBaseRate = Convert.ToDouble(MaximumBaseRate);
                double Spread = 0;
                if (SpreadRate != null && SpreadRate.ToString() != "")
                    Spread = Convert.ToDouble(SpreadRate);
                double Reserve = 0;
                if (ReserveRate != null && ReserveRate.ToString() != "")
                    Reserve = Convert.ToDouble(ReserveRate);
                int LagDays = Int32.Parse(NumLagDays.ToString());
                string NextTargetAccrualDate = AccrualStartOrRateSetDate;
                double DailyRateInterest = 0;
                string PreviousDate = AccrualStartOrRateSetDate;
                double PreviousUnnannualizedCumulativeCompoundedRate = 0;
                double previousUnannualizedCumulativeCompoundedRateCalDays = 0;
                int CumulativeShiftDays = 0;
                double UnannualizedNCCR = 0;
                double UnnannualizedCumulativeCompoundedRate = 0;
                double AnnualizedCumulativeCompoundedRate = 0;
                double UnannualizedRate = 0;
                int YearCode = Int16.Parse(WebLinkUtility.WebLinkUtilityLibrary.SplitSideString(YearBasis, "RIGHT", 3));
                TargetDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(TargetDate, 1);
                TargetDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(TargetDate);
                string DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDateWithLagDays(AccrualStartOrRateSetDate, LagDays);
                double DailyCSAandMarginInterest = 0;
                // double PreviousRFRRate = 0;
                do
                {
                    // ################### Below Code used to get Daily RFR Based on the Index Rate Table and Minimum, Maximum Rate  #############
                    NextTargetAccrualDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(NextTargetAccrualDate, 1);
                    int CumulativeCalendarDays = GetCumulativeCalendarDays(AccrualStartOrRateSetDate, NextTargetAccrualDate, YearBasis);
                    int CalendarDays = GetCalendarDays(PreviousDate, NextTargetAccrualDate, YearBasis);
                    double RFRRate = LIBORModel.GetDailyRFR(DateAfterLagDays, 0, MinBaseRate, MaxBaseRate);
                    if (RFRRate == -1)
                        RFRRate = PreviousRFRRate;
                    else
                        PreviousRFRRate = RFRRate;
                    // #################################################### END ################################################################

                    //##################### Below code used to get the Daily CSA and Margin Interest based on the Spred and Reserve ##############
                    if (Spread != 0 || Reserve != 0)
                    {
                        DailyCSAandMarginInterest = (double.Parse(PrincipalAmount) * (Spread + Reserve) * CalendarDays) / (YearCode * 100);
                    }
                    // #################################################### END ################################################################

                    // ################### Below code used to get the Un-annualized Rate based on the Observation Shift parameter #############
                    if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                    {
                        int ShiftDays = LIBORModel.GetShiftDays(DateAfterLagDays);
                        UnannualizedRate = RFRRate / YearCode * ShiftDays;
                    }
                    else
                    {
                        UnannualizedRate = RFRRate / YearCode * CalendarDays;
                    }
                    UnannualizedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate, 16);
                    // #################################################### END ################################################################

                    // ################   Below code used to get the Unnannualized Cumulative CompoundedRate  ###################################
                    if (PreviousUnnannualizedCumulativeCompoundedRate != 0)
                    {
                        UnnannualizedCumulativeCompoundedRate = ((1 + (UnannualizedRate / 100)) * (1 + (PreviousUnnannualizedCumulativeCompoundedRate / 100)) - 1) * 100;
                        UnnannualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnnannualizedCumulativeCompoundedRate, 16);
                    }
                    else
                    {
                        UnnannualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate, 16);
                    }
                    PreviousUnnannualizedCumulativeCompoundedRate = UnnannualizedCumulativeCompoundedRate;
                    // #################################################### END ################################################################

                    // ####################### Below code used to get the Annualized Cumulative CompoundedRate based on the Observation Shift ############################
                    int CumulativeShiftDays1 = GetCumulativeShiftDays(DateAfterLagDays, DateAfterLagDays, YearBasis);
                    CumulativeShiftDays = CumulativeShiftDays + CumulativeShiftDays1;
                    if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                        AnnualizedCumulativeCompoundedRate = (UnnannualizedCumulativeCompoundedRate * YearCode) / CumulativeShiftDays;
                    else
                        AnnualizedCumulativeCompoundedRate = (UnnannualizedCumulativeCompoundedRate * YearCode) / CumulativeCalendarDays;
                    AnnualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedCumulativeCompoundedRate, DecimalPrecision);
                    // #################################################### END ################################################################

                    // ############# below code used to get the Unannualized Cumulative Compounded Rate Cal Days and Unannualized NCCR  ##############
                    double UnannualizedCumulativeCompoundedRateCalDays = AnnualizedCumulativeCompoundedRate * CumulativeCalendarDays / YearCode;
                    UnannualizedNCCR = UnannualizedCumulativeCompoundedRateCalDays - previousUnannualizedCumulativeCompoundedRateCalDays;
                    previousUnannualizedCumulativeCompoundedRateCalDays = UnannualizedCumulativeCompoundedRateCalDays;
                    // #################################################### END ################################################################

                    // ############################# Below code use to get the Annualized NCCR ##################################################
                    double AnnualizedNCCR = UnannualizedNCCR * YearCode / CalendarDays;
                    AnnualizedNCCR = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedNCCR, RoundingPrecision);
                    // #################################################### END ################################################################

                    // ########## Below code used to get the Daily interest (Base+Spread+Reserve) ###############
                    DailyRateInterest = ((double.Parse(PrincipalAmount) * AnnualizedNCCR * CalendarDays) / (YearCode * 100)) + DailyCSAandMarginInterest;
                    // #################################################### END ################################################################

                    PreviousDate = NextTargetAccrualDate;
                    DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(DateAfterLagDays, 1);
                } while (TargetDate != NextTargetAccrualDate && TargetDate != AccrualStartOrRateSetDate);

                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(DailyRateInterest, 2);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to calculate the Current rate for the  for the loan.
        /// </summary>
        /// <param name="RFRRate"></param>
        /// <param name="Spread"></param>
        /// <param name="Reserve"></param>
        /// <param name="PercentageOf"></param>
        /// <param name="CalculationMethod"></param>
        /// <returns>None</returns>
        /// <example>
        /// LIBORModel.CalculateCurrentRateForSpecifiedRateCalculationMethod();
        /// </example>
        //[Counter("CalculateCurrentRateForSpecifiedRateCalculationMethod")]

        public static double CalculateCurrentRateForSpecifiedRateCalculationMethod(double RFRRate = 0, double Spread = 0, double Reserve = 0, double PercentageOf = 0, string CalculationMethod = null)
        {
            double TotalRate = 0;
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string keyelement = CalculationMethod.ToUpper();
                switch (keyelement)
                {
                    case "BASE + SPREAD + RESERVES":
                        TotalRate = RFRRate + Spread + Reserve;
                        break;

                    case "BASE TIMES PERCENTAGE-OF":
                        TotalRate = (RFRRate * PercentageOf) / 100;
                        break;

                    case " (BASE + SPREAD + RESERVES) * PCT":
                        TotalRate = ((RFRRate + Spread + Reserve) * PercentageOf) / 100;
                        break;

                    case " ((BASE + SPREAD) * PCT) + RESERVES":
                        TotalRate = (((RFRRate + Spread) * PercentageOf) / 100) + Reserve;
                        break;

                    case " ((BASE + RESERVES) * PCT) + SPREAD":
                        TotalRate = (((RFRRate + Reserve) * PercentageOf) / 100) + Spread;
                        break;

                    case " (BASE * PCT) + SPREAD + RESERVES":
                        TotalRate = ((RFRRate * PercentageOf) / 100) + Spread + Reserve;
                        break;

                    case "BASE ONLY":
                        TotalRate = RFRRate;
                        break;

                    case "BASE (COMP) + SPREAD + RESERVE":
                        // TotalRate = ; code needs to test
                        break;

                    default:
                        break;
                }

            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return TotalRate;
        }
        /// <summary>
        /// This function is used to get the Non RFR simple daily/Cumulative fixed rate interest for the loan.
        /// </summary> 
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartDate"></param>
        /// <param name="AccrualEndDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="PercentageOf"></param>
        /// <param name="CalculationMethod"></param>
        /// <returns>Fail/Interest</returns>
        /// <example>
        ///  double GetNonRFRBaseRateCumulativeInterest = LIBORModel.GetTotalSimpleInterestForThePeriod("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", 1.97, 4.29);
        ///  double GetNonRFRBase+Spread+ReserveRateCumulativeInterest = LIBORModel.GetTotalSimpleInterestForThePeriod("25000", "11/20/18", "11/20/18", 5, "ACTUAL/360", 1.97, 4.29,1,1);
        /// </example>
        //[Counter("GetTotalSimpleInterestForThePeriod")]
        public static double GetTotalSimpleInterestForThePeriod(string PrincipalAmount, string AccrualStartDate, string AccrualEndDate, object NumLagDays, string YearBasis = "ACTUAL/360", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int RoundingPrecision = 2, object PercentageOf = null, string CalculationMethod = "BASE + SPREAD + RESERVES")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                if (AccrualStartDate == "" || PrincipalAmount == "" || AccrualEndDate == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                double MinBaseRate = 0;
                if (MinimumBaseRate != null && MinimumBaseRate.ToString() != "")
                    MinBaseRate = Convert.ToDouble(MinimumBaseRate);
                double MaxBaseRate = 99;
                if (MaximumBaseRate != null && MaximumBaseRate.ToString() != "")
                    MaxBaseRate = Convert.ToDouble(MaximumBaseRate);
                double Spread = 0;
                if (SpreadRate != null && SpreadRate.ToString() != "")
                    Spread = Convert.ToDouble(SpreadRate);
                double Reserve = 0;
                if (ReserveRate != null && ReserveRate.ToString() != "")
                    Reserve = Convert.ToDouble(ReserveRate);
                double PercentageOfs = 100;
                if (PercentageOf != null && PercentageOf.ToString() != "")
                    PercentageOfs = Convert.ToDouble(PercentageOf);
                int LagDays = Int32.Parse(NumLagDays.ToString());
                string NextTargetAccrualDate = AccrualStartDate;
                double SimpleRateCumulativeInterest = 0;
                string PreviousDate = AccrualStartDate;
                int YearCode = Int16.Parse(WebLinkUtility.WebLinkUtilityLibrary.SplitSideString(YearBasis, "RIGHT", 3));
                AccrualEndDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(AccrualEndDate);
                string DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDateWithLagDays(AccrualStartDate, LagDays);
                string TargetNextDay = DateAfterLagDays;
                double RFRRate = 0;
                if (appHandle.IsDateLesserOrEqual(AccrualStartDate, AccrualEndDate) == true)
                {
                    do
                    {
                        // ################ Below code used to get the Calendar Days #################################
                        NextTargetAccrualDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(NextTargetAccrualDate, 1);
                        int CalendarDays = GetCalendarDays(PreviousDate, NextTargetAccrualDate, YearBasis);
                        // #################################################### END ################################################################

                        // ######### Below code used to get the Daily RFR Base+Spread+Reserve from Index rate table and Minmum, Maximum rate #########################
                        RFRRate = LIBORModel.GetDailyRFR(DateAfterLagDays, 0, MinBaseRate, MaxBaseRate);
                        if (RFRRate == -1)
                            RFRRate = PreviousRFRRate;
                        else
                            PreviousRFRRate = RFRRate;


                        double TotalRate = CalculateCurrentRateForSpecifiedRateCalculationMethod(RFRRate, Spread, Reserve, PercentageOfs, CalculationMethod);
                        // #################################################### END ################################################################

                        //  ######## Below code used to get the Daily/Cumulative simple interest for the Loan #############################
                        double DailySimpleRateInterest = (double.Parse(PrincipalAmount) * TotalRate * CalendarDays) / (YearCode * 100);
                        SimpleRateCumulativeInterest = (DailySimpleRateInterest) + (SimpleRateCumulativeInterest);
                        // #################################################### END ################################################################


                        PreviousDate = NextTargetAccrualDate;
                        DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(DateAfterLagDays, 1);
                    } while (AccrualEndDate != NextTargetAccrualDate && AccrualEndDate != AccrualStartDate);

                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(SimpleRateCumulativeInterest, RoundingPrecision);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }

        /// <summary>
        /// This function is used to get the Non Index simple fixed rate interest for the loan.
        /// </summary>
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartDate"></param>
        /// <param name="AccrualEndDate"></param>
        /// <param name="YearBasis"></param>
        /// <param name="BaseRate"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="PercentageOf"></param>
        /// <param name="RateCalculationMethod"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="RoundingPrecision"></param>
        /// <returns>Fail/Interest</returns>
        /// <example>
        /// Example: double Interest = LIBORModel.GetNonIndexSimpleInterestForThePeriod("100000", "1/04/19","2/07/19","Monthly", "1/08/19", 5, "ACTUAL/360");
        /// </example>
        //[Counter("GetNonIndexSimpleInterestForThePeriod")]
        public static double GetNonIndexSimpleInterestForThePeriod(string PrincipalAmount, string AccrualStartDate, string AccrualEndDate, string YearBasis = "ACTUAL/360", object BaseRate = null, object SpreadRate = null, object ReserveRate = null, object PercentageOf = null, string RateCalculationMethod = "BASE + SPREAD + RESERVES", object MinimumBaseRate = null, object MaximumBaseRate = null, int RoundingPrecision = 2)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);

                if (AccrualStartDate == "" || PrincipalAmount == "" || AccrualEndDate == "" || YearBasis == "")
                    return -1;
                double MinBaseRate = 0;
                if (MinimumBaseRate != null && MinimumBaseRate.ToString() != "")
                    MinBaseRate = Convert.ToDouble(MinimumBaseRate);
                double MaxBaseRate = 99;
                if (MaximumBaseRate != null && MaximumBaseRate.ToString() != "")
                    MaxBaseRate = Convert.ToDouble(MaximumBaseRate);
                double Base = 0;
                if (BaseRate != null && BaseRate.ToString() != "")
                    Base = Convert.ToDouble(BaseRate);
                double Spread = 0;
                if (SpreadRate != null && SpreadRate.ToString() != "")
                    Spread = Convert.ToDouble(SpreadRate);
                double Reserve = 0;
                if (ReserveRate != null && ReserveRate.ToString() != "")
                    Reserve = Convert.ToDouble(ReserveRate);
                double PercentageOfs = 100;
                if (PercentageOf != null && PercentageOf.ToString() != "")
                    PercentageOfs = Convert.ToDouble(PercentageOf);

                double TotalRate = LIBORModel.CalculateCurrentRateForSpecifiedRateCalculationMethod(Base, Spread, Reserve, PercentageOfs, RateCalculationMethod);

                int CalendarDays = LIBORModel.GetCalendarDays(AccrualStartDate, AccrualEndDate, YearBasis);
                int YearCode = Int16.Parse(WebLinkUtility.WebLinkUtilityLibrary.SplitSideString(YearBasis, "RIGHT", 3));
                double DailySimpleRateInterest = (double.Parse(PrincipalAmount) * TotalRate * CalendarDays) / (YearCode * 100);
                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(DailySimpleRateInterest, RoundingPrecision);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return 0;
        }



        /// <summary>
        /// This function is used to get the Non RFR simple MTD Cumulative fixed rate interest for the loan.
        /// </summary> 
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartDate"></param>
        /// <param name="CurrentSystemDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="PercentageOf"></param>
        /// <param name="CalculationMethod"></param>
        /// <returns>Fail/Interest</returns>
        /// <example>
        /// Example: double Interest = LIBORModel.CalculateITDAccruredAmountForSimpleLoan("100000", "1/04/19","2/07/19","Monthly", "1/08/19", 5, "ACTUAL/360");
        /// </example>
        //[Counter("CalculateMTDAccruredAmountForSimpleLoan")]
        public static double CalculateMTDAccruredAmountForSimpleLoan(string PrincipalAmount, string AccrualStartDate, string CurrentSystemDate, object NumLagDays, string YearBasis = "ACTUAL/360", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int RoundingPrecision = 2, object PercentageOf = null, string CalculationMethod = "BASE + SPREAD + RESERVES")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string GetMonthFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetMonthFirstDate(CurrentSystemDate);
                string GetMonthFirstDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetMonthFirstDate, "PREVIOUS");

                string[] ACStartDate = AccrualStartDate.Split('/');
                string[] TargetDate = CurrentSystemDate.Split('/');
                if (GetMonthFirstDate != GetMonthFirstDate1 && ACStartDate[0] != TargetDate[0])
                {
                    string NextBusinessDateFromFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetMonthFirstDate, "NEXT");
                    double AmountForTillMonthFirstBusinesDay = LIBORModel.GetTotalSimpleInterestForThePeriod(PrincipalAmount, GetMonthFirstDate1, NextBusinessDateFromFirstDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, RoundingPrecision, PercentageOf, CalculationMethod);
                    double MTDamount = LIBORModel.GetTotalSimpleInterestForThePeriod(PrincipalAmount, GetMonthFirstDate1, CurrentSystemDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, RoundingPrecision, PercentageOf, CalculationMethod);

                    int Datediff = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetMonthFirstDate1, NextBusinessDateFromFirstDate, "D");
                    int Datediff1 = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetMonthFirstDate, NextBusinessDateFromFirstDate, "D");
                    double MTDamount1 = (AmountForTillMonthFirstBusinesDay / Datediff) * (Datediff - Datediff1);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(MTDamount - MTDamount1, 2);
                }
                else if (GetMonthFirstDate == GetMonthFirstDate1 && ACStartDate[0] != TargetDate[0])
                {
                    double MTDamount = LIBORModel.GetTotalSimpleInterestForThePeriod(PrincipalAmount, GetMonthFirstDate1, CurrentSystemDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, RoundingPrecision, PercentageOf, CalculationMethod);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(MTDamount, 2);
                }
                else
                {
                    double MTDamount = LIBORModel.GetTotalSimpleInterestForThePeriod(PrincipalAmount, AccrualStartDate, CurrentSystemDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, RoundingPrecision, PercentageOf, CalculationMethod);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(MTDamount, 2);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

        /// <summary>
        /// This function is used to get the Non RFR simple QTD Cumulative fixed rate interest for the loan.
        /// </summary> 
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <returns>Fail/Interest</returns>
        /// <example>
        /// Example: double ReserveRateCumulativeInterest = LIBORModel.CalculateQTDAccruredAmountForSimpleLoan("100000", "1/04/19","2/07/19","Monthly", "1/08/19", 5, "ACTUAL/360");
        /// </example>
        //[Counter("CalculateQTDAccruredAmountForSimpleLoan")]
        public static double CalculateQTDAccruredAmountForSimpleLoan(string PrincipalAmount, string AccrualStartDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, bool QTDCalculation = true)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string GetQuarterFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterFirstDate(TargetDate);
                string[] QTDArray = GetQuarterFirstDate.Split('/');
                string[] ACQTDStartDate = AccrualStartDate.Split('/');
                int AccrualStartDateQuarterNum = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterForSpecifiedDate(AccrualStartDate);

                string[] TargetQTDDate = TargetDate.Split('/');
                int TargetDateQuarterNum = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterForSpecifiedDate(TargetDate);

                if (int.Parse(QTDArray[0]) <= int.Parse(ACQTDStartDate[0]) && int.Parse(QTDArray[2]) == int.Parse(ACQTDStartDate[2]))
                    GetQuarterFirstDate = AccrualStartDate;

                string GetQuarterFirstDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetQuarterFirstDate, "PREVIOUS");
                if (appHandle.IsDateGreaterOrEqual(GetQuarterFirstDate1, NextRatePeriodDate) == true)
                    NextRatePeriodDate = TargetDate;
                if (QTDCalculation == false)
                {
                    double QTDamount = LIBORModel.GetTotalSimpleInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(QTDamount, 2);
                }
                else if (GetQuarterFirstDate != GetQuarterFirstDate1 && ACQTDStartDate[0] != TargetQTDDate[0] && AccrualStartDateQuarterNum != TargetDateQuarterNum)
                {
                    string NextBusinessDateFromQTDFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetQuarterFirstDate, "NEXT");
                    double QTDamount = LIBORModel.GetTotalSimpleInterestForThePeriodOfLoan(PrincipalAmount, GetQuarterFirstDate1, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    double QTDamount1 = LIBORModel.GetTotalSimpleInterestForThePeriodOfLoan(PrincipalAmount, GetQuarterFirstDate1, NextRatePeriodDate, Frequency, NextBusinessDateFromQTDFirstDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    int Datediff = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetQuarterFirstDate1, NextBusinessDateFromQTDFirstDate, "D");
                    int Datediff1 = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetQuarterFirstDate, NextBusinessDateFromQTDFirstDate, "D");
                    QTDamount1 = (QTDamount1 / Datediff) * (Datediff - Datediff1);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue((QTDamount - QTDamount1), 2);
                }
                else if (GetQuarterFirstDate == GetQuarterFirstDate1 && ACQTDStartDate[0] != TargetQTDDate[0] && AccrualStartDateQuarterNum != TargetDateQuarterNum)
                {
                    double QTDamount = LIBORModel.GetTotalSimpleInterestForThePeriodOfLoan(PrincipalAmount, GetQuarterFirstDate1, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(QTDamount, 2);
                }
                else
                {
                    double QTDamount = LIBORModel.GetTotalSimpleInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(QTDamount, 2);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to get the Non RFR simple YTD Cumulative fixed rate interest for the loan.
        /// </summary> 
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <returns>Fail/Interest</returns>
        /// <example>
        /// Example: double ReserveRateCumulativeInterest = LIBORModel.CalculateYTDAccruredAmountForSimpleLoan("100000", "1/04/19","2/07/19","Monthly", "1/08/19", 5, "ACTUAL/360");
        /// </example>
        //[Counter("CalculateYTDAccruredAmountForSimpleLoan")]
        public static double CalculateYTDAccruredAmountForSimpleLoan(string PrincipalAmount, string AccrualStartDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, bool YTDCalculation = true)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string GetYearFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetYearFirstDate(TargetDate);
                string GetYearFirstDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetYearFirstDate, "PREVIOUS");

                string[] ACYTDStartDate = AccrualStartDate.Split('/');
                string[] TargetYTDDate = TargetDate.Split('/');

                if (appHandle.IsDateGreaterOrEqual(GetYearFirstDate1, NextRatePeriodDate) == true)
                    NextRatePeriodDate = TargetDate;
                if (YTDCalculation == false)
                {
                    double YTDamount = LIBORModel.GetTotalSimpleInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(YTDamount, 2);
                }
                else if (GetYearFirstDate != GetYearFirstDate1 && ACYTDStartDate[2] != TargetYTDDate[2])
                {
                    string NextBusinessDateFromYTDFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetYearFirstDate, "NEXT");
                    double YTDamount = LIBORModel.GetTotalSimpleInterestForThePeriodOfLoan(PrincipalAmount, GetYearFirstDate1, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    double YTDamount1 = LIBORModel.GetTotalSimpleInterestForThePeriodOfLoan(PrincipalAmount, GetYearFirstDate1, NextRatePeriodDate, Frequency, NextBusinessDateFromYTDFirstDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    int Datediff = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetYearFirstDate1, NextBusinessDateFromYTDFirstDate, "D");
                    int Datediff1 = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetYearFirstDate, NextBusinessDateFromYTDFirstDate, "D");
                    YTDamount1 = (YTDamount1 / Datediff) * (Datediff - Datediff1);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue((YTDamount - YTDamount1), 2);
                }
                else if (GetYearFirstDate == GetYearFirstDate1 && ACYTDStartDate[2] != TargetYTDDate[2])
                {
                    double YTDamount = LIBORModel.GetTotalSimpleInterestForThePeriodOfLoan(PrincipalAmount, GetYearFirstDate1, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(YTDamount, 2);
                }
                else
                {
                    double YTDamount = LIBORModel.GetTotalSimpleInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(YTDamount, 2);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

        /// <summary>
        /// This function is used to get the Non RFR simple ITD Cumulative fixed rate interest for the loan.
        /// </summary> 
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartDate"></param>
        /// <param name="AccrualEndDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <returns>Fail/Interest</returns>
        /// <example>
        /// Example: double ReserveRateCumulativeInterest = LIBORModel.CalculateITDAccruredAmountForSimpleLoan("100000", "1/04/19","2/07/19","Monthly", "1/08/19", 5, "ACTUAL/360");
        /// </example>
        //[Counter("CalculateITDAccruredAmountForSimpleLoan")]
        public static double CalculateITDAccruredAmountForSimpleLoan(string PrincipalAmount, string AccrualStartDate, string AccrualEndDate, object NumLagDays, string YearBasis = "ACTUAL/360", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int RoundingPrecision = 2, object PercentageOf = null, string CalculationMethod = "BASE + SPREAD + RESERVES")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                double MTDamount = LIBORModel.GetTotalSimpleInterestForThePeriod(PrincipalAmount, AccrualStartDate, AccrualEndDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, RoundingPrecision, PercentageOf, CalculationMethod);
                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(MTDamount, 2);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to get the RFR simple MTD Cumulative rate interest for the loan.
        /// </summary> 
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartOrPreviousRateSetDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="NextRatePeriodBusinessDayAdjustment"></param>
        /// <returns>Fail/Interest</returns>
        /// <example>
        /// double ReserveRateCumulativeInterest = LIBORModel.CalculateMTDAccruredAmountForRFRLoan("100000", "12/01/18","2/07/19","Monthly", "1/08/19", 5, "ACTUAL/360");
        /// </example>
        //[Counter("CalculateMTDAccruredAmountForRFRLoan")]
        public static double CalculateMTDAccruredAmountForRFRLoan(string PrincipalAmount, string AccrualStartOrPreviousRateSetDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 16, string NextRatePeriodBusinessDayAdjustment = "MODIFIED FOLLOWING")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);

                string GetMonthFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetMonthFirstDate(TargetDate);
                string GetMonthFirstDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetMonthFirstDate, "PREVIOUS");
                string[] ACStartMonth = AccrualStartOrPreviousRateSetDate.Split('/');
                string[] TargetMonth = TargetDate.Split('/');
                double MTDValue = 0;
                if (GetMonthFirstDate != GetMonthFirstDate1 && TargetMonth[0] != ACStartMonth[0])
                {
                    string NextBusinessDateFromFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetMonthFirstDate, "NEXT");
                    double TotalIntrestTillCurrentMonthFirstBusinessDate = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, NextBusinessDateFromFirstDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double TotalIntrestTilPreviousMonthLastBusinessDate = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, GetMonthFirstDate1, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double TotalIntrestTilCurrentDate = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double DifferenceValue = TotalIntrestTillCurrentMonthFirstBusinessDate - TotalIntrestTilPreviousMonthLastBusinessDate;
                    int Datediff = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetMonthFirstDate1, NextBusinessDateFromFirstDate, "D");
                    int Datediff1 = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetMonthFirstDate, NextBusinessDateFromFirstDate, "D");
                    double SplitLastMonthRemainAmount = (DifferenceValue / Datediff) * (Datediff - Datediff1);
                    MTDValue = (TotalIntrestTilCurrentDate - TotalIntrestTilPreviousMonthLastBusinessDate) - SplitLastMonthRemainAmount;

                }

                else if (GetMonthFirstDate == GetMonthFirstDate1 && TargetMonth[0] != ACStartMonth[0])
                {
                    double TotalIntrestTillCurrentMonthFirstBusinessDate = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision);
                    double TotalIntrestTilPreviousMonthLastBusinessDate = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, GetMonthFirstDate1, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision);
                    MTDValue = (TotalIntrestTillCurrentMonthFirstBusinessDate - TotalIntrestTilPreviousMonthLastBusinessDate);
                }
                else
                {
                    MTDValue = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision);
                }

                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(MTDValue, 2);

            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to calculate Cumulative QTD values for the loan.
        /// </summary> 
        /// <param name="LoanEffectiveDate"></param>
        /// <param name="CurrentSystemDate"></param>
        /// <returns>QTD Value</returns>
        /// <example>
        /// LIBORModel.CalculateFullQTD();
        /// </example>
        //[Counter("CalculateFullQTD")]
        public static bool CalculateFullQTD(string LoanEffectiveDate, string CurrentSystemDate)
        {
            try
            {
                string LoanEffectiveDateQuarterFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterFirstDate(LoanEffectiveDate);
                string CurrentSystemDateQuarterFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterFirstDate(CurrentSystemDate);
                if (LoanEffectiveDateQuarterFirstDate == CurrentSystemDateQuarterFirstDate)
                    return true;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return false;
        }
        /// <summary>
        /// This function is used to calculate Cumulative YTD values for the loan.
        /// </summary> 
        /// <param name="LoanEffectiveDate"></param>
        /// <param name="CurrentSystemDate"></param>
        /// <returns>YTD Value</returns>
        /// <example>
        /// LIBORModel.CalculateFullYTD();
        /// </example>
        //[Counter("CalculateFullYTD")]

        public static bool CalculateFullYTD(string LoanEffectiveDate, string CurrentSystemDate)
        {
            try
            {
                string LoanEffectiveDateYearFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetYearFirstDate(LoanEffectiveDate);
                string CurrentSystemDateYearFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetYearFirstDate(CurrentSystemDate);
                if (LoanEffectiveDateYearFirstDate == CurrentSystemDateYearFirstDate)
                    return true;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return false;
        }


        /// <summary>
        /// This function is used to get the RFR simple QTD Cumulative rate interest for the loan.
        /// </summary> 
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartOrPreviousRateSetDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="NextRatePeriodBusinessDayAdjustment"></param>
        /// <returns>Fail/Interest</returns>
        /// <example>
        /// double ReserveRateCumulativeInterest = LIBORModel.CalculateQTDAccruredAmountForRFRLoan("100000", "12/01/18","2/07/19","Monthly", "1/08/19", 5, "ACTUAL/360");
        /// </example>
        //[Counter("CalculateQTDAccruredAmountForRFRLoan")]
        public static double CalculateQTDAccruredAmountForRFRLoan(string PrincipalAmount, string AccrualStartOrPreviousRateSetDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 16, string NextRatePeriodBusinessDayAdjustment = "MODIFIED FOLLOWING", bool QTDCalculation = true)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string GetQuarterFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterFirstDate(TargetDate);
                string[] QTDArray = GetQuarterFirstDate.Split('/');
                string[] ACQTDStartDate = AccrualStartOrPreviousRateSetDate.Split('/');
                int AccrualStartDateQuarterNum = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterForSpecifiedDate(AccrualStartOrPreviousRateSetDate);

                string[] TargetQTDDate = TargetDate.Split('/');
                int TargetDateQuarterNum = WebLinkUtility.WebLinkUtilityLibrary.GetQuarterForSpecifiedDate(TargetDate);
                if (int.Parse(QTDArray[0]) <= int.Parse(ACQTDStartDate[0]) && int.Parse(QTDArray[2]) == int.Parse(ACQTDStartDate[2]))
                    GetQuarterFirstDate = AccrualStartOrPreviousRateSetDate;

                string GetQuarterFirstDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetQuarterFirstDate, "PREVIOUS");
                if (appHandle.IsDateGreaterOrEqual(GetQuarterFirstDate1, NextRatePeriodDate) == true)
                    NextRatePeriodDate = TargetDate;

                if (QTDCalculation == false)
                {
                    double QTDamount = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(QTDamount, 2);
                }
                else if (GetQuarterFirstDate != GetQuarterFirstDate1 && ACQTDStartDate[0] != TargetQTDDate[0] && AccrualStartDateQuarterNum != TargetDateQuarterNum)
                {
                    string NextBusinessDateFromQTDFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetQuarterFirstDate, "NEXT");
                    double QTDamount = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, NextBusinessDateFromQTDFirstDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double QTDamount1 = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, GetQuarterFirstDate1, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double TotalIntrestTilCurrentDate = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double DifferenceValue = QTDamount - QTDamount1;
                    int Datediff = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetQuarterFirstDate1, NextBusinessDateFromQTDFirstDate, "D");
                    int Datediff1 = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetQuarterFirstDate, NextBusinessDateFromQTDFirstDate, "D");
                    double SplitLastMonthRemainAmount = (DifferenceValue / Datediff) * (Datediff - Datediff1);
                    QTDamount1 = (TotalIntrestTilCurrentDate - QTDamount1) - SplitLastMonthRemainAmount;
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(QTDamount1, 2);
                }
                else if (GetQuarterFirstDate == GetQuarterFirstDate1 && ACQTDStartDate[0] != TargetQTDDate[0] && AccrualStartDateQuarterNum != TargetDateQuarterNum)
                {
                    double QTDamount = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, GetQuarterFirstDate1, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double TotalIntrestTilCurrentDate = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double DifferenceValue = TotalIntrestTilCurrentDate - QTDamount;
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(DifferenceValue, 2);
                }
                else
                {
                    double QTDamount = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(QTDamount, 2);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to get the RFR simple YTD Cumulative rate interest for the loan.
        /// </summary> 
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartOrPreviousRateSetDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="NextRatePeriodBusinessDayAdjustment"></param>
        /// <returns>Fail/Interest</returns>
        /// <example>
        /// double ReserveRateCumulativeInterest = LIBORModel.CalculateYTDAccruredAmountForRFRLoan("100000", "12/01/18","2/07/19","Monthly", "1/08/19", 5, "ACTUAL/360");
        /// </example>
        //[Counter("CalculateYTDAccruredAmountForRFRLoan")]
        public static double CalculateYTDAccruredAmountForRFRLoan(string PrincipalAmount, string AccrualStartOrPreviousRateSetDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 16, string NextRatePeriodBusinessDayAdjustment = "MODIFIED FOLLOWING", bool YTDCalculation = true)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string GetQuarterFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetYearFirstDate(TargetDate);
                string GetQuarterFirstDate1 = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetQuarterFirstDate, "PREVIOUS");

                string[] ACQTDStartDate = AccrualStartOrPreviousRateSetDate.Split('/');
                string[] TargetQTDDate = TargetDate.Split('/');

                if (appHandle.IsDateGreaterOrEqual(GetQuarterFirstDate1, NextRatePeriodDate) == true)
                    NextRatePeriodDate = TargetDate;

                if (YTDCalculation == false)
                {
                    double QTDamount = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(QTDamount, 2);
                }
                else if (GetQuarterFirstDate != GetQuarterFirstDate1 && ACQTDStartDate[0] != TargetQTDDate[0])
                {
                    string NextBusinessDateFromQTDFirstDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(GetQuarterFirstDate, "NEXT");
                    double QTDamount = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, NextBusinessDateFromQTDFirstDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double QTDamount1 = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, GetQuarterFirstDate1, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double TotalIntrestTilCurrentDate = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double DifferenceValue = QTDamount - QTDamount1;
                    int Datediff = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetQuarterFirstDate1, NextBusinessDateFromQTDFirstDate, "D");
                    int Datediff1 = WebLinkUtility.WebLinkUtilityLibrary.GetDateDiff(GetQuarterFirstDate, NextBusinessDateFromQTDFirstDate, "D");
                    double SplitLastMonthRemainAmount = (DifferenceValue / Datediff) * (Datediff - Datediff1);
                    QTDamount1 = (TotalIntrestTilCurrentDate - QTDamount1) - SplitLastMonthRemainAmount;
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(QTDamount1, 2);
                }
                else if (GetQuarterFirstDate == GetQuarterFirstDate1 && ACQTDStartDate[0] != TargetQTDDate[0])
                {
                    double QTDamount = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, GetQuarterFirstDate1, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double TotalIntrestTilCurrentDate = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    double DifferenceValue = TotalIntrestTilCurrentDate - QTDamount;
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(DifferenceValue, 2);
                }
                else
                {
                    double QTDamount = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                    return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(QTDamount, 2);
                }
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

        /// <summary>
        /// This function is used to get the RFR simple ITD Cumulative rate interest for the loan.
        /// </summary> 
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartOrPreviousRateSetDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="NextRatePeriodBusinessDayAdjustment"></param>
        /// <returns>Fail/Interest</returns>
        /// <example>
        /// double ReserveRateCumulativeInterest = LIBORModel.CalculateITDAccruredAmountForRFRLoan("100000", "12/01/18","2/07/19","Monthly", "1/08/19", 5, "ACTUAL/360");
        /// </example>
        //[Counter("CalculateITDAccruredAmountForRFRLoan")]
        public static double CalculateITDAccruredAmountForRFRLoan(string PrincipalAmount, string AccrualStartOrPreviousRateSetDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 16, string NextRatePeriodBusinessDayAdjustment = "MODIFIED FOLLOWING")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                double MTDValue = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, Frequency, TargetDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision, NextRatePeriodBusinessDayAdjustment);
                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(MTDValue, 2);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

        /// <summary>
        /// This function is used to get Annualized NCCR for the RFR Compounding Loan
        /// </summary>
        /// <param name="AccrualStartDate"></param>
        /// <param name="AccrualEndDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <returns>Fail/Annualized NCCR</returns>
        /// <example>
        ///  double WithObservationShiftAnnualizedNCCR = LIBORModel.GetAnnualizedNCCR("11/20/18", "11/20/18", 5, "ACTUAL/360", "YES", 1.97, 4.29,DecimalPrecision,RoundingPrecision);
        ///  double WithoutObservationShiftAnnualizedNCCR = LIBORModel.GetAnnualizedNCCR("11/20/18", "11/20/18", 5, "ACTUAL/360","NO", 1.97, 4.29,DecimalPrecision,RoundingPrecision);
        /// </example>
        //[Counter("GetAnnualizedNCCR")]
        public static double GetAnnualizedNCCR(string AccrualStartDate, string AccrualEndDate, object NumLagDays, string YearBasis = "ACTUAL/360", String ObservationShift = "YES", object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 8)
        {
            try
            {
                if (AccrualStartDate == "" || AccrualEndDate == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                double MinBaseRate = 0;
                if (MinimumBaseRate != null && MinimumBaseRate.ToString() != "")
                    MinBaseRate = Convert.ToDouble(MinimumBaseRate);
                double MaxBaseRate = 99;
                if (MaximumBaseRate != null && MaximumBaseRate.ToString() != "")
                    MaxBaseRate = Convert.ToDouble(MaximumBaseRate);
                int LagDays = Int32.Parse(NumLagDays.ToString());

                string NextTargetAccrualDate = AccrualStartDate;
                string PreviousDate = AccrualStartDate;
                double PreviousUnnannualizedCumulativeCompoundedRate = 0;
                double previousUnannualizedCumulativeCompoundedRateCalDays = 0;
                int CumulativeShiftDays = 0;
                double UnannualizedNCCR = 0;
                double UnnannualizedCumulativeCompoundedRate = 0;
                double AnnualizedCumulativeCompoundedRate = 0;
                double UnannualizedRate = 0;
                int YearCode = Int16.Parse(WebLinkUtility.WebLinkUtilityLibrary.SplitSideString(YearBasis, "RIGHT", 3));
                AccrualEndDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(AccrualEndDate);
                string DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDateWithLagDays(AccrualStartDate, LagDays);
                double AnnualizedNCCR = 0;
                // double PreviousRFRRate = 0;
                do
                {
                    NextTargetAccrualDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(NextTargetAccrualDate, 1);
                    int CumulativeCalendarDays = GetCumulativeCalendarDays(AccrualStartDate, NextTargetAccrualDate, YearBasis);
                    int CalendarDays = GetCalendarDays(PreviousDate, NextTargetAccrualDate, YearBasis);
                    double RFRRate = LIBORModel.GetDailyRFR(DateAfterLagDays, 0, MinBaseRate, MaxBaseRate);
                    if (RFRRate == -1)
                        RFRRate = PreviousRFRRate;
                    else
                        PreviousRFRRate = RFRRate;
                    if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                    {
                        int ShiftDays = LIBORModel.GetShiftDays(DateAfterLagDays);
                        UnannualizedRate = RFRRate / YearCode * ShiftDays;
                    }
                    else
                    {
                        UnannualizedRate = RFRRate / YearCode * CalendarDays;
                    }
                    UnannualizedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate, 16);
                    if (PreviousUnnannualizedCumulativeCompoundedRate != 0)
                    {
                        UnnannualizedCumulativeCompoundedRate = ((1 + (UnannualizedRate / 100)) * (1 + (PreviousUnnannualizedCumulativeCompoundedRate / 100)) - 1) * 100;
                        UnnannualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnnannualizedCumulativeCompoundedRate, 16);
                    }
                    else
                    {
                        UnnannualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate, 16);
                    }
                    PreviousUnnannualizedCumulativeCompoundedRate = UnnannualizedCumulativeCompoundedRate;

                    int CumulativeShiftDays1 = GetCumulativeShiftDays(DateAfterLagDays, DateAfterLagDays, YearBasis);
                    CumulativeShiftDays = CumulativeShiftDays + CumulativeShiftDays1;
                    if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                        AnnualizedCumulativeCompoundedRate = (UnnannualizedCumulativeCompoundedRate * YearCode) / CumulativeShiftDays;
                    else
                        AnnualizedCumulativeCompoundedRate = (UnnannualizedCumulativeCompoundedRate * YearCode) / CumulativeCalendarDays;

                    AnnualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedCumulativeCompoundedRate, DecimalPrecision);
                    double UnannualizedCumulativeCompoundedRateCalDays = AnnualizedCumulativeCompoundedRate * CumulativeCalendarDays / YearCode;
                    UnannualizedNCCR = UnannualizedCumulativeCompoundedRateCalDays - previousUnannualizedCumulativeCompoundedRateCalDays;
                    previousUnannualizedCumulativeCompoundedRateCalDays = UnannualizedCumulativeCompoundedRateCalDays;
                    DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(DateAfterLagDays, 1);
                    AnnualizedNCCR = (UnannualizedNCCR * YearCode) / CalendarDays;
                    PreviousDate = NextTargetAccrualDate;
                } while (AccrualEndDate != NextTargetAccrualDate && AccrualEndDate != AccrualStartDate);
                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedNCCR, 8);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }


        /// <summary>
        /// This function is used to get Annualized Cumulative Compounded Rate for the RFR Compounding Loan
        /// </summary>
        /// <param name="AccrualStartDate"></param>
        /// <param name="AccrualEndDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <returns>Fail/Annualized Cumulative Compounded Rate</returns>
        /// <example>
        ///  double WithObservationShiftCumulativeCompoundedRate = LIBORModel.GetAnnualizedCumulativeCompoundedRate("11/20/18", "11/20/18", 5, "ACTUAL/360", "YES", 1.97, 4.29);
        ///  double WithoutObservationShiftCumulativeCompoundedRate = LIBORModel.GetAnnualizedCumulativeCompoundedRate("11/20/18", "11/20/18", 5, "ACTUAL/360","NO", 1.97, 4.29);
        /// </example>
        //[Counter("GetAnnualizedCumulativeCompoundedRate")]
        public static double GetAnnualizedCumulativeCompoundedRate(string AccrualStartDate, string AccrualEndDate, object NumLagDays, string YearBasis = "ACTUAL/360", String ObservationShift = "YES", object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8)
        {
            try
            {
                if (AccrualStartDate == "" || AccrualEndDate == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                double MinBaseRate = 0;
                if (MinimumBaseRate != null && MinimumBaseRate.ToString() != "")
                    MinBaseRate = Convert.ToDouble(MinimumBaseRate);
                double MaxBaseRate = 99;
                if (MaximumBaseRate != null && MaximumBaseRate.ToString() != "")
                    MaxBaseRate = Convert.ToDouble(MaximumBaseRate);
                int LagDays = Int32.Parse(NumLagDays.ToString());

                string NextTargetAccrualDate = AccrualStartDate;
                string PreviousDate = AccrualStartDate;
                double PreviousUnnannualizedCumulativeCompoundedRate = 0;
                int CumulativeShiftDays = 0;
                double UnnannualizedCumulativeCompoundedRate = 0;
                double AnnualizedCumulativeCompoundedRate = 0;
                double UnannualizedRate = 0;
                int YearCode = Int16.Parse(WebLinkUtility.WebLinkUtilityLibrary.SplitSideString(YearBasis, "RIGHT", 3));
                AccrualEndDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(AccrualEndDate);
                string DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDateWithLagDays(AccrualStartDate, LagDays);
                // double PreviousRFRRate = 0;
                do
                {
                    NextTargetAccrualDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(NextTargetAccrualDate, 1);
                    int CumulativeCalendarDays = GetCumulativeCalendarDays(AccrualStartDate, NextTargetAccrualDate, YearBasis);
                    int CalendarDays = GetCalendarDays(PreviousDate, NextTargetAccrualDate, YearBasis);
                    double RFRRate = LIBORModel.GetDailyRFR(DateAfterLagDays, 0, MinBaseRate, MaxBaseRate);
                    if (RFRRate == -1)
                        RFRRate = PreviousRFRRate;
                    else
                        PreviousRFRRate = RFRRate;
                    if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                    {
                        int ShiftDays = LIBORModel.GetShiftDays(DateAfterLagDays);
                        UnannualizedRate = RFRRate / YearCode * ShiftDays;
                    }
                    else
                    {
                        UnannualizedRate = RFRRate / YearCode * CalendarDays;
                    }
                    UnannualizedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate, 16);
                    if (PreviousUnnannualizedCumulativeCompoundedRate != 0)
                    {
                        UnnannualizedCumulativeCompoundedRate = ((1 + (UnannualizedRate / 100)) * (1 + (PreviousUnnannualizedCumulativeCompoundedRate / 100)) - 1) * 100;
                        UnnannualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnnannualizedCumulativeCompoundedRate, 16);
                    }
                    else
                    {
                        UnnannualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate, 16);
                    }
                    PreviousUnnannualizedCumulativeCompoundedRate = UnnannualizedCumulativeCompoundedRate;

                    int CumulativeShiftDays1 = GetCumulativeShiftDays(DateAfterLagDays, DateAfterLagDays, YearBasis);
                    CumulativeShiftDays = CumulativeShiftDays + CumulativeShiftDays1;
                    if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                        AnnualizedCumulativeCompoundedRate = (UnnannualizedCumulativeCompoundedRate * YearCode) / CumulativeShiftDays;
                    else
                        AnnualizedCumulativeCompoundedRate = (UnnannualizedCumulativeCompoundedRate * YearCode) / CumulativeCalendarDays;

                    AnnualizedCumulativeCompoundedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedCumulativeCompoundedRate, DecimalPrecision);

                    PreviousDate = NextTargetAccrualDate;
                    DateAfterLagDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateNextBusinessDate(DateAfterLagDays, 1);


                } while (AccrualEndDate != NextTargetAccrualDate && AccrualEndDate != AccrualStartDate);

                return AnnualizedCumulativeCompoundedRate;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This method is used to return the double value to string with currency format and specified in decimal digits.
        /// </summary>
        /// <param name="InputStringOrNum"></param>
        /// <param name="NoOfDigit"></param>
        /// <returns>-1/string</returns>
        /// <example>
        /// string String1 = LIBORModel.ConvertDoubleTostring(10.46, 1); -- > 10.4
        /// string String1 = LIBORModel.ConvertDoubleTostring(0.46, 2); ---> 0.46
        /// string String1 = LIBORModel.ConvertDoubleTostring(4.46, 3); ---> 4.460
        /// string String1 = LIBORModel.ConvertDoubleTostring(3434.4, 5); ---> 3,434.40000
        /// </example>
        //[Counter("ConvertDoubleTostring")]
        public static string ConvertDoubleTostring(object InputStringOrNum, int NoOfDigit = 2)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                if (InputStringOrNum.ToString().IndexOf(",") != -1)
                    InputStringOrNum = InputStringOrNum.ToString().Replace(",", "");
                double InputVal = Convert.ToDouble(InputStringOrNum);
                int StartPostion = InputVal.ToString().IndexOf(".");
                string CurrencyOrRate = "0";
                if (StartPostion != -1)
                {
                    string[] splitArray = InputVal.ToString().Split('.');
                    CurrencyOrRate = splitArray[0];
                }
                else
                {
                    StartPostion = InputVal.ToString().Length;
                }
                int Endpostion = StartPostion + NoOfDigit + 1;
                string InputVal1 = InputVal.ToString("0.000000000000000000000000");
                string OutDoubleValue = InputVal1.Substring(0, Endpostion);
                if (CurrencyOrRate.Length > 3 && NoOfDigit <= 2 || StartPostion > 3)
                    OutDoubleValue = double.Parse(OutDoubleValue).ToString("C").Replace("$", "");
                if (OutDoubleValue.Substring(0, 2).IndexOf("0.") != -1)
                    OutDoubleValue = OutDoubleValue.Replace("0.", ".");
                if (OutDoubleValue.Substring(0, 3).IndexOf("-0.") != -1)
                    OutDoubleValue = OutDoubleValue.Replace("-0.", "-.");
                return OutDoubleValue;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return "-1";
        }
        /// <summary>
        /// This function is used to get the date that is X number of Lag Days as defined in the Index Rate Master, preceding the Current Processing Group Date prior to an EOD run.
        /// </summary>
        /// <param name="EffectiveDate"></param>
        /// <param name="NumLagDays"></param>
        /// <returns>IndexRateRetrievalDate</returns>
        /// <example>
        /// If Lag Days = 5 and Current Process Group Date prior to EOD run = Tue, June 4, 2019 then Rate Retrieval Date = Tue, May 28, 2019
        /// string IndexRateRetrievalDate = LIBORModel.GetIndexRateRetrievalDate("6/04/19", 5);
        /// </example>
        //[Counter("GetIndexRateRetrievalDate")]
        public static string GetIndexRateRetrievalDate(string EffectiveDate, object NumLagDays)
        {
            try
            {
                string NewDate = EffectiveDate;
                int LagDays = Int32.Parse(NumLagDays.ToString());

                if (LagDays != 0)
                {
                    do
                    {
                        NewDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NewDate, "d", -1);
                        NewDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(NewDate.ToString(), "M/dd/yy");
                        NewDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NewDate, "PREVIOUS");
                        LagDays--;
                    } while (LagDays > 0);
                }
                else
                {
                    NewDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(NewDate.ToString(), "M/dd/yy");
                    NewDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NewDate);
                }
                return NewDate;
            }
            catch (System.Exception e) { Report.Info("Exception Logged:" + e.Message); }
            return null;
        }

        /// <summary>
        /// This function is used to get the Current Processing Group Date that results from running an EOD. The rate that will retrieved by the EOD Process on this date is the current rate that is in effect but not yet applied to the Current Processing Group Date.
        /// </summary>
        /// <param name="AccrualStartDate"></param>
        /// <returns>AccrualEndDate</returns>
        /// <example>
        /// If Lag Days = 5, Current Process Group Date prior to EOD run = Tue, June 4, 2019, Rate Retrieval Date for Prior Curr Process Group Date = Tue, May 28, 2019, Rate Retrieved Applied to Date = Tue, June 4, 2019, Accrue From Date = Tue, June 4, 2019 then 
        /// Current Process Group Date after EOD run = Wed, June 5, 2019, Rate Retrieval Date for Next Curr Process Group Date = Wed, May 29, 2019, Rate Retrieved to be Applied to Date = Wed, June 5, 2019
        /// Accrue End Date = Wed, June 5, 2019 
        /// string AccrualEndDate = LIBORModel.GetAccrualEndDate("6/04/19");
        /// </example>
        //[Counter("GetAccrualEndDate")]
        public static string GetAccrualEndDate(string AccrualStartDate)
        {
            try
            {
                DateTime StandardDateFormatDate = Convert.ToDateTime(AccrualStartDate);
                StandardDateFormatDate = StandardDateFormatDate.AddDays(1);
                string ApplicationFormatDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(StandardDateFormatDate.ToString(), "M/dd/yy");
                string AccrualEndDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ApplicationFormatDate);
                return AccrualEndDate;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return null;
        }

        /// <summary>
        /// This function is used to get the day of the week represented by the day of the Index Rate Retrieval Date.
        /// </summary>
        /// <param name="IndexRateRetrievalDate"></param>
        /// <returns>ShiftWeekDayNi</returns>
        /// <example>
        /// ShiftWeekDayNi value returns for weekdays - Monday = 2, Tueday = 3, Wednesday = 4, Thursday = 5 and Friday = 6
        /// int ShiftWeekDayNi = LIBORModel.GetShiftWeekDayNi("6/04/19");
        /// </example>
        //[Counter("GetShiftWeekDayNi")]
        public static int GetShiftWeekDayNi(string IndexRateRetrievalDate)
        {
            try
            {
                DateTime StandardDate = Convert.ToDateTime(IndexRateRetrievalDate);
                int DayofWeek = ((int)StandardDate.DayOfWeek);
                return DayofWeek + 1;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to get the number of days between the Accrue From and Accrue To Dates.
        /// </summary>
        /// <param name="AccrualStartDate"></param>
        /// <param name="AccrualEndDate"></param>
        /// <param name="YearBasis"></param>
        /// <returns>CalendarDays</returns>
        /// <example>
        /// If Accrue From Date = Tue, June 4, 2019 and Accrue To Date = Wed, June 5, 2019 then
        /// Calendar Days = 1
        /// int CalendarDays = LIBORModel.GetCalendarDays("6/04/19", "6/05/19");
        /// </example>
        //[Counter("GetCalendarDays")]
        public static int GetCalendarDays(string AccrualStartDate, string AccrualEndDate, string YearBasis = "ACTUAL/360")
        {
            try
            {
                string ActualYearBasis = YearBasis;
                if (YearBasis.Contains("/"))
                {
                    string[] YBasis1 = YearBasis.Split('/');
                    ActualYearBasis = YBasis1[0];
                }
                int CalendarDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateDateDifference(AccrualStartDate, AccrualEndDate, ActualYearBasis);
                return CalendarDays;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to get the difference in the Shift Weekday value between the Index Rate Retrieval Date on the Current Processing Group Date after an EOD is run and the Index Rate Retrieval Date on the Current Processing Group Date prior to running an EOD.
        /// </summary>
        /// <param name="IndexRateRetrievalDate"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="YearBasis"></param>
        /// <param name="AccrualStartDate"></param>
        /// <returns>ShiftDays</returns>
        /// <example>
        /// If Lag Days = 5, Current Process Group Date prior to EOD run = Tue, June 4, 2019, Rate Retrieval Date Prior Current Process Group Date = Tue, May 28, 2019, Prior Rate Retrieval Date Shift Weekday = 3, Current Process Group Date after EOD run = Wed, June 5, 2019, Rate Retrieval Date Next Curr Process Group Date = Wed, May 29, 2019, Next Rate Retrieval Date Shift Weekday = 4
        /// Shift Days = Next Rate Retrieval Date Shift Weekday, 4 - Prior Rate Retrieval Date Shift Weekday, 3 = 1
        /// Note 1: If the Current Rate Retrieval Date Shift Weekday is Friday (6), the Next Rate Retrival Date Shift Weekday is Monday (3) resulting in a Shift Days value of 3.
        /// Note 2: If the Current Rate Retrieval Date Shift Weekday is Friday (6) but the following Monday (3) is a non-business day, the Next Rate Retrieval Shift Weekday is Tuesday (4) resulting in a Shift Days value of 4.
        /// int ShiftDays = LIBORModel.GetShiftDays("8/23/18","ACTUAL/360","NO","9/07/18");  returns 3
        /// int ShiftDays = LIBORModel.GetShiftDays("8/23/18","ACTUAL/360");  returns 1
        /// </example>
        //[Counter("GetShiftDays")]
        public static int GetShiftDays(string IndexRateRetrievalDate, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", string AccrualStartDate = null)
        {
            try
            {
                string ActualYearBasis = YearBasis;
                int ShiftDays;
                if (YearBasis.Contains("/"))
                {
                    string[] YBasis1 = YearBasis.Split('/');
                    ActualYearBasis = YBasis1[0];
                }
                if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                {
                    DateTime StandardDateFormatDate = Convert.ToDateTime(IndexRateRetrievalDate);
                    StandardDateFormatDate = StandardDateFormatDate.AddDays(1);
                    string ApplicationFormatDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(StandardDateFormatDate.ToString(), "M/dd/yy");
                    string NextIndexDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ApplicationFormatDate);
                    ShiftDays = WebLinkUtility.WebLinkUtilityLibrary.CalculateDateDifference(IndexRateRetrievalDate, NextIndexDate, ActualYearBasis);
                }
                else
                {
                    DateTime StandardDateFormatDate = Convert.ToDateTime(AccrualStartDate);
                    StandardDateFormatDate = StandardDateFormatDate.AddDays(1);
                    string ApplicationFormatDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(StandardDateFormatDate.ToString(), "M/dd/yy");
                    string NextBusinessDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ApplicationFormatDate);
                    ShiftDays = LIBORModel.GetCalendarDays(AccrualStartDate, NextBusinessDate, ActualYearBasis);
                }
                return ShiftDays;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to calculate and return the total days of the Calendar Days in a Compounding Period. On an EOD run on the Next Rate Period date, the Calendar summation ends and a new Calendar summation begins until the Next Rate Period date is reached and so on. 
        /// </summary>
        /// <param name="EffectiveAccrualDate"></param>
        /// <param name="TargetAccrualDate"></param>
        /// <param name="YearBasis"></param>
        /// <returns>CumulativeCalendarDays</returns>
        /// <example>        
        /// int CumulativeCalendarDays = LIBORModel.GetCumulativeCalendarDays("9/05/19", "9/17/19");
        /// </example>
        public static int GetCumulativeCalendarDays(string EffectiveAccrualDate, string TargetAccrualDate, string YearBasis = "ACTUAL/360")
        {
            try
            {
                string ActualYearBasis = YearBasis;
                if (YearBasis.Contains("/"))
                {
                    string[] YBasis1 = YearBasis.Split('/');
                    ActualYearBasis = YBasis1[0];
                }
                string StartDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(EffectiveAccrualDate, "M/dd/yy");
                string TargetDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(TargetAccrualDate, "M/dd/yy");
                int CumulativeCalendarDays = LIBORModel.GetCalendarDays(StartDate, TargetDate, ActualYearBasis);
                return CumulativeCalendarDays;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to calculate and returns the sum of total Shift Days in a Compounding Period.  On an EOD run on the Next Rate Period date, the Shift Days summation ends and a new Shift Days summation begins until the Next Rate Period date is reached and so on. 
        /// </summary>
        /// <param name="EffectiveIndexDate"></param>
        /// <param name="TargetIndexDate"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="EffectiveAccrualDate"></param>
        /// <param name="TargetAccrualDate"></param>
        /// <returns>CumulativeShiftDays</returns>
        /// <example>        
        /// int CumulativeShiftDays = LIBORModel.GetCumulativeShiftDays("8/28/19", "9/04/19");
        /// int cumulativeshiftdays = LIBORModel.GetCumulativeShiftDays("8/28/19", "9/12/19", "ACTUAL/360", "NO", "9/05/19", "9/20/19");
        /// </example>
        //[Counter("GetCumulativeShiftDays")]
        public static int GetCumulativeShiftDays(string EffectiveIndexDate, string TargetIndexDate, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", string EffectiveAccrualDate = null, string TargetAccrualDate = null)
        {
            try
            {
                int CumulativeShiftDays = 0;
                string StartDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(EffectiveIndexDate, "M/dd/yy");
                string TargetDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(TargetIndexDate, "M/dd/yy");
                string ActualYearBasis = YearBasis;
                if (YearBasis.Contains("/"))
                {
                    string[] YBasis1 = YearBasis.Split('/');
                    ActualYearBasis = YBasis1[0];
                }
                if (ObservationShift.ToUpper() == "YES" || ObservationShift.ToUpper() == "ON")
                {
                    while (true)
                    {
                        int ShiftDays = LIBORModel.GetShiftDays(StartDate, ActualYearBasis);
                        if (StartDate == TargetDate)
                        {
                            CumulativeShiftDays = CumulativeShiftDays + ShiftDays;
                            break;
                        }
                        else
                        {
                            CumulativeShiftDays = CumulativeShiftDays + ShiftDays;
                            DateTime StandardDateFormatDate = Convert.ToDateTime(StartDate);
                            StandardDateFormatDate = StandardDateFormatDate.AddDays(1);
                            string ApplicationFormatDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(StandardDateFormatDate.ToString(), "M/dd/yy");
                            StartDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(ApplicationFormatDate);
                        }
                    }
                }
                else
                {
                    CumulativeShiftDays = LIBORModel.GetCumulativeCalendarDays(EffectiveAccrualDate, TargetAccrualDate, YearBasis);
                }
                return CumulativeShiftDays;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to get CSA Margin value for CSA (Spread), Margin (Reserve) and Accrual Period.
        /// </summary>
        /// <param name="AccrualStartDate"></param>
        /// <param name="CSAValue"></param>
        /// <param name="MarginValue"></param>
        /// <param name="YearBasis"></param>
        /// <returns>CSAMarginValue</returns>
        /// <example>        
        /// double CSAMarginValue = LIBORModel.GetCSAMarginValue("9/05/19", "1.3", "1.37", "ACTUAL/360");
        /// </example>
        //[Counter("GetCSAMarginValue")]
        public static double GetCSAMarginValue(string AccrualStartDate, string CSAValue, string MarginValue, string YearBasis = "ACTUAL/360")
        {
            try
            {
                string StartDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(AccrualStartDate, "M/dd/yy");
                string TargetDate = LIBORModel.GetAccrualEndDate(StartDate);
                int CalendarDays = LIBORModel.GetCalendarDays(StartDate, TargetDate);
                string ActualYearBasis = YearBasis;
                if (YearBasis.Contains("/"))
                {
                    string[] YBasis1 = YearBasis.Split('/');
                    ActualYearBasis = YBasis1[1];
                }
                double CSAMarginValue1 = ((Convert.ToDouble(CSAValue) + Convert.ToDouble(MarginValue)) / Int32.Parse(ActualYearBasis)) * CalendarDays;
                double CSAMarginValue = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(CSAMarginValue1, 9);
                return CSAMarginValue;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// This function is used to get the Index rate from the Index Rate Master Table based on Min Base rate and Maximum Base rate for the Index Retrival Date.
        /// </summary>
        /// <param name="EffectiveDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="MinBaseRate"></param>
        /// <param name="MaxBaseRate"></param>
        /// <returns>DailyRFRRate</returns>
        /// <example>        
        /// double RFRRate = LIBORModel.GetDailyRFR("9/05/18", 5);
        /// double RFRRate = LIBORModel.GetDailyRFR("9/05/18", 5,3,4); 
        /// double RFRRate = LIBORModel.GetDailyRFR("9/05/18", 5,1,1.2);
        /// double RFRRate = LIBORModel.GetDailyRFR("9/05/18", 10,1,9);
        /// </example>
        //[Counter("GetDailyRFR")]
        public static double GetDailyRFR(string EffectiveDate, object NumLagDays, double MinBaseRate = 0, double MaxBaseRate = 99)
        {
            string SqlQuery = "";
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                DBApplication dbApplication = ApplicationHandlerFactory.GetApplication(ApplicationType.DATABASE);
                string CurrentSystemDate = Data.Fetch("ServicingLogin", "ApplicationProcessDate");
                int LagDays = Int32.Parse(NumLagDays.ToString());
                EffectiveDate = WebLinkUtility.WebLinkUtilityLibrary.ConvertDateInGivenFormat(EffectiveDate, "M/dd/yy");
                string IndexDatewithLag = LIBORModel.GetIndexRateRetrievalDate(EffectiveDate, LagDays);
                if (appHandle.IsDateGreaterOrEqual(IndexDatewithLag, CurrentSystemDate) == true)
                {
                    //    IndexDatewithLag = LIBORModel.GetIndexRateRetrievalDate(CurrentSystemDate, 1);
                    IndexDatewithLag = LIBORModel.GetIndexRateRetrievalDate(CurrentSystemDate, 0);
                }

                string DBSchemaName = StartupConfiguration.UserSettings.DBSchemaName.ToString();
                string IndexName = WebLinkUtility.WebLinkUtilityLibrary.GetCurrentRateIndexID();
                bool WindowsLogin = StartupConfiguration.UserSettings.WindowsLogin;
                string ExpectedDate = appHandle.ConvertDateInGivenFormat(IndexDatewithLag, "yyyyMMdd");
                if (WindowsLogin != true)
                    SqlQuery = "select J$RIQR from " + DBSchemaName + ".J$CLRH where J$RIOI = '" + IndexName + "' AND J$RIP8='" + ExpectedDate + "' AND  J$RPRC='A'";
                else
                    SqlQuery = "select J_RIQR from " + DBSchemaName + ".J_CLRH where J_RIOI = '" + IndexName + "' AND J_RIP8='" + ExpectedDate + "' AND  J_RPRC='A'";

                string[,] TotalNoOfRecords1 = dbApplication.GetDataFromTable(SqlQuery);
                string RFRValue1 = "";
                if (RFRStart == false && (TotalNoOfRecords1.Length) == 0)
                {
                    if (WindowsLogin != true)
                        SqlQuery = "select J$RIP8 from " + DBSchemaName + ".J$CLRH where J$RIOI = '" + IndexName + "' AND J$RIP8<='" + ExpectedDate + "' AND  J$RPRC='A'";
                    else
                        SqlQuery = "select J_RIP8 from " + DBSchemaName + ".J_CLRH where J_RIOI = '" + IndexName + "' AND J_RIP8<='" + ExpectedDate + "' AND  J_RPRC='A'";

                    string[,] TotalNoOfRecords2 = dbApplication.GetDataFromTable(SqlQuery);

                    if (WindowsLogin != true)
                        SqlQuery = "select J$RIQR from " + DBSchemaName + ".J$CLRH where J$RIOI = '" + IndexName + "' AND J$RIP8='" + TotalNoOfRecords2[((TotalNoOfRecords2.Length) - 1), 0] + "' AND  J$RPRC='A'";
                    else
                        SqlQuery = "select J_RIQR from " + DBSchemaName + ".J_CLRH where J_RIOI = '" + IndexName + "' AND J_RIP8='" + TotalNoOfRecords2[((TotalNoOfRecords2.Length) - 1), 0] + "' AND  J_RPRC='A'";
                    string[,] TotalNoOfRecords3 = dbApplication.GetDataFromTable(SqlQuery);
                    RFRValue1 = TotalNoOfRecords3[((TotalNoOfRecords3.Length) - 1), 0]; //Data.Get(IndexDatewithLag);
                    RFRStart = true;
                }
                else
                {
                    RFRValue1 = TotalNoOfRecords1[((TotalNoOfRecords1.Length) - 1), 0]; //Data.Get(IndexDatewithLag);
                }

                // qury to get RFR rate 
                double RFRRate = Convert.ToDouble(RFRValue1);
                if (MinBaseRate >= RFRRate && MinBaseRate <= MaxBaseRate)
                    RFRRate = MinBaseRate;
                else if (MinBaseRate <= RFRRate && RFRRate >= MaxBaseRate)
                    RFRRate = MaxBaseRate;

                return RFRRate;
            }
            catch (Exception e) { string ExceptionMessage = e.Message; Report.Warning("Please check the database connection details in configuration file or check SQL query : " + SqlQuery); }
            return -1;
        }
        /// <summary>
        /// This function is used to get Unannualized Rate for the Accrual Period for Accrual Effective Date.
        /// </summary>
        /// <param name="AccrualEffectiveDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <returns>UnannualizedRate</returns>
        /// <example>
        /// If Accrual Effective date is 9/06/18 (Thursday) then method will calculate Accrual End date like - 9/07/18 (Friday). 
        /// If Accrual Effective date is 9/07/18 (Friday) then method will calculate Accrual End date like - 9/10/18 (Monday).
        /// Note: Shift Days substituted with Calendar Days if Observation Shift is not applicable.      
        /// double UnannualizedRate = LIBORModel.GetUnannualizedRate("9/07/18", 5, "ACTUAL/360", "NO");
        /// double UnannualizedRate = LIBORModel.GetUnannualizedRate("9/07/18", 5, "ACTUAL/360");        
        /// </example>
        //[Counter("GetUnannualizedRate")]
        public static double GetUnannualizedRate(string AccrualEffectiveDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object MinimumBaseRate = null, object MaximumBaseRate = null)
        {
            try
            {
                if (AccrualEffectiveDate == "" || (NumLagDays.ToString()) == "")
                    return -1;
                double UnannualizedRate;
                int LagDays = Int32.Parse(NumLagDays.ToString());
                double MinBaseRate = 0;
                if (MinimumBaseRate != null && MinimumBaseRate.ToString() != "")
                    MinBaseRate = Convert.ToDouble(MinimumBaseRate);
                double MaxBaseRate = 99;
                if (MaximumBaseRate != null && MaximumBaseRate.ToString() != "")
                    MaxBaseRate = Convert.ToDouble(MaximumBaseRate);
                double RFRRate = LIBORModel.GetDailyRFR(AccrualEffectiveDate, LagDays, MinBaseRate, MaxBaseRate);
                int ActualYearBasis = Int16.Parse(WebLinkUtility.WebLinkUtilityLibrary.SplitSideString(YearBasis, "RIGHT", 3));
                string IndexRateRetrievalDate = LIBORModel.GetIndexRateRetrievalDate(AccrualEffectiveDate, LagDays);
                int ShiftDays = LIBORModel.GetShiftDays(IndexRateRetrievalDate, YearBasis, ObservationShift, AccrualEffectiveDate);
                double UnannualizedRate1 = (RFRRate / ActualYearBasis) * ShiftDays;
                UnannualizedRate = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(UnannualizedRate1, 16);
                return UnannualizedRate;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

        /// <summary>
        /// This function is used to get Interest Due Amount till the Principal Repayment Date for a Loan.
        /// </summary>
        /// <param name="LoanBalanceAmount"></param>
        /// <param name="PeriodEffectiveDate"></param>
        /// <param name="PrincipalPaymentAmount"></param>
        /// <param name="PrincipalPaymentDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <returns>CompoundedInterestDueAmount</returns>
        /// <example>        
        /// double InterestDueAmount=LIBORModel.GetCompoundedInterestDueAmount("2000000000","10/24/18","500000000","11/08/18",5,"Actual/360");
        /// </example>
        //[Counter("GetCompoundedInterestDueAmount")]
        public static double GetCompoundedInterestDueAmount(string LoanBalanceAmount, string PeriodEffectiveDate, string PrincipalPaymentAmount, string PrincipalPaymentDate, object NumLagDays, string YearBasis = "ACTUAL/360", String ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null)
        {
            try
            {
                double MinBaseRate = 0;
                if (MinimumBaseRate != null && MinimumBaseRate.ToString() != "")
                    MinBaseRate = Convert.ToDouble(MinimumBaseRate);
                double MaxBaseRate = 99;
                if (MaximumBaseRate != null && MaximumBaseRate.ToString() != "")
                    MaxBaseRate = Convert.ToDouble(MaximumBaseRate);
                double Spread = 0;
                if (SpreadRate != null && SpreadRate.ToString() != "")
                    Spread = Convert.ToDouble(SpreadRate);
                double Reserve = 0;
                if (ReserveRate != null && ReserveRate.ToString() != "")
                    Reserve = Convert.ToDouble(ReserveRate);
                int LagDays = Int32.Parse(NumLagDays.ToString());
                double CumulativeInterest = LIBORModel.GetTotalCompoundedInterestForThePeriod(LoanBalanceAmount, PeriodEffectiveDate, PrincipalPaymentDate, LagDays, YearBasis, ObservationShift, Spread, Reserve, MinBaseRate, MaxBaseRate);
                double InterestDue1 = (Convert.ToDouble(PrincipalPaymentAmount) / Convert.ToDouble(LoanBalanceAmount)) * CumulativeInterest;
                double InterestDue = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(InterestDue1, 4);
                return InterestDue;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

        /// <summary>
        /// This function is is used to get Daily Interest on Prepayment (Interest on Sub Entity).
        /// </summary>
        /// <param name="LoanBalanceAmount"></param>
        /// <param name="PeriodEffectiveDate"></param>
        /// <param name="PrincipalPaymentAmount"></param>
        /// <param name="PrincipalPaymentDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <returns>DailyRFRInterestOnPrepayment</returns>
        /// <example>        
        /// double InterestForSubEntityPeriod=LIBORModel.GetDailyRFRInterestOnPrepayment("2000000000","10/24/18","500000000","11/08/18",5,"Actual/360");
        /// </example>
        //[Counter("GetDailyRFRInterestOnPrepayment")]
        public static double GetDailyRFRInterestOnPrepayment(string LoanBalanceAmount, string PeriodEffectiveDate, string PrincipalPaymentAmount, string PrincipalPaymentDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 16)
        {
            try
            {
                int LagDays = Int32.Parse(NumLagDays.ToString());
                double MinBaseRate = 0;
                if (MinimumBaseRate != null && MinimumBaseRate.ToString() != "")
                    MinBaseRate = Convert.ToDouble(MinimumBaseRate);
                double MaxBaseRate = 99;
                if (MaximumBaseRate != null && MaximumBaseRate.ToString() != "")
                    MaxBaseRate = Convert.ToDouble(MaximumBaseRate);
                double Spread = 0;
                if (SpreadRate != null && SpreadRate.ToString() != "")
                    Spread = Convert.ToDouble(SpreadRate);
                double Reserve = 0;
                if (ReserveRate != null && ReserveRate.ToString() != "")
                    Reserve = Convert.ToDouble(ReserveRate);
                double InterestDue = LIBORModel.GetCompoundedInterestDueAmount(LoanBalanceAmount, PeriodEffectiveDate, PrincipalPaymentAmount, PrincipalPaymentDate, LagDays, YearBasis, ObservationShift, Spread, Reserve, MinBaseRate, MaxBaseRate);
                string PaymentPeriodEndDate = LIBORModel.GetAccrualEndDate(PrincipalPaymentDate);
                double AnnualizedNCCR = LIBORModel.GetAnnualizedNCCR(PrincipalPaymentDate, PaymentPeriodEndDate, LagDays, YearBasis, ObservationShift, MinBaseRate, MaxBaseRate, DecimalPrecision, RoundingPrecision);
                int PeriodDays = LIBORModel.GetCalendarDays(PrincipalPaymentDate, PaymentPeriodEndDate);
                string ActualYearBasis = YearBasis;
                if (YearBasis.Contains("/"))
                {
                    string[] YBasis1 = YearBasis.Split('/');
                    ActualYearBasis = YBasis1[1];
                }
                double DailyRFRInterestOnPrepayment1 = ((InterestDue * AnnualizedNCCR * PeriodDays) / Int32.Parse(ActualYearBasis)) / 100;
                double DailyRFRInterestOnPrepayment = WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(DailyRFRInterestOnPrepayment1, 2);
                return DailyRFRInterestOnPrepayment;
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }
        /// <summary>
        /// To get the Total Loan Interest for the period
        /// </summary>
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartOrPreviousRateSetDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="NextRatePeriodBusinessDayAdjustment"></param>
        /// <returns>-1/TotalInterest</returns>
        /// <example>
        /// double TotalnvoiceAmount1 = LIBORModel.GetTotalCompoundedInterestForThePeriodOfLoan("25000", "8/30/18", "10/01/18", "MONTHLY", "11/30/18", 5, "ACTUAL/360", "YES", 2, 2, 0, 99);
        /// </example>
        //[Counter("GetTotalCompoundedInterestForThePeriodOfLoan")]
        public static double GetTotalCompoundedInterestForThePeriodOfLoan(string PrincipalAmount, string AccrualStartOrPreviousRateSetDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 16, string NextRatePeriodBusinessDayAdjustment = "MODIFIED FOLLOWING")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                if (AccrualStartOrPreviousRateSetDate == "" || PrincipalAmount == "" || NextRatePeriodDate == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                double LN1InvoiceAmount1 = 0;
                bool DoLoop = true;
                do
                {
                    if (appHandle.IsDateGreaterOrEqual(NextRatePeriodDate, TargetDate) == true)
                    {
                        NextRatePeriodDate = TargetDate;
                        DoLoop = false;
                    }

                    double LN1InvoiceAmount = LIBORModel.GetTotalCompoundedInterestForThePeriod(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision);
                    LN1InvoiceAmount1 = LN1InvoiceAmount + LN1InvoiceAmount1;
                    AccrualStartOrPreviousRateSetDate = NextRatePeriodDate;
                    switch (Frequency.ToUpper())
                    {
                        case "MONTHLY":
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NextRatePeriodDate, "m", 1);
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NextRatePeriodDate, NextRatePeriodBusinessDayAdjustment);// Data.Get("GLOBAL_NRP_BUSINESS_DATE_OPTION"));
                            break;
                        case "WEEKLY":
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NextRatePeriodDate, "D", 7);
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NextRatePeriodDate, Data.Get("GLOBAL_INVALID_BUSINESS_DAY_ACTION"));
                            break;
                        default:
                            break;
                    }
                }
                while (DoLoop == true);

                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(LN1InvoiceAmount1, 2);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

        /// <summary>
        /// To Calculate Compounded Interest Due Amount For Principal PrePayment
        /// </summary>
        /// <param name="PrincipalAmount"></param>
        /// <param name="PrincipalPrePayemntAmount"></param>
        /// <param name="AccrualStartOrPreviousRateSetDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="NextRatePeriodBusinessDayAdjustment"></param>
        /// <returns>-1/TotalInterest</returns>
        /// <example>
        /// double TotalnvoiceAmount3 = LIBORModel.CalculateInterestDueAmountForRFRPrincipalPrePayment("25000", "15000", "2/20/19", "3/20/19", "MONTHLY", "4/27/19", "5", "ACTUAL/360", "NO");
        /// </example>
        //[Counter("CalculateInterestDueAmountForRFRPrincipalPrePayment")]
        public static double CalculateInterestDueAmountForRFRPrincipalPrePayment(string PrincipalAmount, string PrincipalPrePayemntAmount, string AccrualStartOrPreviousRateSetDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", string ObservationShift = "YES", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 16, string NextRatePeriodBusinessDayAdjustment = "MODIFIED FOLLOWING")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string CurrentSystemDate = Data.Fetch("ServicingLogin", "ApplicationProcessDate");
                if (AccrualStartOrPreviousRateSetDate == "" || PrincipalAmount == "" || PrincipalPrePayemntAmount == "" || NextRatePeriodDate == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                double LN1InvoiceAmount1 = 0;
                bool DoLoop = true;
                double LN1InvoiceAmount = 0;
                do
                {
                    if (appHandle.IsDateGreaterOrEqual(NextRatePeriodDate, TargetDate) == true || appHandle.IsDateGreaterOrEqual(NextRatePeriodDate, CurrentSystemDate) == true)
                    {
                        if (appHandle.IsDateGreater(NextRatePeriodDate, TargetDate) == true)
                        {
                            NextRatePeriodDate = TargetDate;
                            DoLoop = false;
                            LN1InvoiceAmount = LIBORModel.GetTotalCompoundedInterestForThePeriod(PrincipalPrePayemntAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision);
                        }
                        else
                        {
                            NextRatePeriodDate = TargetDate;
                            DoLoop = false;
                            LN1InvoiceAmount = LIBORModel.GetTotalCompoundedInterestForThePeriod(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision);
                        }
                    }
                    else
                    {
                        LN1InvoiceAmount = LIBORModel.GetTotalCompoundedInterestForThePeriod(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, NumLagDays, YearBasis, ObservationShift, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision);
                    }
                    LN1InvoiceAmount1 = LN1InvoiceAmount + LN1InvoiceAmount1;
                    AccrualStartOrPreviousRateSetDate = NextRatePeriodDate;
                    switch (Frequency.ToUpper())
                    {
                        case "MONTHLY":
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NextRatePeriodDate, "m", 1);
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NextRatePeriodDate, NextRatePeriodBusinessDayAdjustment);// Data.Get("GLOBAL_NRP_BUSINESS_DATE_OPTION"));
                            break;
                        case "WEEKLY":
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NextRatePeriodDate, "D", 7);
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NextRatePeriodDate, Data.Get("GLOBAL_INVALID_BUSINESS_DAY_ACTION"));
                            break;
                        default:
                            break;
                    }
                }
                while (DoLoop == true);

                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(LN1InvoiceAmount1, 2);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

        /// <summary>
        /// To Calculate Simple Interest Due Amount For Principal PrePayment
        /// </summary>
        /// <param name="PrincipalAmount"></param>
        /// <param name="PrincipalPrePayemntAmount"></param>
        /// <param name="AccrualStartOrPreviousRateSetDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="NextRatePeriodBusinessDayAdjustment"></param>
        /// <returns>-1/TotalInterest</returns>
        /// <example>
        /// double TotalnvoiceAmount3 = LIBORModel.CalculateInterestDueAmountForSimplePrincipalPrePayment("25000", "15000", "2/20/19", "3/20/19", "MONTHLY", "4/27/19", "5", "ACTUAL/360", "NO");
        /// </example>
        //[Counter("CalculateInterestDueAmountForSimplePrincipalPrePayment")]
        public static double CalculateInterestDueAmountForSimplePrincipalPrePayment(string PrincipalAmount, string PrincipalPrePayemntAmount, string AccrualStartOrPreviousRateSetDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null, int RoundingPrecision = 2, object PercentageOf = null, string CalculationMethod = "BASE + SPREAD + RESERVES", string NextRatePeriodBusinessDayAdjustment = "MODIFIED FOLLOWING")
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string CurrentSystemDate = Data.Fetch("ServicingLogin", "ApplicationProcessDate");
                if (AccrualStartOrPreviousRateSetDate == "" || PrincipalAmount == "" || PrincipalPrePayemntAmount == "" || NextRatePeriodDate == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                double LN1InvoiceAmount1 = 0;
                bool DoLoop = true;
                double LN1InvoiceAmount = 0;
                do
                {
                    if (appHandle.IsDateGreaterOrEqual(NextRatePeriodDate, TargetDate) == true || appHandle.IsDateGreaterOrEqual(NextRatePeriodDate, CurrentSystemDate) == true)
                    {
                        if (appHandle.IsDateGreater(NextRatePeriodDate, TargetDate) == true)
                        {
                            NextRatePeriodDate = TargetDate;
                            DoLoop = false;
                            LN1InvoiceAmount = LIBORModel.GetTotalSimpleInterestForThePeriod(PrincipalPrePayemntAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, RoundingPrecision, PercentageOf, CalculationMethod);
                        }
                        else
                        {
                            NextRatePeriodDate = TargetDate;
                            DoLoop = false;
                            LN1InvoiceAmount = LIBORModel.GetTotalSimpleInterestForThePeriod(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, RoundingPrecision, PercentageOf, CalculationMethod);
                        }
                    }
                    else
                    {
                        LN1InvoiceAmount = LIBORModel.GetTotalSimpleInterestForThePeriod(PrincipalAmount, AccrualStartOrPreviousRateSetDate, NextRatePeriodDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate, RoundingPrecision, PercentageOf, CalculationMethod);
                    }
                    LN1InvoiceAmount1 = LN1InvoiceAmount + LN1InvoiceAmount1;
                    AccrualStartOrPreviousRateSetDate = NextRatePeriodDate;
                    switch (Frequency.ToUpper())
                    {
                        case "MONTHLY":
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NextRatePeriodDate, "m", 1);
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NextRatePeriodDate, NextRatePeriodBusinessDayAdjustment);// Data.Get("GLOBAL_NRP_BUSINESS_DATE_OPTION"));
                            break;
                        case "WEEKLY":
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NextRatePeriodDate, "D", 7);
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NextRatePeriodDate, Data.Get("GLOBAL_INVALID_BUSINESS_DAY_ACTION"));
                            break;
                        default:
                            break;
                    }
                }
                while (DoLoop == true);

                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(LN1InvoiceAmount1, 2);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

        /// <summary>
        /// To calculate the Get Total Simple Interest For The Period Of Loan
        /// </summary>
        /// <param name="PrincipalAmount"></param>
        /// <param name="AccrualStartDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="SpreadRate"></param>
        /// <param name="ReserveRate"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <returns></returns>
        //[Counter("GetTotalSimpleInterestForThePeriodOfLoan")]
        public static double GetTotalSimpleInterestForThePeriodOfLoan(string PrincipalAmount, string AccrualStartDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", object SpreadRate = null, object ReserveRate = null, object MinimumBaseRate = null, object MaximumBaseRate = null)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                if (AccrualStartDate == "" || PrincipalAmount == "" || NextRatePeriodDate == "" || Frequency == "" || TargetDate == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                double LN1InvoiceAmount1 = 0;
                bool DoLoop = true;
                do
                {
                    if (appHandle.IsDateGreaterOrEqual(NextRatePeriodDate, TargetDate) == true)
                    {
                        NextRatePeriodDate = TargetDate;
                        DoLoop = false;
                    }

                    double LN1InvoiceAmount = GetTotalSimpleInterestForThePeriod(PrincipalAmount, AccrualStartDate, NextRatePeriodDate, NumLagDays, YearBasis, SpreadRate, ReserveRate, MinimumBaseRate, MaximumBaseRate);
                    LN1InvoiceAmount1 = LN1InvoiceAmount + LN1InvoiceAmount1;
                    AccrualStartDate = NextRatePeriodDate;
                    switch (Frequency.ToUpper())
                    {
                        case "MONTHLY":
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NextRatePeriodDate, "m", 1);
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NextRatePeriodDate, Data.Get("GLOBAL_NRP_BUSINESS_DATE_OPTION"));
                            break;
                        case "WEEKLY":
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NextRatePeriodDate, "w", 1);
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NextRatePeriodDate, Data.Get("GLOBAL_INVALID_BUSINESS_DAY_ACTION"));
                            break;
                        default:
                            break;
                    }
                }
                while (DoLoop == true);

                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(LN1InvoiceAmount1, 2);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

        /// <summary>
        /// To calculate the Get Total Simple Interest For The Period Of Loan
        /// </summary>
        /// <param name="AccrualStartDate"></param>
        /// <param name="NextRatePeriodDate"></param>
        /// <param name="Frequency"></param>
        /// <param name="TargetDate"></param>
        /// <param name="NumLagDays"></param>
        /// <param name="YearBasis"></param>
        /// <param name="ObservationShift"></param>
        /// <param name="RoundingPrecision"></param>
        /// <param name="MinimumBaseRate"></param>
        /// <param name="MaximumBaseRate"></param>
        /// <param name="DecimalPrecision"></param>
        /// <param name="RoundingPrecision"></param>
        /// <returns></returns>
        //[Counter("GetAnnualizedNCCROfLoan")]
        public static double GetAnnualizedNCCROfLoan(string AccrualStartDate, string NextRatePeriodDate, string Frequency, string TargetDate, object NumLagDays, string YearBasis = "ACTUAL/360", String ObservationShift = "YES", object MinimumBaseRate = null, object MaximumBaseRate = null, int DecimalPrecision = 8, int RoundingPrecision = 8)
        {
            try
            {
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                if (AccrualStartDate == "" || NextRatePeriodDate == "" || Frequency == "" || (NumLagDays.ToString()) == "" || YearBasis == "")
                    return -1;
                bool DoLoop = true;
                double AnnualizedNCCR = 0;
                do
                {
                    if (appHandle.IsDateGreaterOrEqual(NextRatePeriodDate, TargetDate) == true)
                    {
                        NextRatePeriodDate = TargetDate;
                        DoLoop = false;
                        AnnualizedNCCR = GetAnnualizedNCCR(AccrualStartDate, NextRatePeriodDate, NumLagDays, YearBasis, ObservationShift, MinimumBaseRate, MaximumBaseRate, DecimalPrecision, RoundingPrecision);
                    }
                    AccrualStartDate = NextRatePeriodDate;
                    switch (Frequency.ToUpper())
                    {
                        case "MONTHLY":
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NextRatePeriodDate, "m", 1);
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NextRatePeriodDate, Data.Get("GLOBAL_NRP_BUSINESS_DATE_OPTION"));
                            break;
                        case "WEEKLY":
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.CalculateNewDate(NextRatePeriodDate, "w", 1);
                            NextRatePeriodDate = WebLinkUtility.WebLinkUtilityLibrary.GetBusinessDate(NextRatePeriodDate, Data.Get("GLOBAL_INVALID_BUSINESS_DAY_ACTION"));
                            break;
                        default:
                            break;
                    }
                }
                while (DoLoop == true);

                return WebLinkUtility.WebLinkUtilityLibrary.RoundOffValue(AnnualizedNCCR, DecimalPrecision);
            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e.Message);
            }
            return -1;
        }

    }


}
namespace WebLink.Utils

{
    /// <summary>
    /// To use update category in scripts.
    /// </summary>
    public static class GeneralUtility
    {
        public static string SingleFileScripts = "";

        //Example:  GeneralUtility.GetScriptsQAI(@"D:\Extract\Scripts\", @"D:\Extract\Scripts\");
        public static void GetScriptsQAI(string ScriptsPath, string QAIOutPutPath)
        {
            string[] parentDirectory = Directory.GetDirectories(ScriptsPath);
            string dictionarystring = "";
            for (int i = 0; i < parentDirectory.Length; i++)
            {
                string lastFolderName = Path.GetFileName(parentDirectory[i]);
                dictionarystring = dictionarystring + ";" + "#########################################################################################################################################################################################";
                dictionarystring = dictionarystring + ";" + "";
                dictionarystring = dictionarystring + ";" + "---------------------------------------@@@ Functional Area: " + lastFolderName + "  @@@---------------------------------------";
                string[] fileArray = Directory.GetFiles(parentDirectory[i]);

                for (int j = 0; j < fileArray.Length; j++)
                {

                    string[] lines = File.ReadAllLines(fileArray[j]);
                    int num = 0;
                    dictionarystring = dictionarystring + ";" + "";
                    dictionarystring = dictionarystring + ";" + "#########################################################################################################################################################################################";
                    for (int k = 0; k < lines.Length; k++)
                    {
                        string linestring = lines[k].ToUpper();
                        if (linestring.IndexOf("SCRIPT") != -1 || linestring.IndexOf("OBJECTIVE") != -1 || linestring.IndexOf("CONDITION") != -1 || linestring.IndexOf("REPORT.STEP") != -1)
                        {

                            if (linestring.IndexOf("REPORT.STEP") != -1)
                            {
                                num = num + 1;
                                if (num == 1)
                                {
                                    dictionarystring = dictionarystring + ";" + "#########################################################################################################################################################################################";
                                    dictionarystring = dictionarystring + ";" + "";
                                }
                                string Newline = lines[k].Replace("\t", "").Replace("Report.Step", "").Replace(@"""", "").Replace(";", "");
                                int Place = Newline.IndexOf("(");
                                Newline = Newline.Remove(Place, 1).Insert(Place, "");
                                Place = Newline.LastIndexOf(")");
                                Newline = Newline.Remove(Place, 1).Insert(Place, "");
                                Newline = num + "." + Newline;
                                dictionarystring = dictionarystring + ";" + Newline;
                            }

                            else if (linestring.IndexOf("CONDITION") != -1 && linestring.IndexOf("//") != -1)
                            {
                                int Precondition = k + 50;
                                for (int l = k; l < Precondition; l++)
                                {
                                    if (lines[l].IndexOf("using") != -1 && lines[l].IndexOf("//") == -1)
                                    {
                                        k = l;
                                        break;
                                    }
                                    if (lines[l].IndexOf("#########################") == -1 && lines[l].IndexOf("//") != -1)
                                        dictionarystring = dictionarystring + ";" + lines[l];
                                }

                            }
                            else if (linestring.IndexOf(":") != -1 && linestring.IndexOf("//") != -1)
                            {
                                dictionarystring = dictionarystring + ";" + lines[k];
                            }
                        }


                    }

                }
            }
            string path = QAIOutPutPath + "\\QAIWithPreCondion.txt";
            if (File.Exists(path))
            {
                File.Delete(path);
            }
            using (StreamWriter sw = File.CreateText(path))
            {
                string result = dictionarystring.Replace(";", "\r\n").Replace(".            ", ". ");
                sw.WriteLine(result);
            }
        }
        /// <summary>
        /// This method is used to Get Common Table Data used in Inputfile and scripts.
        /// </summary>
        /// <param name="CommonTableDataFileName"></param>
        /// <param name="ServicingDataFileName"></param> 
        /// <param name="ScriptsPath"></param>
        /// <returns>Table Data</returns>
        /// <example>
        // string CommonTableDataFileName = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\InputData\\" + "DataFile_TableValues" + ".csv";
        // string ServicingDataFileName = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\InputData\\" + "DataFile_Servicing_UseCase" + ".csv";
        // string ScriptsPath = StartupConfiguration.EnvironmentDetails.ProjectPath + "\\TestScripts\\Tests\\Use Case Suite";
        // Example : GeneralUtility.GetTableDataUsedInInputDataFileAndScripts(CommonTableDataFileName, ServicingDataFileName, ScriptsPath);
        /// </example>
        //[Counter("GetTableDataUsedInInputDataFileAndScripts")]
        public static string GetTableDataUsedInInputDataFileAndScripts(string CommonTableDataFileName, string ServicingDataFileName, string ScriptsPath)
        {
            try
            {
                string KeyReplacedDataFileName = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\OutputData\\" + "DataFile_Output" + ".csv";
                string[] ParentScriptsDirectory = Directory.GetDirectories(ScriptsPath);
                int loopLength = ParentScriptsDirectory.Length;
                string[] fileArray = null;
                if (loopLength == 0)
                    loopLength = 1;
                string[] CommonTableData = File.ReadAllLines(CommonTableDataFileName);
                string[] ServicingDataLines = File.ReadAllLines(ServicingDataFileName);
                string ServicingDataText = File.ReadAllText(ServicingDataFileName);

                string KeysUsedinServicingDataFile = "Details,Data Set 1";
                bool found = false;

                if (File.Exists(KeyReplacedDataFileName) == true)
                {
                    File.Delete(KeyReplacedDataFileName);
                }
                for (int i = 1; i < CommonTableData.Length; i++)
                {
                    found = false;
                    string[] OldKeyName = CommonTableData[i].Split(',');
                    if (OldKeyName[0] != "")
                    {
                        if (OldKeyName[0].IndexOf("-----") != -1)
                        {
                            KeysUsedinServicingDataFile = KeysUsedinServicingDataFile + "\r\n" + CommonTableData[i];
                        }
                        else if (ServicingDataText.IndexOf(";" + OldKeyName[0]) != -1 || ServicingDataText.IndexOf("," + OldKeyName[0]) != -1)
                        {
                            KeysUsedinServicingDataFile = KeysUsedinServicingDataFile + "\r\n" + CommonTableData[i];
                        }
                        else
                        {

                            if (SingleFileScripts == "")
                            {

                                for (int isloop = 0; isloop < loopLength; isloop++)
                                {
                                    if (loopLength == 1)
                                        fileArray = Directory.GetFiles(ScriptsPath);
                                    else
                                        fileArray = Directory.GetFiles(ParentScriptsDirectory[isloop]);
                                    for (int jLoop = 0; jLoop < fileArray.Length; jLoop++)
                                    {
                                        string lines = File.ReadAllText(fileArray[jLoop]);
                                        SingleFileScripts = SingleFileScripts + "\r\n" + lines;
                                    }

                                }
                            }
                            if (SingleFileScripts.IndexOf(OldKeyName[0]) != -1)
                            {
                                KeysUsedinServicingDataFile = KeysUsedinServicingDataFile + "\r\n" + CommonTableData[i];
                                found = true;
                            }
                        }
                    }
                }
                using (StreamWriter sw = File.CreateText(KeyReplacedDataFileName))
                {
                    sw.WriteLine(KeysUsedinServicingDataFile);
                }
                return KeyReplacedDataFileName;

            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e);
            }
            return null;

        }
        /// <summary>
        /// This method is used to Get Common Table Data used in scripts.
        /// </summary>
        /// <param name="CommonTableDataFileName"></param>
        /// <param name="ServicingDataFileName"></param> 
        /// <param name="ScriptsPath"></param>
        /// <returns>Table Data</returns>
        /// <example>
        // string CommonTableDataFileName = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\InputData\\" + "DataFile_TableValues" + ".csv";
        // string ScriptsPath = StartupConfiguration.EnvironmentDetails.ProjectPath + "\\TestScripts\\Tests\\Use Case Suite";
        // Example : GeneralUtility.GetCommonTableDataUsedInScripts(CommonTableDataFileName, ServicingDataFileName, ScriptsPath);
        /// </example>
        //[Counter("GetCommonTableDataUsedInScripts")]
        public static string GetCommonTableDataUsedInScripts(string CommonTableDataFileName, string ScriptsPath)
        {
            try
            {
                string KeyReplacedDataFileName = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\OutputData\\" + "DataFile_Output" + ".csv";
                string[] ParentScriptsDirectory = Directory.GetDirectories(ScriptsPath);


                string[] CommonTableData = File.ReadAllLines(CommonTableDataFileName);
                string KeysUsedinServicingDataFile = "Details,Data Set 1";
                bool found = false;
                if (File.Exists(KeyReplacedDataFileName) == true)
                {
                    File.Delete(KeyReplacedDataFileName);
                }
                for (int i = 1; i < CommonTableData.Length; i++)
                {
                    found = false;
                    string[] OldKeyName = CommonTableData[i].Split(',');
                    if (OldKeyName[0] != "")
                    {
                        if (OldKeyName[0].IndexOf("-----") != -1)
                        {
                            KeysUsedinServicingDataFile = KeysUsedinServicingDataFile + "\r\n" + CommonTableData[i];
                        }
                        else
                        {

                            for (int isloop = 0; isloop < ParentScriptsDirectory.Length; isloop++)
                            {
                                string[] fileArray = Directory.GetFiles(ParentScriptsDirectory[isloop]);
                                for (int jLoop = 0; jLoop < fileArray.Length; jLoop++)
                                {
                                    string lastFileName = Path.GetFileName(fileArray[jLoop]);
                                    string lines = File.ReadAllText(fileArray[jLoop]);
                                    if (lines.IndexOf(OldKeyName[0]) != -1)
                                    {
                                        KeysUsedinServicingDataFile = KeysUsedinServicingDataFile + "\r\n" + CommonTableData[i] + " Script Name: " + lastFileName;
                                        found = true;
                                        break;
                                    }

                                }

                                if (found == true)
                                    break;
                            }

                        }
                    }
                }
                using (StreamWriter sw = File.CreateText(KeyReplacedDataFileName))
                {
                    sw.WriteLine(KeysUsedinServicingDataFile);
                }
                return KeyReplacedDataFileName;

            }
            catch (Exception e)
            {
                Report.Info("Exception Logged:" + e);
            }
            return null;

        }
        /// <summary>
        /// This method is used to Verify Common Table Data.
        /// </summary>
        /// <param name="CommonTableDataFileName"></param>
        /// <param name="ServicingDataFileName"></param> 
        /// <param name="ScriptsPath"></param>
        /// <returns>None</returns>
        /// <example>
        // string CommonTableDataFileName = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\InputData\\" + "DataFile_TableValues" + ".csv";
        // string ServicingDataFileName = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\InputData\\" + "DataFile_Servicing_UseCase" + ".csv";
        // string ScriptsPath = StartupConfiguration.EnvironmentDetails.ProjectPath + "\\TestScripts\\Tests\\Use Case Suite";
        // Example : GeneralUtility.VerifyCommonTableData(CommonTableDataFileName, ServicingDataFileName, ScriptsPath);
        /// </example>
        //[Counter("VerifyCommonTableData")]
        public static void VerifyCommonTableData(string CommonTableDataFileName, string ServicingDataFileName, string ScriptsPath)
        {
            try
            {
                WindowsApplication appHandle;
                appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
                string KeyReplacedDataFileName = GetTableDataUsedInInputDataFileAndScripts(CommonTableDataFileName, ServicingDataFileName, ScriptsPath);
                string CommonTableData = File.ReadAllText(KeyReplacedDataFileName);
                string NotValidTableItem = "";
                bool AllPass = true;
                string[] TableIDsArray = CommonTableData.Split(new string[] { "'T" }, StringSplitOptions.None);
                for (int i = 1; i < (TableIDsArray.Length); i++)
                {
                    string TableIDString = TableIDsArray[i];
                    string[] TableID = TableIDString.Split(new string[] { "\r\n" }, StringSplitOptions.None);
                    string[] TableValues = TableIDString.Split(' ');
                    string ActualTableID = "T" + TableValues[0];
                    if (TableID.Length > 2)
                    {
                        NotValidTableItem = "";
                        string[,] TotalNoOfRecords1 = null;
                        //  Application.ACBSDBLibrary.GetTableDataForSpeciedTableID(ActualTableID, "J$NAFT^J$NAGT");//  dbApplication.GetDataFromTable("select J$NAFT,J$NAGT from D1BSDTAPIT.J$CTDE where J$NADI = '" + ActualTableID + "'");
                        int TotalRecordsLength = TotalNoOfRecords1.GetUpperBound(0);
                        for (int j = 1; j < (TableID.Length - 1); j++)
                        {
                            bool TableVerification = false;
                            string[] GlobalTableValues = TableID[j].Split(',');
                            string GlobalTableValue = GlobalTableValues[1];
                            if (TotalRecordsLength != -1)
                            {
                                for (int k = 0; k <= (TotalNoOfRecords1.GetUpperBound(0)); k++)
                                {
                                    if (TotalNoOfRecords1[k, 0].ToString().ToUpper().IndexOf(GlobalTableValue.ToString().ToUpper()) == 0 || (TotalNoOfRecords1[k, 1].ToString().ToUpper().IndexOf(GlobalTableValue.ToString().ToUpper()) == 0))
                                    {
                                        TableVerification = true;
                                        break;
                                    }
                                }
                            }
                            if (TableVerification == false)
                            {
                                NotValidTableItem = GlobalTableValue + ',' + NotValidTableItem;
                            }
                        }
                        if (NotValidTableItem.Length > 1)
                        {
                            NotValidTableItem = NotValidTableItem.Remove(NotValidTableItem.Length - 1, 1);
                            try
                            {
                                if (TotalRecordsLength != -1)
                                    Report.Fail("Common Table ID: " + ActualTableID + " – Required Value(s): " + NotValidTableItem.Replace(",", ", ") + " missing.", "True", appHandle);
                                else
                                    Report.Fail("Common Table ID: " + ActualTableID + " – Does not have any data and Following entries needs to be inserted: " + NotValidTableItem.Replace(",", ", ") + ".", "True", appHandle);

                            }
                            catch (Exception e) { string ExceptionMessage = e.Message; }
                            AllPass = false;
                        }
                        // else
                        // {
                        //     try
                        //     {
                        //         Reporter.Pass("Data Base Table ID : " + ActualTableID + " of the common table data: " + NotValidTableItem + " is present.", "True", appHandle);
                        //     }
                        //     catch (Exception e) { string ExceptionMessage = e.Message;}
                        // }
                    }
                }
                if (AllPass == true)
                {
                    try
                    {
                        Reporter.Pass("Completed the verification of common table data used by auto scripts and input data files in test environment.", "True", appHandle);
                    }
                    catch (Exception e) { string ExceptionMessage = e.Message; }
                }

            }
            catch (Exception e)
            {
                Report.Fail("Exception Logged:" + e, false, true);
            }

        }

        /// <summary>
        /// This method is used to get the windows names and method names.
        /// </summary>
        /// <param name="RepositoryPath"></param>
        /// <param name="OutputFilePath"></param> 
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.GetWindowsAndMethodNames();
        /// </example>
        //[Counter("GetWindowsAndMethodNames")]

        public static void GetWindowsAndMethodNames(string RepositoryPath, string OutputFilePath)
        {
            string[] filePaths = Directory.GetFiles(RepositoryPath, "*.cs");

            string dictionarystring = "";

            for (int i = 0; i < filePaths.Length; i++)
            {

                string[] lines = File.ReadAllLines(filePaths[i].ToString());
                foreach (string line in lines)
                {
                    if (line != null && line != "")
                        if (line.IndexOf("public") != -1 && line.IndexOf("(") != -1 && line.IndexOf("=") == -1 || line.IndexOf("public class") != -1)
                        {

                            dictionarystring = dictionarystring + ";" + line;
                        }
                }
            }

            if (!File.Exists(OutputFilePath))
            {
                using (StreamWriter sw = File.CreateText(OutputFilePath))
                {
                    string result = dictionarystring.Replace(";", "\r\n");
                    sw.WriteLine(result);
                }
            }
        }
        /// <summary>
        /// This method is used to add the category to the scripts.
        /// </summary>
        /// <param name="ScriptsPath"></param>
        /// <param name="CategoryCsvPath"></param> 
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.AddCategoryToScripts();
        /// </example>
        //[Counter("AddCategoryToScripts")]
        public static void AddCategoryToScripts(string ScriptsPath, string CategoryCsvPath)
        {
            RemoveCategory(ScriptsPath, CategoryCsvPath);
            AddCategory(ScriptsPath, CategoryCsvPath);
        }
        public static void AddCategory(string ScriptsPath, string CategoryCsvPath)
        {
            string[] Categorylines = File.ReadAllLines(CategoryCsvPath);
            string InvalidScriptspath = ScriptsPath + "\\InvalidScripts.txt";
            string InvalidScripts = "";
            for (int k = 1; k < Categorylines.Length; k++)
            {
                string[] ActualScriptCategory = Categorylines[k].Split(',');
                string[] parentDirectory = Directory.GetDirectories(ScriptsPath);
                bool FileNotFoundException = false;
                for (int i = 0; i < parentDirectory.Length; i++)
                {
                    string[] fileArray = Directory.GetFiles(parentDirectory[i]);
                    for (int j = 0; j < fileArray.Length; j++)
                    {
                        if (fileArray[j].ToString().IndexOf("\\" + ActualScriptCategory[1]) != -1)
                        {
                            var sb = new StringBuilder();
                            using (var sr = new StreamReader(fileArray[j]))
                            {
                                string line;
                                do
                                {
                                    line = sr.ReadLine();
                                    sb.AppendLine(line);

                                } while (line.ToLower().IndexOf("testdescription") == -1 && line.ToLower().IndexOf("property") == -1);
                                for (int s = 2; s < ActualScriptCategory.Length; s++)
                                {
                                    if (ActualScriptCategory[s] != "")
                                    {
                                        sb.AppendLine("        [Category(\"" + ActualScriptCategory[s] + "\")]");
                                    }
                                }
                                sb.Append(sr.ReadToEnd());

                            }

                            using (var sr = new StreamWriter(fileArray[j]))
                            {
                                sr.Write(sb.ToString());
                            }
                            FileNotFoundException = true;
                            break;
                        }
                        if (FileNotFoundException)
                            break;
                    }
                    if (FileNotFoundException)
                        break;
                    else if (FileNotFoundException == false && (i + 1) == parentDirectory.Length)
                        InvalidScripts = ActualScriptCategory[1].Replace(".cs", "") + "\r\n" + InvalidScripts;
                }
            }
            if (InvalidScripts != "")
            {
                if (File.Exists(InvalidScriptspath))
                {
                    File.Delete(InvalidScriptspath);
                }
                using (StreamWriter sw = File.CreateText(InvalidScriptspath))
                {
                    string result = InvalidScripts;
                    sw.WriteLine(result);
                    System.Windows.Forms.MessageBox.Show("Check for invalid Scripts in: " + InvalidScriptspath, "InvalidScripts", System.Windows.Forms.MessageBoxButtons.OK, System.Windows.Forms.MessageBoxIcon.Error);
                }
            }
        }
        public static List<String> DirSearch(string sDir)
        {
            List<String> files = new List<String>();
            try
            {
                foreach (string f in Directory.GetFiles(sDir))
                {
                    files.Add(f);
                }
                foreach (string d in Directory.GetDirectories(sDir))
                {
                    files.AddRange(DirSearch(d));
                }
            }
            catch (Exception e)
            {
                string ExceptionMessage = e.Message;
            }

            return files;
        }
        /// <summary>
        /// This method is used to execute yml Batch file.
        /// </summary>
        /// <param name="BatchNumbers"></param>
        /// <param name="ScriptsPath"></param>
        /// <param name="CategoryCsvPath"></param>
        /// <param name="SequenceRange"></param>
        /// <param name="ProjectPath"></param>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.ExecuteYmlBatchFile();
        /// </example>
        //[Counter("ExecuteYmlBatchFile")]
        public static void ExecuteYmlBatchFile(string CategoryCsvPath, string ScriptsPath, object BatchNumbers, string SequenceRange = null, string ProjectPath = null)
        {
            WindowsApplication appHandle;
            appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
            string InvalidScriptspath = ScriptsPath + "\\InvalidScripts.txt";
            string InvalidScripts = "";
            string BatchNumber = "," + BatchNumbers.ToString();
            string[] NumberOfBathes = BatchNumber.Split(',');
            SequenceRange = "," + SequenceRange;
            string YmlPath = ScriptsPath + "\\ExecuteYml.yml";
            string BatchYmlPath = ScriptsPath + "\\BatchYml.bat";
            string ResultsYmlPath = ScriptsPath + "\\Results.txt";
            string[] Batchlines = File.ReadAllLines(CategoryCsvPath);
            if (File.Exists(YmlPath))
            {
                File.Delete(YmlPath);
            }
            if (File.Exists(BatchYmlPath))
            {
                File.Delete(BatchYmlPath);
            }
            TextWriter ch = new StreamWriter(BatchYmlPath);
            ch.WriteLine("c:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe gats run --file " + "" + YmlPath + " > " + ResultsYmlPath + "" + ";");
            ch.WriteLine("exit");
            ch.Close();
            TextWriter tw = new StreamWriter(YmlPath);
            tw.WriteLine("platform: win-x64");
            tw.WriteLine("projecttype: nunit");
            string PathOfProject1 = "";
            if (ProjectPath == null)
                PathOfProject1 = StartupConfiguration.EnvironmentDetails.ProjectPath;
            else
                PathOfProject1 = ProjectPath;
            string PathOfProject = PathOfProject1.Replace(@"\", "\\\\");
            PathOfProject = PathOfProject.Remove((PathOfProject.Length) - 2, 2);
            tw.WriteLine("projectpath: " + "\"" + PathOfProject + "\"");
            tw.WriteLine("projectexepath: " + "\"" + PathOfProject + "\\\\bin\\\\Debug\\\\net472\\\\win-x64\\\\ACBS.exe\"");
            tw.WriteLine("parallel: false");
            tw.WriteLine("");
            tw.WriteLine("command:");
            tw.Close();
            string[] ColumnsArray = Batchlines[0].Split(',');
            int ScriptColumnNumber = 0;
            int BatchColumnNumber = 0;
            int SequenceColumnNumber = 0;
            int ExecutionColumnNumber = 0;
            int StatusColumnNumber = 0;
            for (int z = 0; z < ColumnsArray.Length; z++)
            {
                if (ColumnsArray[z].ToLower().IndexOf("auto script name") != -1)
                {
                    ScriptColumnNumber = z;
                }
                else if (ColumnsArray[z].ToLower().IndexOf("batch number") != -1)
                {
                    BatchColumnNumber = z;
                }
                else if (ColumnsArray[z].ToLower().IndexOf("sequence number") != -1)
                {
                    SequenceColumnNumber = z;
                }
                else if (ColumnsArray[z].ToLower().IndexOf("execution") != -1)
                {
                    ExecutionColumnNumber = z;
                }

                else if (ColumnsArray[z].ToLower().IndexOf("status") != -1)
                {
                    StatusColumnNumber = z;
                }
            }
            for (int p = 1; p < NumberOfBathes.Length; p++)
            {
                BatchNumber = NumberOfBathes[p];
                string NameSpace = "";
                string ClassName = "";
                string TempravaryFileContent = "";

                List<int> SortOrder = new List<int>();
                for (int s = 1; s < Batchlines.Length; s++)
                {
                    string[] TemparavaryArray = Batchlines[s].Split(',');
                    if (TemparavaryArray[BatchColumnNumber] == BatchNumber && TemparavaryArray[ExecutionColumnNumber].ToUpper() == "YES" && SequenceRange == null)
                    {
                        TempravaryFileContent = TempravaryFileContent + "^" + TemparavaryArray[ScriptColumnNumber] + "," + TemparavaryArray[SequenceColumnNumber];
                        SortOrder.Add(Int32.Parse(TemparavaryArray[SequenceColumnNumber]));
                    }
                    else if (TemparavaryArray[BatchColumnNumber] == BatchNumber && TemparavaryArray[ExecutionColumnNumber].ToUpper() == "YES" && SequenceRange != null)
                    {
                        string[] SortRanges = SequenceRange.Split(',');
                        string[] SortRange = SortRanges[p].Split(' ');
                        if (Int32.Parse(SortRange[0]) <= Int32.Parse(TemparavaryArray[SequenceColumnNumber]) && Int32.Parse(SortRange[2]) >= Int32.Parse(TemparavaryArray[SequenceColumnNumber]))
                        {
                            TempravaryFileContent = TempravaryFileContent + "^" + TemparavaryArray[ScriptColumnNumber] + "," + TemparavaryArray[SequenceColumnNumber];
                            SortOrder.Add(Int32.Parse(TemparavaryArray[SequenceColumnNumber]));
                        }
                    }
                }
                SortOrder.Sort();

                for (int j = 0; j < SortOrder.Count; j++)
                {
                    string[] TempravaryFileContentArray = TempravaryFileContent.Split('^');
                    NameSpace = "";
                    ClassName = "";
                    bool FileNotFoundException = false;
                    for (int k = 1; k < TempravaryFileContentArray.Length; k++)
                    {
                        if (TempravaryFileContentArray[k].IndexOf("," + SortOrder[j].ToString()) != -1)
                        {
                            string[] ScriptNameFromArray = TempravaryFileContentArray[k].Split(',');
                            List<String> fileArray = DirSearch(ScriptsPath);

                            for (int m = 0; m < fileArray.Count; m++)
                            {
                                if (fileArray[m].ToString().IndexOf("\\" + ScriptNameFromArray[ScriptColumnNumber] + ".cs") != -1)
                                {
                                    string[] Scriptlines = File.ReadAllLines(fileArray[m]);

                                    for (int n = 1; n < Scriptlines.Length; n++)
                                    {
                                        if (Scriptlines[n].IndexOf("namespace ") != -1)
                                        {
                                            string[] NameSpaceArray = Scriptlines[n].Split(' ');
                                            NameSpace = NameSpaceArray[1];
                                        }
                                        if (Scriptlines[n].IndexOf("public ") != -1 && Scriptlines[n].IndexOf("class ") != -1 && Scriptlines[n].IndexOf("TestBase") != -1)
                                        {
                                            string[] ClassArray = Scriptlines[n].Split(new string[] { " class " }, StringSplitOptions.None);
                                            ClassName = ClassArray[1].Replace(" ", "").Replace("TestBase", "").Replace(":", "");
                                        }
                                        if (NameSpace != "" && ClassName != "")
                                        {
                                            string[] Arrayline = File.ReadAllLines(YmlPath);
                                            string text = File.ReadAllText(YmlPath);
                                            if (text.IndexOf(NameSpace + "." + ClassName) != -1)
                                            {
                                                for (int h = 0; h < Arrayline.Length; h++)
                                                {
                                                    if (Arrayline[h].IndexOf(NameSpace + "." + ClassName) != -1)
                                                    {
                                                        text = text.Replace(Arrayline[h].ToString(), Arrayline[h].ToString() + ", " + ScriptNameFromArray[ScriptColumnNumber]);
                                                        File.WriteAllText(YmlPath, text);
                                                        break;
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                File.AppendAllText(YmlPath, " " + NameSpace + "." + ClassName + ": " + ScriptNameFromArray[ScriptColumnNumber] + Environment.NewLine);
                                            }
                                            FileNotFoundException = true;
                                            break;
                                        }
                                    }
                                }

                                if (FileNotFoundException)
                                {
                                    break;
                                }
                                else if (FileNotFoundException == false && (m + 1) == fileArray.Count)
                                {
                                    InvalidScripts = ScriptNameFromArray[ScriptColumnNumber] + "\r\n" + InvalidScripts;

                                }

                            }



                        }
                        if (FileNotFoundException)
                        {
                            break;
                        }
                    }
                    TempravaryFileContentArray = null;
                }
            }

            if (InvalidScripts != "")
            {
                if (File.Exists(InvalidScriptspath))
                {
                    File.Delete(InvalidScriptspath);
                }
                using (StreamWriter sw = File.CreateText(InvalidScriptspath))
                {
                    string result = InvalidScripts;
                    sw.WriteLine(result);
                    System.Windows.Forms.MessageBox.Show("Check for invalid Scripts in: " + InvalidScriptspath, "InvalidScripts", System.Windows.Forms.MessageBoxButtons.OK, System.Windows.Forms.MessageBoxIcon.Error);
                    if (File.Exists(YmlPath))
                    {
                        File.Delete(YmlPath);
                    }
                    if (File.Exists(BatchYmlPath))
                    {
                        File.Delete(BatchYmlPath);
                    }

                }
            }
            else
            {
                try
                {
                    appHandle.KillUserProcess("testhost.exe");
                }
                catch (Exception e) { string ExceptionMessage = e.Message; }
                appHandle.RunCommandLineCode(BatchYmlPath, null);
                appHandle.WaitForSpecifiedTime(40);
                Process[] processes = Process.GetProcessesByName("testhost");
                do
                {
                    processes = null;
                    appHandle.WaitForSpecifiedTime(5);
                    processes = Process.GetProcessesByName("testhost");

                } while (processes.Length > 0);


                string[] YmlFileLines = File.ReadAllLines(YmlPath);
                string[] ResultTextArray = File.ReadAllLines(ResultsYmlPath);
                string[] CSVTextArray = File.ReadAllLines(CategoryCsvPath);

                string ResultText = "";
                for (int g = 4; g < ResultTextArray.Length; g++)
                {
                    ResultText = ResultText + ResultTextArray[g];
                }

                for (int k = 1; k < YmlFileLines.Length; k++)
                {
                    if (YmlFileLines[k] != "")
                    {
                        if (YmlFileLines[k].Substring(0, 1) == " ")
                        {
                            string[] ActualClassScripts = YmlFileLines[k].Split(':');
                            ActualClassScripts[1] = "," + ActualClassScripts[1];
                            string[] SingleScriptArray = ActualClassScripts[1].Split(',');
                            for (int ScriptName = 1; ScriptName < SingleScriptArray.Length; ScriptName++)
                            {
                                string ActualScript = SingleScriptArray[ScriptName].Replace(" ", "");
                                for (int q = 1; q < CSVTextArray.Length; q++)
                                {
                                    string[] DevideCSVScript = CSVTextArray[q].Split(',');
                                    if (DevideCSVScript[ScriptColumnNumber] == ActualScript)
                                    {
                                        string ReplaceText = "";
                                        string ExistingText = "";
                                        string[] CSVScriptData = CSVTextArray[q].Split(',');
                                        for (int m = 0; m < CSVScriptData.Length; m++)
                                        {
                                            if (m == StatusColumnNumber)
                                            {
                                                if (ResultText.IndexOf(SingleScriptArray[ScriptName]) != -1)
                                                    ReplaceText = ReplaceText + "," + "Fail";
                                                else
                                                    ReplaceText = ReplaceText + "," + "Pass";
                                            }
                                            else
                                            {
                                                ReplaceText = ReplaceText + "," + CSVScriptData[m];
                                            }
                                            ExistingText = ExistingText + "," + CSVScriptData[m];
                                        }
                                        string text = File.ReadAllText(CategoryCsvPath);
                                        text = text.Replace(ExistingText.Remove(0, 1), ReplaceText.Remove(0, 1));
                                        File.WriteAllText(CategoryCsvPath, text);
                                        break;
                                    }
                                }
                            }

                        }
                    }
                }

                if (File.Exists(YmlPath))
                    File.Delete(YmlPath);
                if (File.Exists(BatchYmlPath))
                    File.Delete(BatchYmlPath);
                if (File.Exists(ResultsYmlPath))
                    File.Delete(ResultsYmlPath);
            }


        }
        /// <summary>
        /// This method is used to execute yml Batch file.
        /// </summary>
        /// <param name="CategoryCsvPath"></param>
        /// <param name="ScriptsPath"></param>
        /// <param name="BatchNumbers"></param>
        /// <param name="SequenceRange"></param>
        /// <param name="ProjectPath"></param>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.ExecuteYmlBatchFile1();
        /// </example>
        //[Counter("ExecuteYmlBatchFile1")]
        public static void ExecuteYmlBatchFile1(string CategoryCsvPath, string ScriptsPath, object BatchNumbers, string SequenceRange = null, string ProjectPath = null)
        {
            WindowsApplication appHandle;
            appHandle = ApplicationHandlerFactory.GetApplication(ApplicationType.WEB);
            string InvalidScriptspath = ScriptsPath + "\\InvalidScripts.txt";
            string InvalidScripts = "";
            string BatchNumber = "," + BatchNumbers.ToString();
            string[] NumberOfBathes = BatchNumber.Split(',');
            SequenceRange = "," + SequenceRange;
            string YmlPath = ScriptsPath + "\\ExecuteYml.yml";
            string BatchYmlPath = ScriptsPath + "\\BatchYml.bat";
            string ResultsYmlPath = ScriptsPath + "\\Results.txt";
            string[] Batchlines = File.ReadAllLines(CategoryCsvPath);
            string[] ColumnsArray = Batchlines[0].Split(',');
            int ScriptColumnNumber = 0;
            int BatchColumnNumber = 0;
            int SequenceColumnNumber = 0;
            int ExecutionColumnNumber = 0;
            int StatusColumnNumber = 0;
            for (int z = 0; z < ColumnsArray.Length; z++)
            {
                if (ColumnsArray[z].ToLower().IndexOf("auto script name") != -1)
                {
                    ScriptColumnNumber = z;
                }
                else if (ColumnsArray[z].ToLower().IndexOf("batch number") != -1)
                {
                    BatchColumnNumber = z;
                }
                else if (ColumnsArray[z].ToLower().IndexOf("sequence number") != -1)
                {
                    SequenceColumnNumber = z;
                }
                else if (ColumnsArray[z].ToLower().IndexOf("execution") != -1)
                {
                    ExecutionColumnNumber = z;
                }

                else if (ColumnsArray[z].ToLower().IndexOf("status") != -1)
                {
                    StatusColumnNumber = z;
                }
            }
            for (int p = 1; p < NumberOfBathes.Length; p++)
            {
                BatchNumber = NumberOfBathes[p];
                string NameSpace = "";
                string ClassName = "";
                string TempravaryFileContent = "";

                List<int> SortOrder = new List<int>();
                for (int s = 1; s < Batchlines.Length; s++)
                {
                    string[] TemparavaryArray = Batchlines[s].Split(',');
                    if (TemparavaryArray[BatchColumnNumber] == BatchNumber && TemparavaryArray[ExecutionColumnNumber].ToUpper() == "YES" && SequenceRange == null)
                    {
                        TempravaryFileContent = TempravaryFileContent + "^" + TemparavaryArray[ScriptColumnNumber] + "," + TemparavaryArray[SequenceColumnNumber];
                        SortOrder.Add(Int32.Parse(TemparavaryArray[SequenceColumnNumber]));
                    }
                    else if (TemparavaryArray[BatchColumnNumber] == BatchNumber && TemparavaryArray[ExecutionColumnNumber].ToUpper() == "YES" && SequenceRange != null)
                    {
                        string[] SortRanges = SequenceRange.Split(',');
                        string[] SortRange = SortRanges[p].Split(' ');
                        if (Int32.Parse(SortRange[0]) <= Int32.Parse(TemparavaryArray[SequenceColumnNumber]) && Int32.Parse(SortRange[2]) >= Int32.Parse(TemparavaryArray[SequenceColumnNumber]))
                        {
                            TempravaryFileContent = TempravaryFileContent + "^" + TemparavaryArray[ScriptColumnNumber] + "," + TemparavaryArray[SequenceColumnNumber];
                            SortOrder.Add(Int32.Parse(TemparavaryArray[SequenceColumnNumber]));
                        }
                    }
                }
                SortOrder.Sort();

                for (int j = 0; j < SortOrder.Count; j++)
                {
                    string[] TempravaryFileContentArray = TempravaryFileContent.Split('^');
                    NameSpace = "";
                    ClassName = "";
                    bool FileNotFoundException = false;
                    for (int k = 1; k < TempravaryFileContentArray.Length; k++)
                    {
                        if (TempravaryFileContentArray[k].IndexOf("," + SortOrder[j].ToString()) != -1)
                        {
                            string[] ScriptNameFromArray = TempravaryFileContentArray[k].Split(',');
                            List<String> fileArray = DirSearch(ScriptsPath);

                            for (int m = 0; m < fileArray.Count; m++)
                            {
                                if (fileArray[m].ToString().IndexOf("\\" + ScriptNameFromArray[ScriptColumnNumber] + ".cs") != -1)
                                {
                                    string[] Scriptlines = File.ReadAllLines(fileArray[m]);

                                    for (int n = 1; n < Scriptlines.Length; n++)
                                    {
                                        if (Scriptlines[n].IndexOf("namespace ") != -1)
                                        {
                                            string[] NameSpaceArray = Scriptlines[n].Split(' ');
                                            NameSpace = NameSpaceArray[1];
                                        }
                                        if (Scriptlines[n].IndexOf("public ") != -1 && Scriptlines[n].IndexOf("class ") != -1 && Scriptlines[n].IndexOf("TestBase") != -1)
                                        {
                                            string[] ClassArray = Scriptlines[n].Split(new string[] { " class " }, StringSplitOptions.None);
                                            ClassName = ClassArray[1].Replace(" ", "").Replace("TestBase", "").Replace(":", "");
                                        }
                                        if (NameSpace != "" && ClassName != "")
                                        {
                                            if (File.Exists(YmlPath))
                                            {
                                                File.Delete(YmlPath);
                                            }
                                            if (File.Exists(BatchYmlPath))
                                            {
                                                File.Delete(BatchYmlPath);
                                            }
                                            TextWriter ch = new StreamWriter(BatchYmlPath);
                                            ch.WriteLine("powershell.exe gats run --file " + "" + YmlPath + " >> " + ResultsYmlPath + "" + ";");
                                            ch.WriteLine("exit");
                                            ch.Close();
                                            TextWriter tw = new StreamWriter(YmlPath);
                                            tw.WriteLine("platform: win-x64");
                                            tw.WriteLine("projecttype: nunit");
                                            string PathOfProject1 = "";
                                            if (ProjectPath == null)
                                                PathOfProject1 = StartupConfiguration.EnvironmentDetails.ProjectPath;
                                            else
                                                PathOfProject1 = ProjectPath;
                                            string PathOfProject = PathOfProject1.Replace(@"\", "\\\\");
                                            PathOfProject = PathOfProject.Remove((PathOfProject.Length) - 2, 2);
                                            tw.WriteLine("projectpath: " + "\"" + PathOfProject + "\"");
                                            tw.WriteLine("projectexepath: " + "\"" + PathOfProject + "\\\\bin\\\\Debug\\\\net472\\\\win-x64\\\\ACBS.exe\"");
                                            tw.WriteLine("parallel: false");
                                            tw.WriteLine("");
                                            tw.WriteLine("command:");
                                            tw.Close();

                                            string[] Arrayline = File.ReadAllLines(YmlPath);
                                            string text = File.ReadAllText(YmlPath);
                                            if (text.IndexOf(NameSpace + "." + ClassName) != -1)
                                            {
                                                for (int h = 0; h < Arrayline.Length; h++)
                                                {
                                                    if (Arrayline[h].IndexOf(NameSpace + "." + ClassName) != -1)
                                                    {
                                                        text = text.Replace(Arrayline[h].ToString(), Arrayline[h].ToString() + ", " + ScriptNameFromArray[ScriptColumnNumber]);
                                                        File.WriteAllText(YmlPath, text);
                                                        break;
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                File.AppendAllText(YmlPath, " " + NameSpace + "." + ClassName + ": " + ScriptNameFromArray[ScriptColumnNumber] + Environment.NewLine);
                                            }
                                            try
                                            {
                                                appHandle.KillUserProcess("testhost.exe");
                                            }
                                            catch (Exception e) { string ExceptionMessage = e.Message; }
                                            appHandle.RunCommandLineCode(BatchYmlPath, null);
                                            appHandle.WaitForSpecifiedTime(40);
                                            Process[] processes = Process.GetProcessesByName("testhost");
                                            do
                                            {
                                                processes = null;
                                                appHandle.WaitForSpecifiedTime(5);
                                                processes = Process.GetProcessesByName("testhost");

                                            } while (processes.Length > 0);

                                            appHandle.WaitForSpecifiedTime(10);
                                            string[] YmlFileLines = File.ReadAllLines(YmlPath);
                                            string[] ResultTextArray = File.ReadAllLines(ResultsYmlPath);
                                            string[] CSVTextArray = File.ReadAllLines(CategoryCsvPath);

                                            string ResultText = "";
                                            for (int g = 4; g < ResultTextArray.Length; g++)
                                            {
                                                ResultText = ResultText + ResultTextArray[g];
                                            }

                                            for (int km = 1; km < YmlFileLines.Length; km++)
                                            {
                                                if (YmlFileLines[km] != "")
                                                {
                                                    if (YmlFileLines[km].Substring(0, 1) == " ")
                                                    {
                                                        string[] ActualClassScripts = YmlFileLines[km].Split(':');
                                                        ActualClassScripts[1] = "," + ActualClassScripts[1];
                                                        string[] SingleScriptArray = ActualClassScripts[1].Split(',');
                                                        for (int ScriptName = 1; ScriptName < SingleScriptArray.Length; ScriptName++)
                                                        {
                                                            string ActualScript = SingleScriptArray[ScriptName].Replace(" ", "");
                                                            for (int q = 1; q < CSVTextArray.Length; q++)
                                                            {
                                                                string[] DevideCSVScript = CSVTextArray[q].Split(',');
                                                                if (DevideCSVScript[ScriptColumnNumber] == ActualScript)
                                                                {
                                                                    string ReplaceText = "";
                                                                    string ExistingText = "";
                                                                    string[] CSVScriptData = CSVTextArray[q].Split(',');
                                                                    for (int ms = 0; ms < CSVScriptData.Length; ms++)
                                                                    {
                                                                        if (ms == StatusColumnNumber)
                                                                        {
                                                                            if (ResultText.IndexOf(SingleScriptArray[ScriptName]) != -1)
                                                                                ReplaceText = ReplaceText + "," + "Fail";
                                                                            else
                                                                                ReplaceText = ReplaceText + "," + "Pass";
                                                                        }
                                                                        else
                                                                        {
                                                                            ReplaceText = ReplaceText + "," + CSVScriptData[ms];
                                                                        }
                                                                        ExistingText = ExistingText + "," + CSVScriptData[ms];
                                                                    }
                                                                    text = File.ReadAllText(CategoryCsvPath);
                                                                    text = text.Replace(ExistingText.Remove(0, 1), ReplaceText.Remove(0, 1));
                                                                    File.WriteAllText(CategoryCsvPath, text);
                                                                    break;
                                                                }
                                                            }
                                                        }

                                                    }
                                                }
                                            }
                                            if (File.Exists(YmlPath))
                                                File.Delete(YmlPath);
                                            if (File.Exists(BatchYmlPath))
                                                File.Delete(BatchYmlPath);
                                            if (File.Exists(ResultsYmlPath))
                                                File.Delete(ResultsYmlPath);
                                            FileNotFoundException = true;
                                            break;
                                        }
                                    }
                                }

                                if (FileNotFoundException)
                                {
                                    break;
                                }
                                else if (FileNotFoundException == false && (m + 1) == fileArray.Count)
                                {
                                    InvalidScripts = ScriptNameFromArray[ScriptColumnNumber] + "\r\n" + InvalidScripts;

                                }

                            }



                        }
                        if (FileNotFoundException)
                        {
                            break;
                        }
                    }
                    TempravaryFileContentArray = null;
                }
            }

            if (InvalidScripts != "")
            {
                if (File.Exists(InvalidScriptspath))
                {
                    File.Delete(InvalidScriptspath);
                }
                using (StreamWriter sw = File.CreateText(InvalidScriptspath))
                {
                    string result = InvalidScripts;
                    sw.WriteLine(result);
                    System.Windows.Forms.MessageBox.Show("Check for invalid Scripts in: " + InvalidScriptspath, "InvalidScripts", System.Windows.Forms.MessageBoxButtons.OK, System.Windows.Forms.MessageBoxIcon.Error);
                    if (File.Exists(YmlPath))
                    {
                        File.Delete(YmlPath);
                    }
                    if (File.Exists(BatchYmlPath))
                    {
                        File.Delete(BatchYmlPath);
                    }

                }
            }

        }

        /// <summary>
        /// This method is used to remove category.
        /// </summary>
        /// <param name="ServicingDataFileName"></param>
        /// <param name="ScriptsPath"></param>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.RemoveCategory();
        /// </example>
        //[Counter("GetUnUsedInputData")]
        public static void GetUnUsedInputData(string ServicingDataFileName, string ScriptsPath)
        {


            string SingleFileScripts = "";
            string KeyReplacedDataFileName = StartupConfiguration.EnvironmentDetails.ProjectPath + "TestData\\OutputData\\" + "DataFile_Un_Used_InputData" + ".csv";
            string[] ParentScriptsDirectory = Directory.GetDirectories(ScriptsPath);
            int loopLength = ParentScriptsDirectory.Length;
            string[] fileArray = null;
            if (loopLength == 0)
                loopLength = 1;
            string[] CommonTableData = File.ReadAllLines(ServicingDataFileName);
            string KeysUsedinServicingDataFile = "Details,Data Set 1";
            if (File.Exists(KeyReplacedDataFileName) == true)
            {
                File.Delete(KeyReplacedDataFileName);
            }
            for (int i = 1; i < CommonTableData.Length; i++)
            {
                string[] OldKeyName = CommonTableData[i].Split(',');
                if (OldKeyName[0] != "")
                {
                    if (OldKeyName[0].IndexOf("-----") == -1)
                    {
                        if (SingleFileScripts == "")
                        {

                            for (int isloop = 0; isloop < loopLength; isloop++)
                            {
                                if (loopLength == 1)
                                    fileArray = Directory.GetFiles(ScriptsPath);
                                else
                                    fileArray = Directory.GetFiles(ParentScriptsDirectory[isloop]);
                                for (int jLoop = 0; jLoop < fileArray.Length; jLoop++)
                                {
                                    string lines = File.ReadAllText(fileArray[jLoop]);
                                    SingleFileScripts = SingleFileScripts + "\r\n" + lines;
                                }
                                SingleFileScripts = SingleFileScripts.Replace(" ", "");

                            }
                        }
                        if (SingleFileScripts.IndexOf(OldKeyName[0]) == -1)
                        {
                            KeysUsedinServicingDataFile = KeysUsedinServicingDataFile + "\r\n" + OldKeyName[0];
                        }

                    }
                }
            }
            using (StreamWriter sw = File.CreateText(KeyReplacedDataFileName))
            {
                sw.WriteLine(KeysUsedinServicingDataFile);
            }

        }

        /// <summary>
        /// This method is used to remove category.
        /// </summary>
        /// <param name="ScriptsPath"></param>
        /// <param name="CategoryCsvPath"></param>
        /// <returns>None</returns>
        /// <example>
        /// WebLinkUtility.WebLinkUtilityLibrary.RemoveCategory();
        /// </example>
        //[Counter("RemoveCategory")]
        public static void RemoveCategory(string ScriptsPath, string CategoryCsvPath)
        {
            string[] Categorylines = File.ReadAllLines(CategoryCsvPath);

            for (int k = 1; k < Categorylines.Length; k++)
            {
                string[] ActualScriptCategory = Categorylines[k].Split(',');
                string[] parentDirectory = Directory.GetDirectories(ScriptsPath);
                bool FileNotFoundException = false;
                for (int i = 0; i < parentDirectory.Length; i++)
                {
                    string[] fileArray = Directory.GetFiles(parentDirectory[i]);
                    for (int j = 0; j < fileArray.Length; j++)
                    {
                        if (fileArray[j].ToString().IndexOf("\\" + ActualScriptCategory[1]) != -1)
                        {
                            var sb = new StringBuilder();
                            using (var sr = new StreamReader(fileArray[j]))
                            {
                                string line;
                                do
                                {
                                    line = sr.ReadLine();
                                    if (line.IndexOf("[Category") == -1)
                                        sb.AppendLine(line);
                                    else
                                        // sb.Remove(line.IndexOf("[Category"), line.Length);
                                        sb.Replace(line, "");

                                } while (line.IndexOf("public void") == -1);
                                sb.Append(sr.ReadToEnd());
                            }

                            using (var sr = new StreamWriter(fileArray[j]))
                            {
                                sr.Write(sb.ToString());
                            }
                            FileNotFoundException = true;
                            break;
                        }

                    }
                    if (FileNotFoundException)
                        break;
                }
            }
        }

    }
}
public class User32API
{
    [DllImport("User32.dll")]
    public static extern bool IsIconic(IntPtr hWnd);

    [DllImport("User32.dll")]
    public static extern bool SetForegroundWindow(IntPtr hWnd);

    [DllImport("User32.dll")]
    public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
    public const int SW_RESTORE = 9;
}
